{"version":3,"sources":["reportWebVitals.js","Pages/Api.js","Pages/Login.js","GameContainer/Class/Vec2.js","GameContainer/Class/Layer.js","GameContainer/constant.js","GameContainer/Class/GameObject.js","GameContainer/DataPackager.js","Pages/LoadingPage.js","GameContainer/Drawer.js","GameContainer/Preview.js","GameContainer/Setting/example_0.js","Pages/UserPage.js","Pages/ErrorPage.js","Pages/SelectPage.js","Pages/PageComponent/Orders.js","Pages/PopularMap.js","GameContainer/EditMode/Drawer.js","GameContainer/EditMode/Main.js","GameContainer/EditMode/Controller.js","GameContainer/EditMode/Engine.js","Pages/EditMode.js","GameContainer/PlayMode/PlayModeConstant.js","assets/seal.svg","assets/lion.svg","assets/cat.svg","assets/star.svg","GameContainer/PlayMode/assets.js","GameContainer/PlayMode/Drawer.js","GameContainer/PlayMode/Engine.js","GameContainer/PlayMode/state.js","GameContainer/PlayMode/Object/player.js","GameContainer/PlayMode/PlayMapCreater.js","GameContainer/PlayMode/Controller.js","Pages/PlayMode.js","index.js"],"names":["reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","instance","axios","create","baseURL","Alert","props","elevation","variant","useStyles","makeStyles","input","margin","button","width","marginLeft","Body","history","useHistory","classes","useState","name","setName","pwd","setPwd","name_","setName_","pwd_","setPwd_","pwd_repeat","setPwd_repeat","open","setOpen","show","setShow","msgOpen","setMsgOpen","alertMsg","setAlertMsg","alertType","setAlertType","handleChange","func","event","target","value","trim","handleLogin","a","post","data","success","uuid","mapIDs","push","pathname","search","state","login","handleSignUp","msg","handleDel","handleDelMap","className","Snackbar","autoHideDuration","onClose","severity","TextField","placeholder","onChange","style","type","Button","color","disabled","onClick","FormControlLabel","control","Switch","checked","label","Modal","display","Vec2","x","y","this","v","c","Math","sqrt","length","div","dot","PI","atan","v1","v2","min","max","w","dir","up","down","left","right","add","unit","Layer","status","fill","targets","i","that","isOverlap","maxLayer","constant","mapStart","mapSize","gridWidth","blockColor","startColor","endColor","noneColor","deadColor","iceColor","muddyColor","boundaryColor","auxiliaryColor","typeLayerPairs","editObjectList","platform","covering","obstacle","special","editFrame","default","fColor","sColor","uuidv4","require","isCollision","obj1","obj2","pos","sub","r","sObj","cObj","between","size","mul","pointList","map","p","abs","colorList","spikedBlock","id","gridPos","toGrid","detail","upSpike","downSpike","leftSpike","rightSpike","loadable","perspective","layer","cloneObject","unpackage","enpackage","objectSetting","ctx","save","translate","globalAlpha","beginPath","moveTo","lineTo","fillStyle","strokeStyle","stroke","closePath","rect","restore","objects","equal","top","loadObject","object","arcTo","movingPlatform","direction","distance","speed","lastRecord","Date","now","active","options","parameters","dirVec","originPos","rotate","relativePos","bow","RoF","lastFire","lifeCycle","slow","normal","fast","result","arrow","drawPoint","tempArrow","draw","arc","collision","teleport","getDisplacement","scale","mucus","clone","grd","createLinearGradient","addColorStop","cymbal","range","cymbalWave","pivot","createRadialGradient","lineWidth","small","large","pow","ice","conveyor","clip","portal","index","cooldown","lastClose","cooldownTime","cooldownCycle","usedIndex","j","trapPlatform","duration","lastChange","openCycle","short","long","missileBase","unfoldTime","unfoldCycle","rotateSpeed","rotateCycle","find","findTarget","lastFind","findCycle","findTime","missile","radian","minRadian","maxRadian","random","lockedWall","locked","horizontal","vertical","unlocker","used","block","movingPlatform_oblique","movingPlatform_rect","clock","height","start","totalDist","cycleList","clockwise","moveCycle","woodenBox","moveTime","moveRate","break","targetPos","magnet","magneticField","textAlign","textBaseline","font","fillText","setLineDash","brokenPlatform","stage","count","stageCount","deathTotem","grd2","setting","levelSetting","types","place","LoadingPage","clear","canvas","clearRect","drawMap","playMode","relation","pos1","pos2","includes","drawPlayKey","drawStopKey","drawTrashCan","Preview","canvasRef","useRef","useEffect","current","getContext","api","ref","example_0","ColorButton","withStyles","theme","root","palette","getContrastText","pink","backgroundColor","icon","marginRight","spacing","heroContent","background","paper","padding","heroButtons","marginTop","cardGrid","paddingTop","paddingBottom","card","flexDirection","cardMedia","cardContent","flexGrow","footer","Album","setMapIDs","allMaps","setAllMaps","deleteID","setDeleteID","openDialog","setOpenDialog","isBusy","setBusy","DeleteSingleMap","errorCode","getMapIDs","getAllMaps","console","log","maps","handlerStatistic","key","undefined","statistic","fastestPass","fastestMan","passTime","playTime","Fragment","CssBaseline","AppBar","position","Toolbar","Typography","noWrap","Container","maxWidth","component","align","gutterBottom","paragraph","Grid","container","justify","item","title","description","Dialog","aria-labelledby","aria-describedby","DialogContent","DialogContentText","DialogActions","autoFocus","ele","xs","sm","md","Card","content","initSetting","CardContent","CardActions","mode","publish","Tooltip","IconButton","ErrorPage","checkLogin","location","UserPage0","seeMore","Orders","info","rateID","setRateID","rate","rateMap","val","computeScore","arr","totalScore","totalPeople","forEach","transform","msTransform","Rating","newValue","Table","TableHead","TableRow","TableCell","TableBody","author","rateRec","toFixed","CssTextField","borderBottomColor","borderColor","opacity","toolbar","paddingRight","toolbarIcon","alignItems","justifyContent","mixins","appBar","zIndex","drawer","transition","transitions","easing","sharp","leavingScreen","appBarShift","enteringScreen","menuButton","menuButtonHidden","drawerPaper","whiteSpace","drawerPaperClose","overflowX","breakpoints","appBarSpacer","overflow","fixedHeight","PopularMap","newestMaps","setNewestMaps","setSearch","getAllMapsByOrder","clsx","edge","aria-label","e","filter","toLowerCase","handlerSearch","Drawer","Divider","List","ListItem","array","randomIndex","currentIndex","floor","shuffle","ListItemIcon","ListItemText","primary","sort","b","reverse","goBack","Paper","Box","pt","select","luPos","leftUp","selectPair","rightDown","editObjectSpace","objectList","opt","o","GameObject","strokeText","o1","o2","holdObject","holding","hold","message","text","messageCycle","lastPost","EtC","counterclockwise","attraction","repulsion","formControl","minWidth","selectEmpty","EditGameMode","forwardRef","selecting","holdDetail","setStatus","reset","useImperativeHandle","returnSetting","cancelController","requestId","scene","mapEnd","copyable","ctrlKey","mouseMoveHandler","mousePos","offsetX","offsetY","selectGridPos","mouseDownHandler","topLayer","remove","splice","newStatus","detailFunction","objectIndex","setPerspective","mouseUpHandler","stopContextMenu","preventDefault","addEventListener","removeEventListener","Controller","update","Engine","requestAnimationFrame","cancelAnimationFrame","charset","pair","newType","oldTypes","hasStart","hasEnd","shift","changeSelectedGridsType","Object","keys","float","newDetail","FormControl","InputLabel","Select","MenuItem","Slider","valueLabelDisplay","step","marks","Checkbox","extendedIcon","Edit","setTitle","setDescription","init","setSetting","idGetMap","setidGetMap","setPublish","delayUpload","setDelayUpload","setId","childRef","handleUpload","settingPack","id0","idNew","getMap","entries","rows","defaultValue","multiline","Editmode","CONSTANT","h","Msg","spike","dead","end","Link","ASSET_NAMES","mapName2Path","SealIcon","LionIcon","CatIcon","StarIcon","assets","downloadPromise","Promise","all","image","Image","imageSrc","endsWith","get","resp","doc","DOMParser","parseFromString","svgElem","getElementsByTagName","setAttribute","b64Svg","btoa","XMLSerializer","serializeToString","resolve","onload","src","getAsset","assetName","focusPlayer","context","me","FOCUS_PLAYER","focusX","focusY","drawPlayer","player","head","drawImage","serializeForUpdate","fillRect","inView","ObjPos","blockArea","updateState","dt","lastUpdateTime","LeftBound","RightBound","UpperBound","LowerBound","returnLastLoc","rebound","some","squareRebound","mapX","mapY","floorType","resetFriction","onPlatform","setFriction","gameState","endTime","startTime","updateLastLoc","checkLocation","platformID","platformPos","platformDistance","MAX_SAFE_INTEGER","beBlocked","touchConveyor","loc","unlock","addVelocity","fire","setLastFriction","moveOnPlatform","leavePlatform","checkEncounter","pressDown","pressRight","pressLeft","pressUp","pushX","pushY","Player","username","velocity","score","friction","lastFriction","m","force","acceleration","lastLoc","lastPlatformID","lastPlatformPos","updateFAV","checkVelocity","newLoc","vel","toString","vector","Theta","atan2","reflectLineTheta","vec","newVelocityX","cos","sin","newVelocityY","ratio","PlayMapCreater","loading","setLoading","defaultState","closeForm","form","document","getElementById","openForm","challenge","fpsInterval","elapsed","KeyCode","37","38","39","40","onKeyDown","keyCode","onKeyUp","window","startArea","line","square","initState","needEngin","DrawMap","ms","githubButton","padStart","Play","mapp","setMapp","challengeSuccess","mapLocal","time","pass","passPeople","Playmode","ReactDOM","render","StrictMode","basename","process","exact","path","Login","SelectPage","EditMode","PlayMode"],"mappings":"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,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR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","file":"static/js/main.d8a26f3f.chunk.js","sourcesContent":["const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import axios from \"axios\";\r\nconst instance = axios.create({\r\n  //   baseURL: `http://localhost:4000/`,\r\n  baseURL: \"https://p4000.140-112-18-200.nip.io/\",\r\n});\r\nexport default instance;\r\n","import { useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport instance from \"./Api\";\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport Modal from \"@material-ui/core/Modal\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport {url} from \"./url\";\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\nconst useStyles = makeStyles({\r\n  input: {\r\n    margin: \"0 0.2em\",\r\n  },\r\n  button: {\r\n    width: \"100px\",\r\n    marginLeft: \"0.6em\",\r\n  },\r\n});\r\n\r\nconst Body = () => {\r\n  const history = useHistory();\r\n  const classes = useStyles();\r\n  const [name, setName] = useState(\"\");\r\n  const [pwd, setPwd] = useState(\"\");\r\n  // for SignUp\r\n  const [name_, setName_] = useState(\"\");\r\n  const [pwd_, setPwd_] = useState(\"\");\r\n  const [pwd_repeat, setPwd_repeat] = useState(\"\");\r\n\r\n  const [open, setOpen] = useState(false);\r\n  const [show, setShow] = useState(false);\r\n  // for Snackbar Alert\r\n  const [msgOpen, setMsgOpen] = useState(false);\r\n  const [alertMsg, setAlertMsg] = useState(\"\");\r\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\r\n\r\n  const handleChange = (func) => (event) => {\r\n    func(event.target.value.trim());\r\n  };\r\n\r\n  const handleLogin = async () => {\r\n    const {\r\n      data: { success, uuid, mapIDs },\r\n    } = await instance.post(\"/api/login\", {\r\n      name,\r\n      pwd,\r\n    });\r\n    if (!success) {\r\n      // alert(`Wrong password or the user doesn't exist.`);\r\n      setAlertMsg(`Wrong password or the user doesn't exist.`);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n    } else {\r\n      // console.log(`${name} ${uuid}`);\r\n      history.push({\r\n        pathname: `/users/selectPage`,\r\n        search: \"\",\r\n        state: { uuid: uuid, name: name, login: true, mapIDs: mapIDs },\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleSignUp = async () => {\r\n    const {\r\n      data: { success, msg },\r\n    } = await instance.post(\"/api/signup\", {\r\n      name_,\r\n      pwd_,\r\n    });\r\n    if (!success) {\r\n      setAlertMsg(msg);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n      // alert(msg);\r\n    } else {\r\n      // alert(`Success :` + msg);\r\n      setAlertMsg(\"This is a success message!\");\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n    }\r\n    setOpen(false);\r\n  };\r\n\r\n  const handleDel = async () => {\r\n    const {\r\n      data: { success },\r\n    } = await instance.post(\"/api/clear\", {});\r\n    if (success) {\r\n      setAlertMsg(\"This is a success message!\");\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n    } else {\r\n      setAlertMsg(`Delete Fail`);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n    }\r\n  };\r\n\r\n  const handleDelMap = async () => {\r\n    const {\r\n      data: { success },\r\n    } = await instance.post(\"/api/deleteMap\", {});\r\n    if (success) {\r\n      setAlertMsg(\"This is a success message!\");\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n    } else {\r\n      setAlertMsg(`Delete Fail`);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section className=\"Wrapper\">\r\n      <Snackbar\r\n        open={msgOpen}\r\n        autoHideDuration={3000}\r\n        onClose={() => {\r\n          setMsgOpen(false);\r\n        }}\r\n      >\r\n        <Alert\r\n          onClose={() => {\r\n            setMsgOpen(false);\r\n          }}\r\n          severity={alertType}\r\n        >\r\n          {alertMsg}\r\n        </Alert>\r\n      </Snackbar>\r\n      <div className=\"Row\">\r\n        {/* Could use a form & a library for handling form data here such as Formik, but I don't really see the point... */}\r\n        <TextField\r\n          className={classes.input}\r\n          placeholder=\"Name\"\r\n          value={name}\r\n          onChange={handleChange(setName)}\r\n        />\r\n        <TextField\r\n          className={classes.input}\r\n          placeholder=\"Password\"\r\n          style={{ width: 240 }}\r\n          value={pwd}\r\n          type={show ? \"text\" : \"password\"}\r\n          onChange={handleChange(setPwd)}\r\n        />\r\n        <Button\r\n          className={classes.button}\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          disabled={!name || !pwd}\r\n          onClick={handleLogin}\r\n        >\r\n          登入\r\n        </Button>\r\n        <Button\r\n          className={classes.button}\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n          onClick={() => {\r\n            setOpen(true);\r\n          }}\r\n        >\r\n          註冊\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"Row1\">\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={show}\r\n              onChange={() => setShow(!show)}\r\n              name=\"planttext password\"\r\n            />\r\n          }\r\n          label=\"顯示密碼\"\r\n        />\r\n      </div>\r\n      <Modal\r\n        open={open}\r\n        onClose={() => {\r\n          setOpen(false);\r\n        }}\r\n      >\r\n        <div className=\"SignUP\">\r\n          <TextField\r\n            className={classes.input}\r\n            placeholder=\"Name\"\r\n            value={name_}\r\n            onChange={handleChange(setName_)}\r\n          />\r\n          <TextField\r\n            className={classes.input}\r\n            placeholder=\"Password\"\r\n            style={{ width: 240 }}\r\n            value={pwd_}\r\n            type={show ? \"text\" : \"password\"}\r\n            onChange={handleChange(setPwd_)}\r\n          />\r\n          <TextField\r\n            className={classes.input}\r\n            placeholder=\"Retype Your Password\"\r\n            style={{ width: 240 }}\r\n            value={pwd_repeat}\r\n            type={show ? \"text\" : \"password\"}\r\n            onChange={handleChange(setPwd_repeat)}\r\n          />\r\n          <Button\r\n            className={classes.button}\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            disabled={!name_ || !pwd_ || pwd_ !== pwd_repeat}\r\n            onClick={handleSignUp}\r\n          >\r\n            註冊\r\n          </Button>\r\n          <div className=\"Row1\">\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={show}\r\n                  onChange={() => setShow(!show)}\r\n                  name=\"planttext password\"\r\n                />\r\n              }\r\n              label=\"顯示密碼\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n      <div\r\n        style={\r\n          name === \"admin\" && pwd === \"deletemode\"\r\n            ? { display: \"block\" }\r\n            : { display: \"none\" }\r\n        }\r\n      >\r\n        <Button\r\n          className={classes.button}\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n          disabled={false}\r\n          onClick={handleDel}\r\n        >\r\n          Delete User\r\n        </Button>\r\n        <Button\r\n          className={classes.button}\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n          disabled={false}\r\n          onClick={handleDelMap}\r\n        >\r\n          Delete Map\r\n        </Button>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Body;\r\n","/* 二維向量 class 定義 */\r\nexport default class Vec2 {\r\n    constructor(x = 0, y = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    init() {\r\n        this.x = 0;\r\n        this.y = 0;\r\n    }\r\n    set(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    clone() {\r\n        return new Vec2(this.x, this.y);\r\n    }\r\n    equal(v) {\r\n        return (this.x === v.x && this.y === v.y);\r\n    }\r\n    add(v) {\r\n        return new Vec2(this.x + v.x, this.y + v.y);\r\n    }\r\n    sub(v) {\r\n        return new Vec2(this.x - v.x, this.y - v.y);\r\n    }\r\n    mul(c) {\r\n        return new Vec2(this.x * c, this.y * c);\r\n    }\r\n    div(c) {\r\n        return new Vec2(this.x / c, this.y / c);\r\n    }\r\n    length() { \r\n        return Math.sqrt(this.x * this.x + this.y * this.y);\r\n    }\r\n    unit() { // 回傳單位向量\r\n        if (this.length() === 0) return this;\r\n        return this.div(this.length());\r\n    }\r\n    dot(v) { // 計算內積\r\n        return this.x * v.x + this.y * v.y;\r\n    }\r\n    cross(v) { // 計算外積\r\n        return this.x * v.y - this.y * v.x;\r\n    }\r\n    ortho(v) { // 獲得此向量在 v 上的正射影比值\r\n        if (v.length() === 0) return 0;\r\n        return this.dot(v) / v.length() / v.length();\r\n    }\r\n    radian() { // 回傳弧度角\r\n        if (this.x === 0) return (this.y > 0) ? 0.5 * Math.PI : 1.5 * Math.PI;\r\n        if (this.x > 0) return (this.y > 0) ? Math.atan(this.y / this.x) : 2 * Math.PI + Math.atan(this.y / this.x);\r\n        return Math.PI + Math.atan(this.y / this.x);\r\n    }\r\n    between(v1, v2) { // 在兩點圍出的矩形空間內\r\n        return this.x >= Math.min(v1.x, v2.x) && this.x <= Math.max(v1.x, v2.x) && this.y >= Math.min(v1.y, v2.y) && this.y <= Math.max(v1.y, v2.y);\r\n    }\r\n    toGrid(w) { // 回傳將座標以 w 為寬度單位轉成網格座標\r\n        return new Vec2(~~(this.x / w), ~~(this.y / w));\r\n    }\r\n    static up() {\r\n        return new Vec2(0, -1);\r\n    }\r\n    static down() {\r\n        return new Vec2(0, 1);\r\n    }\r\n    static left() {\r\n        return new Vec2(-1, 0);\r\n    }\r\n    static right() {\r\n        return new Vec2(1, 0);\r\n    }\r\n    static direction(dir) {\r\n        return (dir === 'up') ? Vec2.up() : (dir === 'down') ? Vec2.down() : (dir === 'left') ? Vec2.left() : (dir === 'right') ? Vec2.right() :\r\n               (dir === 'right-up') ? Vec2.up().add(Vec2.right()).unit() : (dir === 'right-down') ? Vec2.down().add(Vec2.right()).unit() :\r\n               (dir === 'left-up') ? Vec2.up().add(Vec2.left()).unit() : (dir === 'left-down') ? Vec2.down().add(Vec2.left()).unit() : new Vec2(0, 0);\r\n    }\r\n    static leftUp(v1, v2) { // 回傳兩點圍成的矩形的左上座標\r\n        return new Vec2(Math.min(v1.x, v2.x), Math.min(v1.y, v2.y));\r\n    }\r\n    static rightDown(v1, v2) { // 回傳兩點圍成的矩形的右下座標\r\n        return new Vec2(Math.max(v1.x, v2.x), Math.max(v1.y, v2.y));\r\n    }\r\n}\r\n","const maxLayer = 5;\r\n\r\nexport default class Layer {\r\n    constructor(...status) { // new Layer(0, 1, 3) 創造佔據層數 0, 1, 3 的物件\r\n        this.status = [false, false, false, false, false];\r\n        if (status.length !== 0) this.fill(...status);\r\n    }\r\n    fill(...targets) { // fill(2, 4) 把層數 2, 4 佔據 (預設為全部填滿) * 屬強制覆蓋\r\n        if (targets.length !== 0) {\r\n            for (let i = 0; i < targets.length; i++) {\r\n                if (targets[i] < maxLayer && targets[i] >= 0) {\r\n                    this.status[targets[i]] = true;\r\n                }\r\n            }\r\n        } else this.status = [true, true, true, true, true];\r\n    }\r\n    clear(...targets) { // claer(0, 1, 3) 把層數 0, 1, 3 解除佔據 (預設為全部清空) * 屬強制清空\r\n        if (targets.length !== 0) {\r\n            for (let i = 0; i < targets.length; i++) {\r\n                if (targets[i] < maxLayer && targets[i] >= 0) {\r\n                    this.status[targets[i]] = false;\r\n                }\r\n            }\r\n        } else this.status = [false, false, false, false, false];\r\n    }\r\n    isOverlap(that) { // 確認是否兩個層數物件是否重疊\r\n        for (let i = 0; i < maxLayer; i++) {\r\n            if (this.status[i] && that.status[i]) return true;\r\n        }\r\n        return false;\r\n    }\r\n    add(that) { // 將物件的層數疊加 * 必須屬於非重疊物件才可以疊加\r\n        if (this.isOverlap(that)) return false;\r\n        for (let i = 0; i < maxLayer; i++) {\r\n            if (that.status[i]) this.status[i] = true;\r\n        }\r\n        return true;\r\n    }\r\n    sub(that) { // 將物件的層數消除\r\n        for (let i = 0; i < maxLayer; i++) {\r\n            if (that.status[i]) this.status[i] = false;\r\n        }\r\n    } \r\n    clone() { \r\n        let status = [];\r\n        for (let i = 0; i < maxLayer; i++) {\r\n            if (this.status[i]) status.push(i);\r\n        }\r\n        return new Layer(...status);\r\n    }\r\n    top() { // 回傳被佔據最高層所在層數\r\n        for (let i = 0; i < maxLayer; i++) {\r\n            if (this.status[maxLayer - 1 - i]) return maxLayer - 1 - i;\r\n        }\r\n        return -1;\r\n    }\r\n    bottom() { // 回傳被佔據最底層所在層數\r\n        for (let i = 0; i < maxLayer; i++) {\r\n            if (this.status[i]) return i;\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n","import Vec2 from './Class/Vec2';\r\nimport Layer from './Class/Layer';\r\n\r\nconst constant = {\r\n\tmapStart: new Vec2(88, 0), // 地圖的起始點位子(左上座標)\r\n\tmapSize: new Vec2(32, 16), // 地圖的網格格局\r\n\tgridWidth: 32, // 地圖的每格寬度\r\n\tblockColor: '#E0E0E0', // 場外格子底色\r\n\tstartColor: '#DFFFDF', // 起點格子底色\r\n\tendColor: '#FFD2D2', // 終點格子底色\r\n\tnoneColor: '#FFFFFF', // 空地格子底色\r\n\tdeadColor: '#EBD3E8', // 毒面格子底色\r\n\ticeColor: '#D9FFFF', // 冰面格子底色\r\n\tmuddyColor: \"#D6D6AD\", // 泥面格子底色\r\n\tboundaryColor: '#0080FF', // 邊界格線顏色\r\n\tauxiliaryColor: '#D2E9FF', // 輔助格線顏色\r\n\ttypeLayerPairs: { // 各類格子佔據的層數\r\n\t\t'none': new Layer(),\r\n\t\t'block': new Layer(),\r\n\t\t'start': new Layer(0, 1, 2, 3),\r\n\t\t'end': new Layer(0, 1, 2, 3),\r\n\t\t'dead': new Layer(),\r\n\t\t'ice': new Layer(),\r\n\t\t'muddy': new Layer()\r\n\t},\r\n\tmaxLayer: 5, // 最大佔據層數\r\n\teditObjectList: {\r\n\t\tplatform: ['platform', 'movingPlatform', 'movingPlatform_oblique', 'movingPlatform_rect', 'trapPlatform', 'brokenPlatform'],\r\n\t\tcovering: ['mucus', 'ice', 'conveyor', 'deathTotem'],\r\n\t\tobstacle: ['block', 'spikedBlock', 'woodenBox', 'bow', 'cymbal', 'missileBase'],\r\n\t\tspecial: ['portal', 'lockedWall', 'unlocker', 'magnet'],\r\n\t},\r\n\teditFrame: {\r\n\t\tdefault: { fColor: '#F0F0F0', sColor: '#BEBEBE' },\r\n\t\tplatform: { fColor: '#ECECFF', sColor: '#CECEFF' },\r\n\t\tcovering: { fColor: '#E8FFF5', sColor: '#96FED1' },\r\n\t\tobstacle: { fColor: '#FFECEC', sColor: '#FFB5B5' },\r\n\t\tspecial: { fColor: '#FFFFDF', sColor: '#FFFF37' },\r\n    }\r\n};\r\n\r\nexport default constant;","import Vec2 from './Vec2';\r\nimport constant from '../constant';\r\nimport Layer from './Layer';\r\n\r\nconst uuidv4 = require(\"uuid/v4\");\r\nconst w = constant.gridWidth;\r\nconst isCollision = (obj1, obj2) => {\r\n    if (obj1.type === 'sphere' && obj2.type === 'sphere') {\r\n        return obj1.pos.sub(obj2.pos).length() <= (obj1.r + obj2.r);\r\n    }\r\n    if ((obj1.type === 'sphere' && obj2.type === 'cube') || (obj2.type === 'sphere' && obj1.type === 'cube')) {\r\n        const sObj = (obj1.type === 'sphere') ? obj1 : obj2;\r\n        const cObj = (obj1.type === 'cube') ? obj1 : obj2;\r\n        if (sObj.pos.between(cObj.pos.sub(cObj.size.mul(0.5)).sub(new Vec2(sObj.r, 0)), cObj.pos.add(cObj.size.mul(0.5)).add(new Vec2(sObj.r, 0)))) return true;\r\n        if (sObj.pos.between(cObj.pos.sub(cObj.size.mul(0.5)).sub(new Vec2(0, sObj.r)), cObj.pos.add(cObj.size.mul(0.5)).add(new Vec2(0, sObj.r)))) return true;\r\n        const pointList = ([[-0.5, -0.5], [0.5, -0.5], [0.5, 0.5], [-0.5, 0.5]]).map(p => cObj.pos.add(new Vec2(p[0] * cObj.size.x, p[1] * cObj.size.y)));\r\n        return Math.min(pointList.map(p => p.sub(sObj.pos))) <= sObj.r;\r\n    }\r\n    if (obj1.type === 'cube' && obj2.type === 'cube') {\r\n        return (Math.abs(obj1.pos.x - obj2.pos.x) <= (obj1.size.x / 2 + obj2.size.x / 2)) && (Math.abs(obj1.pos.y - obj2.pos.y) <= (obj1.size.y / 2 + obj2.size.y / 2));\r\n    }\r\n    return false;\r\n};\r\nconst colorList = ['#FF0000', '#FFA042', '#F9F900', '#02DF82', '#6A6AFF', '#D0D0D0', '#E800E8', '#984B4B'];\r\n\r\n/* 尖刺方塊 */\r\nexport class spikedBlock {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'spikedBlock';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '尖刺方塊',\r\n            upSpike: true,\r\n            downSpike: true,\r\n            leftSpike: true,\r\n            rightSpike: true,\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new spikedBlock();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            upSpike: { type: 'check' },\r\n            downSpike: { type: 'check' },\r\n            leftSpike: { type: 'check' },\r\n            rightSpike: { type: 'check' },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            upSpike: this.detail.upSpike,\r\n            downSpike: this.detail.downSpike,\r\n            leftSpike: this.detail.leftSpike,\r\n            rightSpike: this.detail.rightSpike,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.upSpike = objectSetting.upSpike;\r\n        this.detail.downSpike = objectSetting.downSpike;\r\n        this.detail.leftSpike = objectSetting.leftSpike;\r\n        this.detail.rightSpike = objectSetting.rightSpike;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(w, w) }, target)) return 'block';\r\n        if ((this.detail.leftSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(-0.625 * w, 0)), size: new Vec2(0.25 * w, 0.75 * w) }, target)) ||\r\n            (this.detail.rightSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(0.625 * w, 0)), size: new Vec2(0.25 * w, 0.75 * w) }, target)) ||\r\n            (this.detail.upSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(0, -0.625 * w)), size: new Vec2(0.25 * w, 0.75 * w) }, target)) ||\r\n            (this.detail.downSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(0, 0.625 * w)), size: new Vec2(0.25 * w, 0.75 * w) }, target)))\r\n            return 'spike';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.4 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.5 * w, -0.5 * w);\r\n        if (this.detail.upSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((-0.5 + 0.125 * i) * w, (-0.5 - 0.25 * (i % 2)) * w);\r\n        ctx.lineTo(0.5 * w, -0.5 * w);\r\n        if (this.detail.rightSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((0.5 + 0.25 * (i % 2)) * w, (-0.5 + 0.125 * i) * w);\r\n        ctx.lineTo(0.5 * w, 0.5 * w);\r\n        if (this.detail.downSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((0.5 - 0.125 * i) * w, (0.5 + 0.25 * (i % 2)) * w);\r\n        ctx.lineTo(-0.5 * w, 0.5 * w);\r\n        if (this.detail.leftSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((-0.5 - 0.25 * (i % 2)) * w, (0.5 - 0.125 * i) * w);\r\n        ctx.lineTo(-0.5 * w, -0.5 * w);\r\n        ctx.fillStyle = '#7B7B7B';\r\n        ctx.fill();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.5 * w, -0.5 * w, w, w);\r\n        ctx.fillStyle = '#9D9D9D';\r\n        ctx.fill();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if ((constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) ||\r\n            (this.detail.leftSpike && gridPos.x - 1 >= 0 && constant.typeLayerPairs[map[gridPos.y][gridPos.x - 1].type].isOverlap(this.layer)) ||\r\n            (this.detail.upSpike && gridPos.y - 1 >= 0 && constant.typeLayerPairs[map[gridPos.y - 1][gridPos.x].type].isOverlap(this.layer)) ||\r\n            (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x && constant.typeLayerPairs[map[gridPos.y][gridPos.x + 1].type].isOverlap(this.layer)) ||\r\n            (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y && constant.typeLayerPairs[map[gridPos.y + 1][gridPos.x].type].isOverlap(this.layer))) {\r\n            return false;\r\n        }\r\n        if ((map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) ||\r\n            (this.detail.leftSpike && gridPos.x - 1 >= 0 && map[gridPos.y][gridPos.x - 1].layer.isOverlap(this.layer)) ||\r\n            (this.detail.upSpike && gridPos.y - 1 >= 0 && map[gridPos.y - 1][gridPos.x].layer.isOverlap(this.layer)) ||\r\n            (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x && map[gridPos.y][gridPos.x + 1].layer.isOverlap(this.layer)) ||\r\n            (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y && map[gridPos.y + 1][gridPos.x].layer.isOverlap(this.layer))) {\r\n            return false;\r\n        }\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (this.detail.leftSpike && gridPos.x - 1 >= 0) map[gridPos.y][gridPos.x - 1].layer.add(this.layer);\r\n        if (this.detail.upSpike && gridPos.y - 1 >= 0) map[gridPos.y - 1][gridPos.x].layer.add(this.layer);\r\n        if (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x) map[gridPos.y][gridPos.x + 1].layer.add(this.layer);\r\n        if (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y) map[gridPos.y + 1][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (this.detail.leftSpike && gridPos.x - 1 >= 0) map[gridPos.y][gridPos.x - 1].layer.sub(this.layer);\r\n        if (this.detail.upSpike && gridPos.y - 1 >= 0) map[gridPos.y - 1][gridPos.x].layer.sub(this.layer);\r\n        if (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x) map[gridPos.y][gridPos.x + 1].layer.sub(this.layer);\r\n        if (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y) map[gridPos.y + 1][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 平台 */\r\nexport class platform {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'platform';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '平台'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(1);\r\n    }\r\n    clone() {\r\n        const cloneObject = new platform();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.99 * w, 0.99 * w) }, target)) return 'platform';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.45) * w);\r\n        ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\r\n        ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\r\n        ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\r\n        ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.45) * w);\r\n        ctx.fillStyle = '#ead48b';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#cb934d';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.35) * w);\r\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.35) * w);\r\n        ctx.strokeStyle = '#f4f788';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 移動平台 */\r\nexport class movingPlatform {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'movingPlatform';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '移動平台(直行)',\r\n            direction: 'up',\r\n            distance: 1,\r\n            speed: 'normal',\r\n        };\r\n\r\n        this.loadable = true;\r\n        this.loadObject = null;\r\n\r\n        this.lastRecord = Date.now();\r\n        this.active = false;\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(0, 1);\r\n    }\r\n    clone() {\r\n        const cloneObject = new movingPlatform();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            distance: { type: 'int', min: 1, max: 15 },\r\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\r\n            speed: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n            distance: this.detail.distance,\r\n            speed: this.detail.speed,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n        this.detail.distance = objectSetting.distance;\r\n        this.detail.speed = objectSetting.speed;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            'super slow': 4000, 'slow': 2000, 'normal': 1000, 'fast': 500, 'super fast': 200,\r\n        };\r\n        const dirVec = Vec2.direction(this.detail.direction).mul(this.detail.distance * w);\r\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n        if (~~((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 2 === 0) {\r\n            this.pos = originPos.add(dirVec.mul(((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\r\n        } else {\r\n            this.pos = originPos.add(dirVec.mul(1 - ((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\r\n        }\r\n        if (this.loadObject) this.loadObject.object.pos = this.pos;\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'movingPlatform';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n        if (this.active) ctx.translate(originPos.x, originPos.y);\r\n        else ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        if (layer === -1 || layer === 0) {\r\n            ctx.save();\r\n            let dir = this.detail.direction;\r\n            ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, 0);\r\n            ctx.lineTo(0, - this.detail.distance * w);\r\n            ctx.strokeStyle = '#4F4F4F';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.save();\r\n            ctx.translate(0, - this.detail.distance * w);\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n            ctx.restore();\r\n\r\n            ctx.restore();\r\n        }\r\n\r\n        if (layer === -1 || layer === 1) {\r\n            if (this.active) {\r\n                const relativePos = this.pos.sub(originPos);\r\n                ctx.translate(relativePos.x, relativePos.y);\r\n            }\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, (-0.45) * w);\r\n            ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\r\n            ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\r\n            ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\r\n            ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\r\n            ctx.lineTo(0, (-0.45) * w);\r\n            ctx.fillStyle = '#ead48b';\r\n            ctx.fill();\r\n            ctx.strokeStyle = '#cb934d';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, (-0.35) * w);\r\n            ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n            ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n            ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n            ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n            ctx.lineTo(0, (-0.35) * w);\r\n            ctx.strokeStyle = '#f4f788';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.active = true;\r\n        this.lastRecord = Date.now();\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    this.loadObject = {\r\n                        id: objects[i].id,\r\n                        object: objects[i],\r\n                    };\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 弓 */\r\nexport class bow {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'bow';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '弓箭座',\r\n            direction: 'up',\r\n            RoF: 'normal'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.lastFire = Date.now();\r\n        this.lifeCycle = 0;\r\n        this.active = false;\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new bow();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\r\n            RoF: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n            RoF: this.detail.RoF,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n        this.detail.RoF = objectSetting.RoF;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            'super slow': 8000, slow: 5000, normal: 3000, fast: 1000, 'super fast': 500\r\n        }\r\n        this.lifeCycle = (this.active) ? (Date.now() - this.lastFire) / parameters[this.detail.RoF] : 0;\r\n        this.lifeCycle = (this.lifeCycle > 0.5) ? (this.lifeCycle - 0.5) / 0.5 : 0;\r\n        if (Date.now() > this.lastFire + parameters[this.detail.RoF]) {\r\n            this.lastFire = Date.now();\r\n            let dirVec = Vec2.direction(this.detail.direction).mul(0.5 * w);\r\n            const result = {\r\n                type: 'produce',\r\n                object: new arrow(this.pos.add(dirVec)),\r\n            };\r\n            result.object.detail.direction = this.detail.direction;\r\n            return result;\r\n        } else return { type: 'none' };\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n        let dir = this.detail.direction;\r\n        ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\r\n\r\n        const drawPoint = (new Vec2(0, 0.05)).add((new Vec2(0, 0.35)).mul(this.lifeCycle));\r\n\r\n        if (this.lifeCycle > 0) {\r\n            let tempArrow = new arrow(drawPoint.mul(w).sub(new Vec2(0, 0.9 * w)));\r\n            tempArrow.draw(ctx);\r\n        }\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.45 * w, 0.05 * w);\r\n        ctx.lineTo(drawPoint.x * w, drawPoint.y * w);\r\n        ctx.lineTo(0.45 * w, 0.05 * w);\r\n        ctx.strokeStyle = '#9D9D9D';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0.2 * w, 0.45 * w, -0.95 * Math.PI, -0.05 * Math.PI);\r\n        ctx.arc(0, 0.2 * w, 0.55 * w, -0.05 * Math.PI, -0.95 * Math.PI, true);\r\n        ctx.arc(0, 0.2 * w, 0.45 * w, -0.95 * Math.PI, -0.95 * Math.PI);\r\n        ctx.fillStyle = '#D26900';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#272727';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.active = true;\r\n        this.lastFire = Date.now();\r\n        this.lifeCycle = 0;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 箭 */\r\nexport class arrow {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'arrow';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = new Vec2(-1, -1);\r\n\r\n        this.detail = {\r\n            name: '箭',\r\n            direction: 'up',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.speed = 3;\r\n        this.lastRecord = Date.now();\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new arrow();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    update(objects, map) {\r\n        if (!this.pos.between(constant.mapStart, constant.mapStart.add(constant.mapSize.mul(w)))) return { type: 'destory' };\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].type !== 'ice' && objects[i].type !== 'portal' && objects[i].type !== 'woodenBox' && objects[i].type !== 'magnet' && objects[i].type !== 'block' && objects[i].type !== 'lockedWall') continue;\r\n            if (objects[i].id !== this.id && objects[i].collision) {\r\n                let result = objects[i].collision({ type: 'sphere', pos: this.pos, r: 0.1 });\r\n                // console.log(result);\r\n                if (result === 'ice') this.speed *= 1.03;\r\n                // else if (result === 'conveyor') this.detail.direction = objects[i].detail.direction;\r\n                else if (result === 'portal') this.pos = objects[i].teleport(objects);\r\n                // else if (result === 'missileRay') objects[i].fire(this);\r\n                else if (result === 'woodenBox') {\r\n                    //objects[i].push(objects, map, this.pos);\r\n                    return { type: 'destory' };\r\n                }\r\n                else if (result === 'magneticField') this.pos = this.pos.add(objects[i].getDisplacement());\r\n                // else if (result === 'unlocker') objects[i].unlock(objects);\r\n                else if (result === 'block' || result === 'lockedWall') return { type: 'destory' };\r\n            }\r\n        }\r\n        let dirVec = Vec2.direction(this.detail.direction).mul(this.speed * w);\r\n        this.pos = this.pos.add(dirVec.mul((Date.now() - this.lastRecord) / 1000));\r\n        this.lastRecord = Date.now();\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.1 }, target)) return 'arrow';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.9 : 1;\r\n        let dir = this.detail.direction;\r\n        ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, 0);\r\n        ctx.lineTo(0.12 * w, 0.2 * w);\r\n        ctx.lineTo(-0.12 * w, 0.2 * w);\r\n        ctx.lineTo(0, 0);\r\n        ctx.fillStyle = '#FCFCFC';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#9D9D9D';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, 0.2 * w);\r\n        ctx.lineTo(0, 0.8 * w);\r\n        ctx.strokeStyle = '#AD5A5A';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.translate(0, 0.8 * w);\r\n        for (let i = 0; i < 2; i++) {\r\n            if (i === 1) ctx.scale(-1, 1);\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, 0);\r\n            ctx.lineTo(0.12 * w, 0.06 * w);\r\n            ctx.lineTo(0.12 * w, 0.18 * w);\r\n            ctx.lineTo(0, 0.12 * w);\r\n            ctx.lineTo(0, 0);\r\n            ctx.fillStyle = '#00DB00';\r\n            ctx.fill();\r\n            ctx.strokeStyle = '#9D9D9D';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n}\r\n\r\n/* 黏液 */\r\nexport class mucus {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'mucus';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '黏液'\r\n        };\r\n\r\n        this.loadable = true;\r\n        this.loadObject = null;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(2);\r\n    }\r\n    clone() {\r\n        const cloneObject = new mucus();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        if (this.loadObject) this.loadObject.object.pos = this.pos.clone();\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'mucus';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.35) * w);\r\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.35) * w);\r\n        let grd = ctx.createLinearGradient(-0.4 * w, -0.4 * w, 0.4 * w, 0.4 * w);\r\n        grd.addColorStop(0, '#B7FF4A');\r\n        grd.addColorStop(0.4, '#FFDC35');\r\n        grd.addColorStop(0.6, '#FFDC35');\r\n        grd.addColorStop(1, '#B7FF4A');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#E1E100';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (map[gridPos.y][gridPos.x].layer.status[3]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 3) {\r\n                    this.loadObject = {\r\n                        id: objects[i].id,\r\n                        object: objects[i],\r\n                    };\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this.loadObject) this.loadObject = null;\r\n    }\r\n}\r\n\r\n/* 音鈸 */\r\nexport class cymbal {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'cymbal';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '音鈸',\r\n            RoF: 'normal',\r\n            range: 'normal',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.lastFire = Date.now();\r\n        this.lifeCycle = 0;\r\n        this.active = false;\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new cymbal();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            RoF: { type: 'select', options: ['slow', 'normal', 'fast'] },\r\n            range: { type: 'select', options: ['small', 'normal', 'large'] },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n            RoF: this.detail.RoF,\r\n            range: this.detail.range,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n        this.detail.RoF = objectSetting.RoF;\r\n        this.detail.range = objectSetting.range;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            slow: 12000, normal: 8000, fast: 4000\r\n        }\r\n        this.lifeCycle = (this.active) ? (Date.now() - this.lastFire) / parameters[this.detail.RoF] : 0;\r\n        this.lifeCycle = Math.min(1, this.lifeCycle);\r\n        if (Date.now() > this.lastFire + parameters[this.detail.RoF]) {\r\n            this.lastFire = Date.now();\r\n            const result = {\r\n                type: 'produce',\r\n                object: new cymbalWave(this.pos),\r\n            };\r\n            result.object.r = 0.4 * w;\r\n            result.object.detail.range = this.detail.range;\r\n            return result;\r\n        } else return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.48 * w }, target)) return 'cymbal';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        const parameters = {\r\n            slow: 12000, normal: 8000, fast: 4000\r\n        }\r\n        let pivot = 0.96 + parameters[this.detail.RoF] * 0.0000025;\r\n        let r = (this.lifeCycle < pivot) ? 0.05 + 0.4 * this.lifeCycle / pivot : 0.05 + 0.4 * (1 - this.lifeCycle) / (1 - pivot);\r\n\r\n        ctx.save();\r\n        ctx.rotate(this.lifeCycle * 8 * Math.PI);\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.48 * w, 0, 2 * Math.PI);\r\n        var grd = ctx.createRadialGradient(-0.13 * w, -0.13 * w, 0, 0, 0, 0.48 * w);\r\n        grd.addColorStop(0, 'white');\r\n        grd.addColorStop(1, '#D6D6AD');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#B9B973';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n\r\n        ctx.globalAlpha *= 0.5;\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.4 * w, 0 * Math.PI, 2 * Math.PI);\r\n        ctx.strokeStyle = '#CDCD9A';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n\r\n        ctx.beginPath();\r\n        ctx.globalAlpha *= 0.5;\r\n        ctx.arc(0, 0, r * w, 0, 2 * Math.PI);\r\n        ctx.lineWidth = 1.3;\r\n        ctx.strokeStyle = 'white';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.06 * w, 0, 2 * Math.PI);\r\n        ctx.fillStyle = '#EAC100';\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.active = true;\r\n        this.lastFire = Date.now();\r\n        this.lifeCycle = 0;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 音波 */\r\nexport class cymbalWave {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'cymbalWave';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = new Vec2(-1, -1);\r\n\r\n        this.detail = {\r\n            name: '音波',\r\n            range: 'normal',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.r = 0;\r\n        this.lastRecord = Date.now();\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new arrow();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            small: 1.5, normal: 2.5, large: 3.5\r\n        }\r\n        if (this.r > w * parameters[this.detail.range]) return { type: 'destory' };\r\n        this.r = 0.4 * w + 0.5 * w * (Date.now() - this.lastRecord) / 1000;\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'sphere', pos: this.pos, r: this.r }, target)) return 'cymbalWave';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n\r\n        const parameters = {\r\n            small: 1.5, normal: 2.5, large: 3.5\r\n        }\r\n        ctx.globalAlpha = 0.3 * Math.max((1.1 - Math.pow(this.r / (w * parameters[this.detail.range]), 16)), 0);\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, this.r, 0, 2 * Math.PI);\r\n        var grd = ctx.createRadialGradient(0, 0, 0, 0, 0, this.r);\r\n        grd.addColorStop(0, 'white');\r\n        grd.addColorStop(0.4, 'white');\r\n        grd.addColorStop(0.95, '#FFFF37');\r\n        grd.addColorStop(1, '#E1E100');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n}\r\n\r\n/* 冰面 */\r\nexport class ice {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'ice';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '冰層'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(2);\r\n    }\r\n    clone() {\r\n        const cloneObject = new ice();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'ice';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.35) * w);\r\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.35) * w);\r\n        let grd = ctx.createLinearGradient(-0.4 * w, -0.4 * w, 0.4 * w, 0.4 * w);\r\n        grd.addColorStop(0, '#CAFFFF');\r\n        grd.addColorStop(0.12, 'white');\r\n        grd.addColorStop(0.15, 'white');\r\n        grd.addColorStop(0.4, '#CAFFFF');\r\n        grd.addColorStop(0.6, '#CAFFFF');\r\n        grd.addColorStop(0.85, 'white');\r\n        grd.addColorStop(0.88, 'white');\r\n        grd.addColorStop(1, '#CAFFFF');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#ACD6FF';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 傳輸帶 */\r\nexport class conveyor {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'conveyor';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '傳輸帶',\r\n            direction: 'right',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(2);\r\n    }\r\n    clone() {\r\n        const cloneObject = new conveyor();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'conveyor';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.35) * w);\r\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.35) * w);\r\n        ctx.fillStyle = '#BE77FF';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#9F35FF';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.rect((-0.34) * w, (-0.34) * w, 0.68 * w, 0.68 * w);\r\n        ctx.clip();\r\n\r\n        let dir = this.detail.direction;\r\n        ctx.rotate((dir === 'right') ? 0 : (dir === 'left') ? Math.PI : (dir === 'up') ? 1.5 * Math.PI : 0.5 * Math.PI);\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.4 * w, -0.15 * w);\r\n        ctx.lineTo(-0.05 * w, -0.15 * w);\r\n        ctx.lineTo(-0.05 * w, -0.4 * w);\r\n        ctx.lineTo(0.4 * w, 0);\r\n        ctx.lineTo(-0.05 * w, 0.4 * w);\r\n        ctx.lineTo(-0.05 * w, 0.15 * w);\r\n        ctx.lineTo(-0.4 * w, 0.15 * w);\r\n        ctx.lineTo(-0.4 * w, -0.15 * w);\r\n        ctx.fillStyle = '#FFA6FF';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#D3A4FF';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 傳送門 */\r\nexport class portal {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'portal';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '傳送門'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.open = false;\r\n        this.index = -1;\r\n\r\n        this.cooldown = false;\r\n        this.lastClose = 0;\r\n        this.cooldownTime = 2989;\r\n        this.cooldownCycle = 0;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new portal();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n\r\n            index: this.index,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.index = objectSetting.index;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        if (this.cooldown) {\r\n            if (Date.now() > this.lastClose + this.cooldownTime) {\r\n                this.cooldown = false;\r\n                this.open = true;\r\n            } else this.cooldownCycle = (Date.now() - this.lastClose) / this.cooldownTime;\r\n        }\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (this.open && isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.6 * w, 0.6 * w) }, target)) return 'portal';\r\n        return 'none';\r\n    }\r\n    teleport(objects) {\r\n        this.open = false;\r\n        this.cooldown = true;\r\n        this.lastClose = Date.now();\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].type === 'portal' && objects[i].index === this.index && objects[i].id !== this.id) {\r\n                objects[i].open = false;\r\n                objects[i].cooldown = true;\r\n                objects[i].lastClose = Date.now();\r\n                return objects[i].pos.clone();\r\n            }\r\n        }\r\n        return this.pos.clone();\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.36 * w, -0.36 * w, 0.72 * w, 0.72 * w);\r\n        ctx.lineWidth = 5;\r\n        ctx.strokeStyle = '#4B0091';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.4 * w, -0.4 * w, 0.8 * w, 0.8 * w);\r\n        ctx.lineWidth = 0.2;\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.32 * w, -0.32 * w, 0.64 * w, 0.64 * w);\r\n        ctx.lineWidth = 0.2;\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.rect(-0.3 * w, -0.3 * w, 0.6 * w, 0.6 * w);\r\n        ctx.clip();\r\n        ctx.globalAlpha = (this.open) ? 0.95 :\r\n            (!this.cooldown) ? 0.2 :\r\n                (this.cooldownCycle < 0.1) ? 0.2 + 0.75 * (1 - this.cooldownCycle * 10) :\r\n                    (this.cooldownCycle > 0.9) ? 0.2 + 0.75 * (1 - (1 - this.cooldownCycle) * 10) : 0.2;\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.32 * w, -0.32 * w, 0.64 * w, 0.64 * w);\r\n        let color = ((this.open || this.cooldown) && (this.index >= 0)) ? colorList[this.index] : 'white';\r\n        let grd = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.4 * w);\r\n        grd.addColorStop(0, color);\r\n        grd.addColorStop(0.15, '#3C3C3C');\r\n        grd.addColorStop(0.3, color);\r\n        grd.addColorStop(0.45, '#3C3C3C');\r\n        grd.addColorStop(0.6, color);\r\n        grd.addColorStop(0.75, '#3C3C3C');\r\n        grd.addColorStop(0.9, color);\r\n        grd.addColorStop(1, '#3C3C3C');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.cooldown = false;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        if (this.index === -1) {\r\n            let usedIndex = [0, 0, 0, 0, 0, 0, 0, 0];\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].type === 'portal') {\r\n                    usedIndex[objects[i].index] += 1;\r\n                }\r\n            }\r\n            for (let i = 0; i < usedIndex.length; i++) {\r\n                if (usedIndex[i] === 1) {\r\n                    this.index = i;\r\n                    this.open = true;\r\n                    for (let j = 0; j < objects.length; j++) {\r\n                        if (objects[j].type === 'portal' && objects[j].index === i) {\r\n                            objects[j].open = true;\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            if (this.index === -1) {\r\n                for (let i = 0; i < usedIndex.length; i++) {\r\n                    if (usedIndex[i] === 0) {\r\n                        this.index = i;\r\n                        this.open = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].type === 'portal' && objects[i].index === this.index && objects[i].id != this.id) {\r\n                    objects[i].open = true;\r\n                    this.open = true;\r\n                }\r\n            }\r\n        }\r\n        if (this.index === -1) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].type === 'portal' && objects[i].index === this.index && objects[i].id != this.id) {\r\n                objects[i].cooldown = false;\r\n                objects[i].open = false;\r\n                break;\r\n            }\r\n        }\r\n        this.index = -1;\r\n        this.open = false;\r\n        this.cooldown = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 陷阱平台 */\r\nexport class trapPlatform {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'trapPlatform';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '陷阱平台',\r\n            duration: 'normal',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.open = false;\r\n        this.lastChange = Date.now();\r\n        this.openCycle = 0;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(1, 2);\r\n    }\r\n    clone() {\r\n        const cloneObject = new trapPlatform();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            duration: { type: 'select', options: ['short', 'normal', 'long'] },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            duration: this.detail.duration,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.duration = objectSetting.duration;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            short: 3000, normal: 6000, long: 9000\r\n        }\r\n        if (this.open) {\r\n            this.openCycle = (Date.now() - this.lastChange) / parameters[this.detail.duration];\r\n            this.openCycle = (this.openCycle < 0.1 * 6000 / parameters[this.detail.duration]) ? this.openCycle / (0.1 * 6000 / parameters[this.detail.duration]) :\r\n                (this.openCycle > 1 - (0.1 * 6000 / parameters[this.detail.duration])) ? (1 - this.openCycle) / (0.1 * 6000 / parameters[this.detail.duration]) : 1;\r\n            if (Date.now() > this.lastChange + parameters[this.detail.duration]) {\r\n                this.open = false;\r\n                this.lastChange = Date.now();\r\n            }\r\n        } else {\r\n            this.openCycle = 0;\r\n            if (Date.now() > this.lastChange + parameters[this.detail.duration]) {\r\n                this.open = true;\r\n                this.lastChange = Date.now();\r\n            }\r\n        }\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (this.open && isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.6 * w * this.openCycle, 0.7 * w) }, target)) return 'trap';\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'platform';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.6 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.39 * w, -0.39 * w, 0.78 * w, 0.78 * w);\r\n        ctx.strokeStyle = '#ADADAD';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        for (let i = 0; i < 2; i++) {\r\n            ctx.save();\r\n\r\n            if (this.open) {\r\n                let p = (i === 0) ? -1 : 1;\r\n                ctx.beginPath();\r\n                ctx.moveTo(-0.05 * w + p * (0.3 * w) * this.openCycle, -0.35 * w);\r\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, -0.25 * w);\r\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, -0.15 * w);\r\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, -0.05 * w);\r\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, 0.05 * w);\r\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, 0.15 * w);\r\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, 0.25 * w);\r\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, 0.35 * w);\r\n                ctx.lineTo(0.35 * w * p, 0.35 * w);\r\n                ctx.lineTo(0.35 * w * p, -0.35 * w);\r\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, -0.35 * w);\r\n                ctx.clip();\r\n                ctx.closePath();\r\n            }\r\n            ctx.beginPath();\r\n            ctx.rect(-0.35 * w, -0.35 * w, 0.7 * w, 0.7 * w);\r\n            ctx.fillStyle = '#E0E0E0';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.restore();\r\n        }\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.43 * w, -0.43 * w, 0.86 * w, 0.86 * w);\r\n        ctx.strokeStyle = '#3C3C3C';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.35 * w, -0.35 * w, 0.7 * w, 0.7 * w);\r\n        ctx.strokeStyle = '#3C3C3C';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        for (let i = 0; i < 2; i++) {\r\n            ctx.save();\r\n            if (this.open) {\r\n                if (i === 0) ctx.translate((-0.3 * w) * this.openCycle, 0);\r\n                else ctx.translate((0.3 * w) * this.openCycle, 0);\r\n            }\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.05 * w, -0.35 * w);\r\n            ctx.lineTo(0.05 * w, -0.25 * w);\r\n            ctx.lineTo(-0.05 * w, -0.15 * w);\r\n            ctx.lineTo(0.05 * w, -0.05 * w);\r\n            ctx.lineTo(-0.05 * w, 0.05 * w);\r\n            ctx.lineTo(0.05 * w, 0.15 * w);\r\n            ctx.lineTo(-0.05 * w, 0.25 * w);\r\n            ctx.lineTo(0.05 * w, 0.35 * w);\r\n            ctx.strokeStyle = '#6C6C6C';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n            ctx.restore();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 追蹤導彈座 */\r\nexport class missileBase {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'missileBase';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '追蹤導彈發射台',\r\n            direction: 'up',\r\n            rotate: true,\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.active = false;\r\n\r\n        this.r = 2.5;\r\n        this.range = 0.125;\r\n        this.lastFire = Date.now();\r\n        this.unfoldTime = 500;\r\n        this.unfoldCycle = 0;\r\n        this.rotateSpeed = 0.2; // 1秒幾圈\r\n        this.rotateCycle = 0;\r\n        this.find = false;\r\n        this.findTarget = null;\r\n        this.lastFind = 0;\r\n        this.findCycle = 0;\r\n        this.findTime = 2500;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new missileBase();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\r\n            rotate: { type: 'check' },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n            rotate: this.detail.rotate,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n        this.detail.rotate = objectSetting.rotate;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        this.unfoldCycle = (Date.now() - this.lastFire) / this.unfoldTime;\r\n        this.unfoldCycle = (this.unfoldCycle > 1) ? 1 : this.unfoldCycle;\r\n        this.rotateCycle = (this.unfoldCycle === 1 && this.detail.rotate) ? (Date.now() - this.lastFire - this.unfoldTime) / 1000 * this.rotateSpeed : 0;\r\n        if (this.find) this.findCycle = (Date.now() - this.lastFind) / this.findTime;\r\n        if (this.findCycle >= 1) {\r\n            this.find = false;\r\n            this.findCycle = 0;\r\n            this.lastFire = Date.now();\r\n            const result = {\r\n                type: 'produce',\r\n                object: new missile(this.pos),\r\n            };\r\n            result.object.target = this.findTarget;\r\n            return result;\r\n        }\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.35 * w }, target)) return 'missileBase';\r\n        if (!this.find && isCollision({ type: 'sphere', pos: this.pos, r: 2.5 * w }, target)) {\r\n            const parameters = {\r\n                up: 1.5, down: 0.5, left: 1, right: 0,\r\n            }\r\n            let radian = target.pos.sub(this.pos).radian();\r\n            let minRadian = ((parameters[this.detail.direction] + 2 * this.rotateCycle - this.range * this.unfoldCycle) * Math.PI) % (2 * Math.PI);\r\n            let maxRadian = ((parameters[this.detail.direction] + 2 * this.rotateCycle + this.range * this.unfoldCycle) * Math.PI) % (2 * Math.PI);\r\n            if (maxRadian < minRadian) {\r\n                maxRadian += 2 * Math.PI;\r\n                if (radian < Math.PI) radian += 2 * Math.PI;\r\n            }\r\n            if (radian >= minRadian && radian <= maxRadian) return 'missileRay';\r\n        }\r\n        return 'none';\r\n    }\r\n    fire(target) {\r\n        this.find = true;\r\n        this.findTarget = target;\r\n        this.lastFind = Date.now();\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        let unit = 0.7 * w / (1 + Math.sqrt(2));\r\n        ctx.moveTo(-0.5 * unit, -(0.5 + Math.sqrt(0.5)) * unit);\r\n        ctx.lineTo(0.5 * unit, -(0.5 + Math.sqrt(0.5)) * unit);\r\n        ctx.lineTo((0.5 + Math.sqrt(0.5)) * unit, -0.5 * unit);\r\n        ctx.lineTo((0.5 + Math.sqrt(0.5)) * unit, 0.5 * unit);\r\n        ctx.lineTo(0.5 * unit, (0.5 + Math.sqrt(0.5)) * unit);\r\n        ctx.lineTo(-0.5 * unit, (0.5 + Math.sqrt(0.5)) * unit);\r\n        ctx.lineTo(-(0.5 + Math.sqrt(0.5)) * unit, 0.5 * unit);\r\n        ctx.lineTo(-(0.5 + Math.sqrt(0.5)) * unit, -0.5 * unit);\r\n        ctx.lineTo(-0.5 * unit, -(0.5 + Math.sqrt(0.5)) * unit);\r\n        let grd = ctx.createRadialGradient(-0.1 * w, -0.1 * w, 1, 0, 0, 0.35 * w);\r\n        grd.addColorStop(0, 'white');\r\n        grd.addColorStop(1, '#AAAAFF');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#7D7DFF';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.globalAlpha *= 0.6;\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.1 * w, 0, 2 * Math.PI);\r\n        grd = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.1 * w);\r\n        grd.addColorStop(0, 'white');\r\n        grd.addColorStop(0.4, '#FF2D2D');\r\n        grd.addColorStop(1, '#FF2D2D');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#FF2D2D';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        if (this.active) {\r\n            grd = ctx.createRadialGradient(0, 0, 0, 0, 0, this.r * w);\r\n            grd.addColorStop(0, 'white');\r\n            grd.addColorStop(0.6, '#FF5151');\r\n            grd.addColorStop(1, '#FF0000');\r\n            if (!this.find) {\r\n                ctx.beginPath();\r\n                const parameters = {\r\n                    up: 1.5, down: 0.5, left: 1, right: 0,\r\n                }\r\n                ctx.arc(0, 0, this.r * w, (parameters[this.detail.direction] + 2 * this.rotateCycle - this.range * this.unfoldCycle) * Math.PI,\r\n                    (parameters[this.detail.direction] + 2 * this.rotateCycle + this.range * this.unfoldCycle) * Math.PI);\r\n                ctx.lineTo(0, 0);\r\n                ctx.fillStyle = grd;\r\n                ctx.fill();\r\n                ctx.closePath();\r\n            } else {\r\n                ctx.globalAlpha *= 0.4 * ((this.findCycle * 6) % 1);\r\n                ctx.beginPath();\r\n                ctx.arc(0, 0, this.r * w, 0, 2 * Math.PI);\r\n                ctx.fillStyle = grd;\r\n                ctx.fill();\r\n                ctx.closePath();\r\n            }\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.active = true;\r\n        this.lastFire = Date.now();\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 追蹤導彈 */\r\nexport class missile {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'missile';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = new Vec2(-1, -1);\r\n\r\n        this.detail = {\r\n            name: '追蹤導彈',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.target = null;\r\n        this.dirVec = new Vec2(0, 0);\r\n        this.speed = 2;\r\n        this.lastRecord = Date.now();\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new missile();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    update(objects, map) {\r\n        if (!this.pos.between(constant.mapStart, constant.mapStart.add(constant.mapSize.mul(w)))) return { type: 'destory' };\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].id !== this.id && objects[i].collision) {\r\n                let result = objects[i].collision({ type: 'sphere', pos: this.pos, r: 0.1 });\r\n                if (result === 'ice') this.speed *= 1.01;\r\n                else if (result === 'portal') this.pos = objects[i].teleport(objects);\r\n                else if (result === 'arrow') return { type: 'destory' };\r\n                else if (result === 'cymbalWave') return { type: 'destory' };\r\n                else if (result === 'missile') return { type: 'destory' };\r\n                else if (result === 'block') return { type: 'destory' };\r\n                else if (result === 'lockedWall') return { type: 'destory' };\r\n                else if (result === 'woodenBox') {\r\n                    objects[i].push(objects, map, this.pos);\r\n                    return { type: 'destory' };\r\n                }\r\n                else if (result === 'magneticField') this.pos = this.pos.add(objects[i].getDisplacement());\r\n            }\r\n        }\r\n        this.dirVec = this.target.pos.sub(this.pos).unit();\r\n        this.pos = this.pos.add(this.dirVec.mul(this.speed * w * (Date.now() - this.lastRecord) / 1000));\r\n        this.lastRecord = Date.now();\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.2 * w }, target)) return 'missile';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.9 : 1;\r\n        ctx.rotate(this.dirVec.radian() + 0.5 * Math.PI);\r\n\r\n        for (let i = 0; i < 2; i++) {\r\n            let p = (i === 0) ? -1 : 1;\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.164 * w * p, 0.2 * w);\r\n            ctx.lineTo(0.3 * w * p, 0.3 * w);\r\n            ctx.lineTo(0.3 * w * p, 0.45 * w);\r\n            ctx.lineTo(0.128 * w * p, 0.4 * w);\r\n            ctx.fillStyle = '#F0F0F0';\r\n            ctx.fill();\r\n            ctx.strokeStyle = '#C0C0C0';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.1 * w, 0.5 * w);\r\n        ctx.lineTo(-0.14 * w, 0.64 * w + 0.06 * w * Math.random());\r\n        ctx.lineTo(-0.03 * w, 0.56 * w);\r\n        ctx.lineTo(0 * w, 0.6 * w + 0.06 * w * Math.random());\r\n        ctx.lineTo(0.03 * w, 0.56 * w);\r\n        ctx.lineTo(0.14 * w, 0.64 * w + 0.06 * w * Math.random());\r\n        ctx.lineTo(0.1 * w, 0.5 * w);\r\n        ctx.fillStyle = '#FF9224';\r\n        ctx.fill();\r\n        ctx.lineWidth = 0.3;\r\n        ctx.strokeStyle = '#FF0000';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.lineWidth = 1;\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.2 * w, 0, Math.PI, true);\r\n        ctx.lineTo(-0.11 * w, 0.5 * w);\r\n        ctx.lineTo(0.11 * w, 0.5 * w);\r\n        ctx.lineTo(0.2 * w, 0);\r\n        ctx.fillStyle = '#F0F0F0';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#C0C0C0';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.195 * w, 0);\r\n        ctx.lineTo(0.195 * w, 0);\r\n        ctx.strokeStyle = 'red';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.186 * w, 0.05 * w);\r\n        ctx.lineTo(0.186 * w, 0.05 * w);\r\n        ctx.strokeStyle = 'red';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n}\r\n\r\n/* 鎖牆 */\r\nexport class lockedWall {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'lockedWall';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '上鎖的牆',\r\n            direction: 'horizontal',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.locked = true;\r\n        this.index = -1;\r\n\r\n        this.layer = new Layer(2, 3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new lockedWall();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            direction: { type: 'select', options: ['horizontal', 'vertical'] },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n\r\n            index: this.index,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n\r\n        this.index = objectSetting.index;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        const parameters = {\r\n            horizontal: new Vec2(w, 0.4 * w), vertical: new Vec2(0.4 * w, w),\r\n        };\r\n        if (this.locked && isCollision({ type: 'cube', pos: this.pos, size: parameters[this.detail.direction] }, target)) return 'lockedWall';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        if (!this.locked) return;\r\n\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.6 : 1;\r\n        if (this.detail.direction === 'vertical') ctx.rotate(0.5 * Math.PI);\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.5 * w, -0.1 * w, w, 0.2 * w);\r\n        ctx.fillStyle = '#9D9D9D';\r\n        ctx.fill();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.globalAlpha = 1;\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.2 * w, 0, 2 * Math.PI);\r\n        ctx.fillStyle = (this.index >= 0) ? colorList[this.index] : 'white';\r\n        ctx.fill();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, -0.06 * w, 0.08 * w, 0.375 * Math.PI, 0.625 * Math.PI, true);\r\n        ctx.lineTo(-0.04 * w, 0.13 * w);\r\n        ctx.lineTo(0.04 * w, 0.13 * w);\r\n        ctx.fillStyle = 'black';\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        if (this.index === -1) {\r\n            let usedIndex = [0, 0, 0, 0, 0, 0, 0, 0];\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].type === 'unlocker') usedIndex[objects[i].index] = Math.max(1, usedIndex[objects[i].index]);\r\n                if (objects[i].type === 'lockedWall') usedIndex[objects[i].index] = 2;\r\n            }\r\n            for (let i = 0; i < usedIndex.length; i++) {\r\n                if (usedIndex[i] === 1) {\r\n                    this.index = i;\r\n                    break;\r\n                }\r\n            }\r\n            if (this.index === -1) {\r\n                for (let i = 0; i < usedIndex.length; i++) {\r\n                    if (usedIndex[i] === 0) {\r\n                        this.index = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (this.index === -1) return false;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 鑰匙 */\r\nexport class unlocker {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'unlocker';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '鑰匙'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.used = false;\r\n        this.index = -1;\r\n\r\n        this.layer = new Layer(4);\r\n    }\r\n    clone() {\r\n        const cloneObject = new unlocker();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n\r\n            index: this.index,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.index = objectSetting.index;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (!this.used && isCollision({ type: 'sphere', pos: this.pos, r: 0.35 * w }, target)) return 'unlocker';\r\n        return 'none';\r\n    }\r\n    unlock(objects) {\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].type === 'lockedWall' && objects[i].index === this.index) {\r\n                objects[i].locked = false;\r\n                this.used = true;\r\n            }\r\n        }\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        if (this.used) return;\r\n\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n        ctx.rotate(0.25 * Math.PI);\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, -0.25 * w, 0.2 * w, 0.4 * Math.PI, 0.6 * Math.PI, true);\r\n        ctx.lineTo(-0.06 * w, 0.4 * w);\r\n        ctx.lineTo(0.06 * w, 0.45 * w);\r\n        ctx.lineTo(0.06 * w, 0.38 * w);\r\n        ctx.lineTo(0.15 * w, 0.38 * w);\r\n        ctx.lineTo(0.15 * w, 0.34 * w);\r\n        ctx.lineTo(0.06 * w, 0.34 * w);\r\n        ctx.lineTo(0.06 * w, 0.3 * w);\r\n        ctx.lineTo(0.18 * w, 0.3 * w);\r\n        ctx.lineTo(0.18 * w, 0.24 * w);\r\n        ctx.lineTo(0.06 * w, 0.24 * w);\r\n        let grd = ctx.createRadialGradient(0, -0.35 * w, 0, 0, 0, 0.5 * w);\r\n        grd.addColorStop(0, 'white');\r\n        grd.addColorStop(0.3, (this.index >= 0) ? colorList[this.index] : 'black');\r\n        grd.addColorStop(1, (this.index >= 0) ? colorList[this.index] : 'black');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        if (this.index === -1) {\r\n            let usedIndex = [0, 0, 0, 0, 0, 0, 0, 0];\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].type === 'lockedWall') usedIndex[objects[i].index] = Math.max(1, usedIndex[objects[i].index]);\r\n                if (objects[i].type === 'unlocker') usedIndex[objects[i].index] = 2;\r\n            }\r\n            for (let i = 0; i < usedIndex.length; i++) {\r\n                if (usedIndex[i] === 1) {\r\n                    this.index = i;\r\n                    break;\r\n                }\r\n            }\r\n            if (this.index === -1) {\r\n                for (let i = 0; i < usedIndex.length; i++) {\r\n                    if (usedIndex[i] === 0) {\r\n                        this.index = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (this.index === -1) return false;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        return true;\r\n    }\r\n    remove(map, objects) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 方塊 */\r\nexport class block {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'block';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '方塊',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new block();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(w, w) }, target)) return 'block';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.4 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-0.5 * w, -0.5 * w);\r\n        ctx.lineTo(0.5 * w, -0.5 * w);\r\n        ctx.lineTo(0.5 * w, 0.5 * w);\r\n        ctx.lineTo(-0.5 * w, 0.5 * w);\r\n        ctx.lineTo(-0.5 * w, -0.5 * w);\r\n        ctx.fillStyle = '#7B7B7B';\r\n        ctx.fill();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.5 * w, -0.5 * w, w, w);\r\n        ctx.fillStyle = '#9D9D9D';\r\n        ctx.fill();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 移動平台-斜向 */\r\nexport class movingPlatform_oblique {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'movingPlatform_oblique';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '移動平台(斜向)',\r\n            direction: 'right-up',\r\n            distance: 1,\r\n            speed: 'normal',\r\n        };\r\n\r\n        this.loadable = true;\r\n        this.loadObject = null;\r\n\r\n        this.lastRecord = Date.now();\r\n        this.active = false;\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(0, 1);\r\n    }\r\n    clone() {\r\n        const cloneObject = new movingPlatform_oblique();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            distance: { type: 'int', min: 1, max: 15 },\r\n            direction: { type: 'select', options: ['right-up', 'right-down', 'left-up', 'left-down'] },\r\n            speed: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n            distance: this.detail.distance,\r\n            speed: this.detail.speed,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n        this.detail.distance = objectSetting.distance;\r\n        this.detail.speed = objectSetting.speed;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            'super slow': 5600, 'slow': 2800, 'normal': 1400, 'fast': 700, 'super fast': 280,\r\n        };\r\n        const dirVec = Vec2.direction(this.detail.direction).mul(this.detail.distance * w * Math.sqrt(2));\r\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n        if (~~((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 2 === 0) {\r\n            this.pos = originPos.add(dirVec.mul(((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\r\n        } else {\r\n            this.pos = originPos.add(dirVec.mul(1 - ((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\r\n        }\r\n        if (this.loadObject) this.loadObject.object.pos = this.pos;\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'movingPlatform';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n        if (this.active) ctx.translate(originPos.x, originPos.y);\r\n        else ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        if (layer === -1 || layer === 0) {\r\n            ctx.save();\r\n            const dirVec = Vec2.direction(this.detail.direction).mul(this.detail.distance * w * Math.sqrt(2));\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, 0);\r\n            ctx.lineTo(dirVec.x, dirVec.y);\r\n            ctx.strokeStyle = '#4F4F4F';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.save();\r\n            ctx.translate(dirVec.x, dirVec.y);\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n            ctx.restore();\r\n\r\n            ctx.restore();\r\n        }\r\n\r\n        if (layer === -1 || layer === 1) {\r\n            if (this.active) {\r\n                const relativePos = this.pos.sub(originPos);\r\n                ctx.translate(relativePos.x, relativePos.y);\r\n            }\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, (-0.45) * w);\r\n            ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\r\n            ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\r\n            ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\r\n            ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\r\n            ctx.lineTo(0, (-0.45) * w);\r\n            ctx.fillStyle = '#ead48b';\r\n            ctx.fill();\r\n            ctx.strokeStyle = '#cb934d';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, (-0.35) * w);\r\n            ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n            ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n            ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n            ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n            ctx.lineTo(0, (-0.35) * w);\r\n            ctx.strokeStyle = '#f4f788';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.active = true;\r\n        this.lastRecord = Date.now();\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    this.loadObject = {\r\n                        id: objects[i].id,\r\n                        object: objects[i],\r\n                    };\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 移動平台-矩形 */\r\nexport class movingPlatform_rect {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'movingPlatform_rect';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '移動平台(矩形)',\r\n            clock: 'clockwise',\r\n            width: 1,\r\n            height: 1,\r\n            speed: 'normal',\r\n        };\r\n\r\n        this.loadable = true;\r\n        this.loadObject = null;\r\n\r\n        this.lastRecord = Date.now();\r\n        this.active = false;\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(0, 1);\r\n    }\r\n    clone() {\r\n        const cloneObject = new movingPlatform_rect();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            clock: { type: 'select', options: ['clockwise', 'counterclockwise'] },\r\n            width: { type: 'int', min: 1, max: 15 },\r\n            height: { type: 'int', min: 1, max: 15 },\r\n            speed: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            clock: this.detail.clock,\r\n            width: this.detail.width,\r\n            height: this.detail.height,\r\n            speed: this.detail.speed,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.start = objectSetting.start;\r\n        this.detail.width = objectSetting.width;\r\n        this.detail.height = objectSetting.height;\r\n        this.detail.speed = objectSetting.speed;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        const parameters = {\r\n            'super slow': 4000, 'slow': 2000, 'normal': 1000, 'fast': 500, 'super fast': 200,\r\n        };\r\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n        let totalDist = this.detail.width * 2 + this.detail.height * 2;\r\n        let cycleList = (this.detail.clockwise === 'clockwise') ?\r\n            [0, this.detail.height / totalDist, (this.detail.height + this.detail.width) / totalDist, (2 * this.detail.height + this.detail.width) / totalDist] :\r\n            [0, this.detail.width / totalDist, (this.detail.height + this.detail.width) / totalDist, (this.detail.height + 2 * this.detail.width) / totalDist];\r\n        let pointList = (this.detail.clockwise === 'clockwise') ?\r\n            [originPos, originPos.add(new Vec2(0, - this.detail.height * w)), originPos.add(new Vec2(this.detail.width * w, - this.detail.height * w)), originPos.add(new Vec2(this.detail.width * w, 0))] :\r\n            [originPos, originPos.add(new Vec2(this.detail.width * w, 0)), originPos.add(new Vec2(this.detail.width * w, - this.detail.height * w)), originPos.add(new Vec2(0, - this.detail.height * w))]  ;\r\n        let moveCycle = ((Date.now() - this.lastRecord) / parameters[this.detail.speed] / totalDist) % 1;\r\n        if (moveCycle >= cycleList[0] && moveCycle < cycleList[1]) {\r\n            this.pos = pointList[0].add(pointList[1].sub(pointList[0]).mul((moveCycle - cycleList[0]) / (cycleList[1] - cycleList[0])));\r\n        } else if (moveCycle >= cycleList[1] && moveCycle < cycleList[2]) {\r\n            this.pos = pointList[1].add(pointList[2].sub(pointList[1]).mul((moveCycle - cycleList[1]) / (cycleList[2] - cycleList[1])));\r\n        } else if (moveCycle >= cycleList[2] && moveCycle < cycleList[3]) {\r\n            this.pos = pointList[2].add(pointList[3].sub(pointList[2]).mul((moveCycle - cycleList[2]) / (cycleList[3] - cycleList[2])));\r\n        } else {\r\n            this.pos = pointList[3].add(pointList[0].sub(pointList[3]).mul((moveCycle - cycleList[3]) / (1 - cycleList[3])));\r\n        }\r\n        if (this.loadObject) this.loadObject.object.pos = this.pos;\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'movingPlatform';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n        if (this.active) ctx.translate(originPos.x, originPos.y);\r\n        else ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        if (layer === -1 || layer === 0) {\r\n            ctx.save();\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(0, - this.detail.height * w, this.detail.width * w, this.detail.height * w);\r\n            ctx.lineWidth = 1;\r\n            ctx.strokeStyle = '#4F4F4F';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w, -0.1 * w - this.detail.height * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w + this.detail.width * w, -0.1 * w - this.detail.height * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.rect(-0.1 * w + this.detail.width * w, -0.1 * w, 0.2 * w, 0.2 * w);\r\n            ctx.fillStyle = '#4F4F4F';\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.restore();\r\n        }\r\n\r\n        if (layer === -1 || layer === 1) {\r\n            if (this.active) {\r\n                const relativePos = this.pos.sub(originPos);\r\n                ctx.translate(relativePos.x, relativePos.y);\r\n            }\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, (-0.45) * w);\r\n            ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\r\n            ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\r\n            ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\r\n            ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\r\n            ctx.lineTo(0, (-0.45) * w);\r\n            ctx.fillStyle = '#ead48b';\r\n            ctx.fill();\r\n            ctx.strokeStyle = '#cb934d';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, (-0.35) * w);\r\n            ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n            ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n            ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n            ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n            ctx.lineTo(0, (-0.35) * w);\r\n            ctx.strokeStyle = '#f4f788';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.active = true;\r\n        this.lastRecord = Date.now();\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    this.loadObject = {\r\n                        id: objects[i].id,\r\n                        object: objects[i],\r\n                    };\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 木箱 */\r\nexport class woodenBox {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'woodenBox';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '木箱',\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.moveTo = 'none';\r\n        this.moveTime = 500;\r\n        this.moveCycle = 0;\r\n        this.lastRecord = 0;\r\n\r\n        this.layer = new Layer(3);\r\n    }\r\n    clone() {\r\n        const cloneObject = new woodenBox();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        if (this.moveTo !== 'none') {\r\n            let moveRate = (Date.now() - this.lastRecord) / this.moveTime;\r\n            this.moveCycle += moveRate;\r\n            this.lastRecord = Date.now();\r\n            this.pos = this.pos.add(Vec2.direction(this.moveTo).mul(w * moveRate));\r\n            if (this.moveCycle >= 1) {\r\n                this.moveTo = 'none';\r\n                this.pos = this.pos.sub(constant.mapStart).toGrid(w).mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n            }\r\n        } else {\r\n            let gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].type !== 'brokenPlatform' && objects[i].type !== 'magnet' && objects[i].type !== 'conveyor' && objects[i].type !== 'mucus') continue;\r\n                if (objects[i].id !== this.id && objects[i].collision) {\r\n                    let result = objects[i].collision({ type: 'sphere', pos: this.pos, r: 0.1 });\r\n                    if (result === 'brokenPlatform') objects[i].break();\r\n                    if (result === 'conveyor') {\r\n                        this.pos = objects[i].pos.clone();\r\n                        this.push(objects, map, this.pos.sub(Vec2.direction(objects[i].detail.direction)));\r\n                        break;\r\n                    } else if (result === 'magneticField') {\r\n                        this.push(objects, map, this.pos.sub(objects[i].getDisplacement()));\r\n                        break;\r\n                    } else if (result === 'mucus' && !objects[i].loadObject) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                        map[this.gridPos.y][this.gridPos.x].layer.status[3] = false;\r\n                    }\r\n                    \r\n                }\r\n            }\r\n        }\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(w, w) }, target)) return 'woodenBox';\r\n        return 'none';\r\n    }\r\n    push(objects, map, targetPos) {\r\n        if (this.moveTo !== 'none') return;\r\n        let gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let radian = targetPos.sub(this.pos).radian();\r\n        if (radian >= 0.25 * Math.PI && radian < 0.75 * Math.PI) { // 上\r\n            if (gridPos.y === 0 || map[gridPos.y - 1][gridPos.x].type === 'block') return;\r\n            for (let i = 0; i < objects.length; i++) {\r\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\r\n                if (searchGridPos.equal(new Vec2(gridPos.x, gridPos.y - 1)) && objects[i].layer.status[3]) return;\r\n            }\r\n            this.moveTo = 'up';\r\n        } else if (radian >= 1.75 * Math.PI || radian < 0.25 * Math.PI) { // 左\r\n            if (gridPos.x === 0 || map[gridPos.y][gridPos.x - 1].type === 'block') return;\r\n            for (let i = 0; i < objects.length; i++) {\r\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\r\n                if (searchGridPos.equal(new Vec2(gridPos.x - 1, gridPos.y)) && objects[i].layer.status[3]) return;\r\n            }\r\n            this.moveTo = 'left';\r\n        } else if (radian >= 1.25 * Math.PI && radian < 1.75 * Math.PI) { // 下\r\n            if (gridPos.y === constant.mapSize.y - 1 || map[gridPos.y + 1][gridPos.x].type === 'block') return;\r\n            for (let i = 0; i < objects.length; i++) {\r\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\r\n                if (searchGridPos.equal(new Vec2(gridPos.x, gridPos.y + 1)) && objects[i].layer.status[3]) return;\r\n            }\r\n            this.moveTo = 'down';\r\n        } else { // 右\r\n            if (gridPos.x === constant.mapSize.x - 1 || map[gridPos.y][gridPos.x + 1].type === 'block') return;\r\n            for (let i = 0; i < objects.length; i++) {\r\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\r\n                if (searchGridPos.equal(new Vec2(gridPos.x + 1, gridPos.y)) && objects[i].layer.status[3]) return;\r\n            }\r\n            this.moveTo = 'right';\r\n        }\r\n        map[this.gridPos.y][this.gridPos.x].layer.status[3] = false;\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].type === 'mucus') {\r\n                if (objects[i].loadObject && objects[i].loadObject.id === this.id) {\r\n                    objects[i].loadObject = null;\r\n                    this.pos = this.pos.sub(constant.mapStart).toGrid(w).mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n                }\r\n            }\r\n        }\r\n        this.moveCycle = 0;\r\n        this.lastRecord = Date.now();\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.7 : 1;\r\n        ctx.lineWidth = 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.45 * w, -0.4 * w, 0.9 * w, 0.8 * w);\r\n        ctx.fillStyle = '#e4b95e';\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.5 * w, -0.5 * w, w, 0.1 * w);\r\n        ctx.fillStyle = '#dab25d';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#806938';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.5 * w, 0.4 * w, w, 0.1 * w);\r\n        ctx.fillStyle = '#dab25d';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#806938';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        for (let i = 0; i < 7; i++) {\r\n            ctx.beginPath();\r\n            ctx.moveTo((-0.45 + i * 0.15) * w, -0.4 * w);\r\n            ctx.lineTo((-0.45 + i * 0.15) * w, 0.4 * w);\r\n            ctx.strokeStyle = '#806938';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        for (let i = 0; i < objects.length; i++) {\r\n            if (objects[i].layer.top() === 2) {\r\n                if (objects[i].loadObject && objects[i].loadObject.id === this.id) {\r\n                    objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* 磁鐵 */\r\nexport class magnet {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'magnet';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '磁鐵',\r\n            direction: 'up',\r\n            magneticField: 'attraction',\r\n            distance: 3,\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.active = false;\r\n        this.perspective = false;\r\n\r\n        this.lastRecord = 0;\r\n        this.moveCycle = -1;\r\n\r\n        this.layer = new Layer(4);\r\n    }\r\n    clone() {\r\n        const cloneObject = new magnet();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' },\r\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\r\n            magneticField: { type: 'select', options: ['attraction', 'repulsion'] },\r\n            distance: { type: 'int', min: 1, max: 15 },\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n            direction: this.detail.direction,\r\n            magneticField: this.detail.magneticField,\r\n            distance: this.detail.distance,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n        this.detail.direction = objectSetting.direction;\r\n        this.detail.magneticField = objectSetting.magneticField;\r\n        this.detail.distance = objectSetting.distance;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        if (Date.now() - this.lastRecord > 1000) this.lastRecord = Date.now();\r\n        this.moveCycle = (Date.now() - this.lastRecord) / 1000;\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        let dirVec = Vec2.direction(this.detail.direction).mul(w * this.detail.distance / 2);\r\n        let size = (this.detail.direction === 'up' || this.detail.direction === 'down') ? new Vec2(w, this.detail.distance * w + 0.5 * w) : new Vec2(this.detail.distance * w + 0.5 * w, w) ;\r\n        if (isCollision({ type: 'cube', pos: this.pos.add(dirVec), size: size }, target)) return 'magneticField';\r\n        return 'none';\r\n    }\r\n    getDisplacement() {\r\n        return Vec2.direction(this.detail.direction).mul((this.detail.magneticField === 'attraction')? -1: 1).mul(w * 0.01);\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n        let dir = this.detail.direction;\r\n        ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0.4 * w, -0.4 * w);\r\n        ctx.arc(0, 0, 0.4 * w, 0, Math.PI);\r\n        ctx.lineTo(-0.4 * w, -0.4 * w);\r\n        ctx.lineTo(-0.2 * w, -0.4 * w);\r\n        ctx.lineTo(-0.2 * w, 0);\r\n        ctx.arc(0, 0, 0.2 * w, Math.PI, 0, true);\r\n        ctx.lineTo(0.2 * w, -0.4 * w);\r\n        ctx.lineTo(0.4 * w, -0.4 * w);\r\n        ctx.fillStyle = '#43315e';\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(-0.38 * w, -0.4 * w, 0.16 * w, 0.3 * w);\r\n        ctx.fillStyle = 'red';\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.textAlign = \"center\";\r\n        ctx.textBaseline = 'middle';\r\n        ctx.font = \"5px italic\";\r\n        ctx.fillStyle = 'white';\r\n        ctx.fillText(\"N\", -0.3 * w, -0.25 * w);\r\n\r\n        ctx.beginPath();\r\n        ctx.rect(0.22 * w, -0.4 * w, 0.16 * w, 0.3 * w);\r\n        ctx.fillStyle = 'blue';\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        ctx.textAlign = \"center\";\r\n        ctx.textBaseline = 'middle';\r\n        ctx.font = \"6px italic\";\r\n        ctx.fillStyle = 'white';\r\n        ctx.fillText(\"S\", 0.3 * w, -0.25 * w);\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0.4 * w, -0.4 * w);\r\n        ctx.arc(0, 0, 0.4 * w, 0, Math.PI);\r\n        ctx.lineTo(-0.4 * w, -0.4 * w);\r\n        ctx.lineTo(-0.2 * w, -0.4 * w);\r\n        ctx.lineTo(-0.2 * w, 0);\r\n        ctx.arc(0, 0, 0.2 * w, Math.PI, 0, true);\r\n        ctx.lineTo(0.2 * w, -0.4 * w);\r\n        ctx.lineTo(0.4 * w, -0.4 * w);\r\n        ctx.strokeStyle = 'black';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        if (this.active && this.moveCycle >= 0) {\r\n            ctx.beginPath();\r\n            ctx.rect(-0.5 * w, -0.5 * w - w * this.detail.distance, w, w * this.detail.distance);\r\n            ctx.clip();\r\n            ctx.closePath();\r\n\r\n            ctx.globalAlpha = 0.3;\r\n            ctx.translate(0, w * this.moveCycle * ((this.detail.magneticField == 'repulsion') ? -1 : 1));\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.3 * w, 0.5 * w);\r\n            ctx.lineTo(-0.3 * w, 0.5 * w - w * this.detail.distance - 2 * w);\r\n            ctx.setLineDash([0.5, 0, 5]);\r\n            ctx.strokeStyle = 'gray';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, 0.5 * w);\r\n            ctx.lineTo(0, 0.5 * w - w * this.detail.distance - 2 * w);\r\n            ctx.setLineDash([0.5, 0, 5]);\r\n            ctx.strokeStyle = 'gray';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.3 * w, 0.5 * w);\r\n            ctx.lineTo(0.3 * w, 0.5 * w - w * this.detail.distance - 2 * w);\r\n            ctx.setLineDash([0.5, 0, 5]);\r\n            ctx.strokeStyle = 'gray';\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.active = true;\r\n        this.moveCycle = -1;\r\n        this.lastRecord = Date.now();\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        this.lastRecord = Date.now();\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        this.active = false;\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 破碎平台 */\r\nexport class brokenPlatform {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'brokenPlatform';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '破碎平台'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.lastRecord = 0;\r\n        this.stage = 0;\r\n        this.count = 0;\r\n        this.stageCount = 64;\r\n\r\n        this.layer = new Layer(1, 2);\r\n    }\r\n    clone() {\r\n        const cloneObject = new brokenPlatform();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    update(objects, map) {\r\n        if (this.count >= this.stageCount && this.stage < 4) {\r\n            this.count = 0;\r\n            this.stage += 1;\r\n        }\r\n        return { type: 'none' };\r\n    }\r\n    collision(target) {\r\n        if (this.stage < 4 && isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.99 * w, 0.99 * w) }, target)) return 'brokenPlatform';\r\n        return 'none';\r\n    }\r\n    break() {\r\n        this.count += 1;\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        if (this.stage === 4) return;\r\n\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.45) * w);\r\n        ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\r\n        ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\r\n        ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\r\n        ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.45) * w);\r\n        ctx.fillStyle = '#D0D0D0';\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#ADADAD';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.35) * w);\r\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.35) * w);\r\n        ctx.strokeStyle = '#F0F0F0';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        if (this.stage >= 0) {\r\n            ctx.save();\r\n            ctx.strokeStyle = '#ADADAD';\r\n            ctx.globalAlpha *= (this.stage > 0) ? 1: (this.count) / this.stageCount;\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.1 * w, -0.45 * w);\r\n            ctx.lineTo(0.05 * w, -0.35 * w);\r\n            ctx.lineTo(0.15 * w, -0.25 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.45 * w, 0.15 * w);\r\n            ctx.lineTo(-0.35 * w, -0.05 * w);\r\n            ctx.lineTo(-0.25 * w, 0.05 * w);\r\n            ctx.lineTo(-0.15 * w, -0.15 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.15 * w, 0.45 * w);\r\n            ctx.lineTo(0.25 * w, 0.4 * w);\r\n            ctx.lineTo(0.2 * w, 0.3 * w);\r\n            ctx.lineTo(0.35 * w, 0.1 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n            ctx.restore();\r\n        }\r\n\r\n        if (this.stage >= 1) {\r\n            ctx.save();\r\n            ctx.strokeStyle = '#ADADAD';\r\n            ctx.globalAlpha *= (this.stage > 1) ? 1 : (this.count) / this.stageCount;\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.15 * w, 0.45 * w);\r\n            ctx.lineTo(0 * w, 0.35 * w);\r\n            ctx.lineTo(-0.1 * w, 0.25 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.45 * w, -0.3 * w);\r\n            ctx.lineTo(0.35 * w, -0.2 * w);\r\n            ctx.lineTo(0.3 * w, -0.05 * w);\r\n            ctx.lineTo(0.1 * w, -0.15 * w);\r\n            ctx.lineTo(-0.1 * w, 0.05 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.35 * w, -0.45 * w);\r\n            ctx.lineTo(-0.2 * w, -0.3 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n            ctx.restore();\r\n        }\r\n\r\n        if (this.stage >= 2) {\r\n            ctx.save();\r\n            ctx.strokeStyle = '#ADADAD';\r\n            ctx.globalAlpha *= (this.stage > 2) ? 1 : (this.count) / this.stageCount;\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.45 * w, 0.37 * w);\r\n            ctx.lineTo(-0.36 * w, 0.3 * w);\r\n            ctx.lineTo(-0.23 * w, 0.35 * w);\r\n            ctx.lineTo(-0.01 * w, 0.09 * w);\r\n            ctx.lineTo(0.23 * w, 0.21 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.45 * w, 0.21 * w);\r\n            ctx.lineTo(-0.2 * w, 0.16 * w);\r\n            ctx.lineTo(-0.02 * w, -0.02 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.05 * w, -0.45 * w);\r\n            ctx.lineTo(-0.18 * w, -0.36 * w);\r\n            ctx.lineTo(0.03 * w, -0.28 * w);\r\n            ctx.lineTo(-0.28 * w, -0.16 * w);\r\n            ctx.lineTo(-0.38 * w, -0.25 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.34 * w, -0.45 * w);\r\n            ctx.lineTo(0.27 * w, -0.32 * w);\r\n            ctx.lineTo(0.3 * w, -0.09 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.45 * w, 0.31 * w);\r\n            ctx.lineTo(0.4 * w, 0.14 * w);\r\n            ctx.lineTo(0.3 * w, 0.22 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(0.45 * w, 0.01 * w);\r\n            ctx.lineTo(0.2 * w, 0.03 * w);\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n            ctx.restore();\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects = null) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        return true;\r\n    }\r\n    remove(map, objects = null) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n    }\r\n}\r\n\r\n/* 死亡圖騰 */\r\nexport class deathTotem {\r\n    constructor(pos = new Vec2(0, 0)) {\r\n        this.type = 'deathTotem';\r\n        this.id = uuidv4();\r\n        this.pos = pos;\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n\r\n        this.detail = {\r\n            name: '死亡圖騰'\r\n        };\r\n\r\n        this.loadable = false;\r\n\r\n        this.perspective = false;\r\n\r\n        this.layer = new Layer(2);\r\n    }\r\n    clone() {\r\n        const cloneObject = new deathTotem();\r\n        cloneObject.unpackage(this.enpackage());\r\n        return cloneObject;\r\n    }\r\n    setPerspective(perspective) {\r\n        this.perspective = perspective;\r\n    }\r\n    detailFunction() {\r\n        return {\r\n            name: { type: 'text' }\r\n        };\r\n    }\r\n    enpackage() {\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\r\n\r\n            name: this.detail.name,\r\n        };\r\n    }\r\n    unpackage(objectSetting) {\r\n        this.type = objectSetting.type;\r\n        this.id = objectSetting.id;\r\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\r\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\r\n\r\n        this.detail.name = objectSetting.name;\r\n\r\n        this.perspective = true;\r\n    }\r\n    collision(target) {\r\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'deathTotem';\r\n        return 'none';\r\n    }\r\n    draw(ctx, layer = -1) {\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-0.35) * w);\r\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\r\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\r\n        ctx.lineTo(0, (-0.35) * w);\r\n        let grd = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.45 * w);\r\n        grd.addColorStop(0, '#E800E8');\r\n        grd.addColorStop(1, '#5E005E');\r\n        ctx.fillStyle = grd;\r\n        ctx.fill();\r\n        ctx.strokeStyle = '#460046';\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        ctx.globalAlpha = 1;\r\n        ctx.scale(0.8, 0.8);\r\n        \r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 0.25 * w, 0.25 * Math.PI, 0.75 * Math.PI, true);\r\n        ctx.lineTo(-0.1 * w, 0.3 * w);\r\n        ctx.lineTo(0.1 * w, 0.3 * w);\r\n        let grd2 = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.2 * w);\r\n        grd2.addColorStop(0, 'white');\r\n        grd2.addColorStop(1, '#E0E0E0');\r\n        ctx.fillStyle = grd2;\r\n        ctx.fill();\r\n        ctx.closePath();\r\n\r\n        for (let i = 0; i < 3; i++) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.08 * w + 0.08 * i * w, 0.31 * w);\r\n            ctx.lineTo(-0.08 * w + 0.08 * i * w, 0.24 * w);\r\n            ctx.strokeStyle = grd;\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        }\r\n\r\n        for (let i = 0; i < 2; i++) {\r\n            ctx.beginPath();\r\n            ctx.arc(-0.1 * w, -0.01 * w, 0.08 * w, 0.16 * Math.PI, 1.16 * Math.PI);\r\n            ctx.fillStyle = grd;\r\n            ctx.fill();\r\n            ctx.closePath();\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(-0.02 * w, 0.1 * w);\r\n            ctx.lineTo(-0.045 * w, 0.16 * w);\r\n            ctx.strokeStyle = grd;\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n\r\n            ctx.scale(-1, 1);\r\n        }\r\n\r\n        ctx.restore();\r\n    }\r\n    place(map, objects) {\r\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\r\n        let gridPos = this.gridPos;\r\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\r\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\r\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) {\r\n                        objects[i].loadObject = {\r\n                            id: this.id,\r\n                            object: this,\r\n                        };\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    remove(map, objects) {\r\n        let gridPos = this.gridPos;\r\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\r\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\r\n            for (let i = 0; i < objects.length; i++) {\r\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\r\n                    if (objects[i].loadable) objects[i].loadObject = null;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import constant from './constant';\r\nimport Layer from './Class/Layer';\r\nimport { spikedBlock, platform, bow, movingPlatform, mucus, cymbal, ice, conveyor, portal, trapPlatform, missileBase, lockedWall, unlocker, block, movingPlatform_oblique, movingPlatform_rect, woodenBox, magnet, brokenPlatform, deathTotem } from './Class/GameObject';\r\n\r\nexport function enpackage(setting) {\r\n    const levelSetting = {\r\n        map: [],\r\n        objects: [],\r\n    };\r\n    /* 地圖打包 */\r\n    for (let i = 0; i < constant.mapSize.y; i++) {\r\n        let types = [];\r\n        for (let j = 0; j < constant.mapSize.x; j++) {\r\n            types[j] = { type: setting.map[i][j].type }; \r\n        }\r\n        levelSetting.map[i] = types;\r\n    } \r\n    /* 物件打包 */\r\n    let count = 0;\r\n    for (let i = 0; i < setting.objects.length; i++) {\r\n        if (setting.objects[i].enpackage) levelSetting.objects[count++] = setting.objects[i].enpackage();\r\n    }\r\n    return levelSetting;\r\n}\r\n\r\nexport function unpackage(levelSetting) {\r\n    const setting = {\r\n        map: [],\r\n        objects: [],\r\n    } \r\n    /* 地圖拆包 */\r\n    for (let i = 0; i < constant.mapSize.y; i++) {\r\n        let types = [];\r\n        for (let j = 0; j < constant.mapSize.x; j++) {\r\n            types[j] = { type: levelSetting.map[i][j].type, layer: new Layer() };\r\n        }\r\n        setting.map[i] = types;\r\n    }\r\n    /* 物件拆包 */\r\n    for (let i = 0; i < levelSetting.objects.length; i++) {\r\n        switch (levelSetting.objects[i].type) {\r\n            case 'spikedBlock':\r\n                setting.objects[i] = new spikedBlock();\r\n                break;\r\n            case 'platform':\r\n                setting.objects[i] = new platform();\r\n                break;\r\n            case 'movingPlatform':\r\n                setting.objects[i] = new movingPlatform();\r\n                break;\r\n            case 'bow':\r\n                setting.objects[i] = new bow();\r\n                break;\r\n            case 'mucus':\r\n                setting.objects[i] = new mucus();\r\n                break;\r\n            case 'cymbal':\r\n                setting.objects[i] = new cymbal();\r\n                break;\r\n            case 'ice':\r\n                setting.objects[i] = new ice();\r\n                break;\r\n            case 'conveyor':\r\n                setting.objects[i] = new conveyor();\r\n                break;\r\n            case 'portal':\r\n                setting.objects[i] = new portal();\r\n                break;\r\n            case 'trapPlatform':\r\n                setting.objects[i] = new trapPlatform();\r\n                break;\r\n            case 'missileBase':\r\n                setting.objects[i] = new missileBase();\r\n                break;\r\n            case 'lockedWall':\r\n                setting.objects[i] = new lockedWall();\r\n                break;\r\n            case 'unlocker':\r\n                setting.objects[i] = new unlocker();\r\n                break;\r\n            case 'block':\r\n                setting.objects[i] = new block();\r\n                break;\r\n            case 'movingPlatform_oblique':\r\n                setting.objects[i] = new movingPlatform_oblique();\r\n                break;\r\n            case 'movingPlatform_rect':\r\n                setting.objects[i] = new movingPlatform_rect();\r\n                break;\r\n            case 'woodenBox':\r\n                setting.objects[i] = new woodenBox();\r\n                break\r\n            case 'magnet':\r\n                setting.objects[i] = new magnet();\r\n                break;\r\n            case 'brokenPlatform':\r\n                setting.objects[i] = new brokenPlatform();\r\n                break;\r\n            case 'deathTotem':\r\n                setting.objects[i] = new deathTotem();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        setting.objects[i].unpackage(levelSetting.objects[i]);\r\n        setting.objects[i].place(setting.map, setting.objects);\r\n    }\r\n    return setting;\r\n}\r\n\r\nexport function show(levelSetting) {\r\n    const util = require('util');\r\n\r\n    console.log(util.inspect(levelSetting, { showHidden: false, depth: null }));\r\n}","export default function LoadingPage(props) {\r\n  return (\r\n    <>\r\n      <h1>Loading</h1>\r\n    </>\r\n  );\r\n}\r\n","import Vec2 from './Class/Vec2';\r\nimport constant from './constant';\r\n\r\nexport function clear(ctx, pos = { x: 0, y: 0 }, size = { x: ctx.canvas.width, y: ctx.canvas.height }) {\r\n\tctx.clearRect(pos.x, pos.y, size.x, size.y);\r\n}\r\n\r\nexport function drawMap(ctx, map, playMode = false) {\r\n\tconst mapSize = constant.mapSize;\r\n\tconst w = constant.gridWidth; \r\n\tconst blockColor = constant.blockColor;\r\n\tconst startColor = constant.startColor;\r\n\tconst endColor = constant.endColor;\r\n\tconst noneColor = constant.noneColor;\r\n\tconst deadColor = constant.deadColor;\r\n\tconst iceColor = constant.iceColor;\r\n\tconst muddyColor = constant.muddyColor;\r\n\tconst boundaryColor = constant.boundaryColor;\r\n\tconst auxiliaryColor = constant.auxiliaryColor; \r\n\tconst relation = (pos1, pos2) => {\r\n\t\tif (map[pos1.y][pos1.x].type.includes('block') && map[pos2.y][pos2.x].type.includes('block')) return 'b_b';\r\n\t\tif (map[pos1.y][pos1.x].type.includes('block') || map[pos2.y][pos2.x].type.includes('block')) return 'n_b';\r\n\t\treturn 'n_n';\r\n\t};\r\n\r\n\tfor (let y = 0; y < mapSize.y; y++) {\r\n\t\tfor (let x = 0; x < mapSize.x; x++) {\r\n\t\t\tif (map[y][x].type === 'block') continue;\r\n\t\t\tctx.save();\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(x * w, y * w, w, w);\r\n\t\t\tctx.fillStyle = (map[y][x].type.includes('start')) ? startColor :\r\n\t\t\t\t\t\t\t(map[y][x].type.includes('end')) ? endColor :\r\n\t\t\t\t\t\t\t(map[y][x].type.includes('dead')) ? deadColor :\r\n\t\t\t\t\t\t\t(map[y][x].type.includes('ice')) ? iceColor :\r\n\t\t\t\t\t\t\t(map[y][x].type.includes('muddy')) ? muddyColor : noneColor;\r\n\t\t\tctx.fill();\r\n\t\t\tctx.closePath();\r\n\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\tif (!playMode) {\r\n\t\tfor (let y = 1; y < mapSize.y; y++) {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(0, y * w);\r\n\t\t\tctx.lineTo(mapSize.x * w, y * w);\r\n\t\t\tctx.strokeStyle = auxiliaryColor;\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.closePath();\r\n\t\t}\r\n\t\tfor (let x = 0; x < mapSize.x; x++) {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(x * w, 0);\r\n\t\t\tctx.lineTo(x * w, mapSize.y * w);\r\n\t\t\tctx.strokeStyle = auxiliaryColor;\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.closePath();\r\n\t\t}\r\n\t}\r\n\tfor (let y = 0; y <= mapSize.y; y++) {\r\n\t\tfor (let x = 0; x <= mapSize.x; x++) {\r\n\t\t\tctx.save();\r\n\t\t\tif (x >= 0 && x < mapSize.x && y >= 0 && y < mapSize.y) {\r\n\t\t\t\tif (map[y][x].type === 'block') {\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.rect(x * w, y * w, w, w);\r\n\t\t\t\t\tctx.fillStyle = blockColor;\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t\tctx.closePath();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t/* 繪製橫向格線 */\r\n\t\t\tif (x !== mapSize.x) {\r\n\t\t\t\tif (y > 0 && y < mapSize.y) {\r\n\t\t\t\t\tlet r = relation(new Vec2(x, y - 1), new Vec2(x, y));\r\n\t\t\t\t\tif (r === 'n_b') {\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(x * w, y * w);\r\n\t\t\t\t\t\tctx.lineTo((x + 1) * w, y * w);\r\n\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (y === 0) {\r\n\t\t\t\t\t\tif (map[y][x].type !== 'block') {\r\n\t\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\r\n\t\t\t\t\t\t\tctx.lineTo((x + 1) * w, y * w);\r\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (y === mapSize.y) {\r\n\t\t\t\t\t\tif (map[y - 1][x].type !== 'block') {\r\n\t\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\r\n\t\t\t\t\t\t\tctx.lineTo((x + 1) * w, y * w);\r\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t/* 繪製縱向格線 */\r\n\t\t\tif (y !== mapSize.y) {\r\n\t\t\t\tif (x > 0 && x < mapSize.x) {\r\n\t\t\t\t\tlet r = relation(new Vec2(x - 1, y), new Vec2(x, y));\r\n\t\t\t\t\tif (r === 'n_b') {\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(x * w, y * w);\r\n\t\t\t\t\t\tctx.lineTo(x * w, (y + 1) * w);\r\n\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (x === 0) {\r\n\t\t\t\t\t\tif (map[y][x].type !== 'block') {\r\n\t\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\r\n\t\t\t\t\t\t\tctx.lineTo(x * w, (y + 1) * w);\r\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (x === mapSize.x) {\r\n\t\t\t\t\t\tif (map[y][x - 1].type !== 'block') {\r\n\t\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\r\n\t\t\t\t\t\t\tctx.lineTo(x * w, (y + 1) * w);\r\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tctx.restore();\r\n\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function drawPlayKey(ctx, size = 1) {\r\n\tctx.save();\r\n\tctx.scale(size, size);\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(-0.3, 0);\r\n\tctx.arcTo(-0.3, -0.5, 0.5, 0, 0.1);\r\n\tctx.arcTo(0.5, 0, -0.3, 0.5, 0.1);\r\n\tctx.arcTo(-0.3, 0.5, -0.3, 0, 0.1);\r\n\tctx.lineTo(-0.3, 0);\r\n\tctx.fillStyle = 'green';\r\n\tctx.fill();\r\n\tctx.closePath();\r\n\r\n\tctx.restore();\r\n}\r\n\r\nexport function drawStopKey(ctx, size = 1) {\r\n\tctx.save();\r\n\tctx.scale(size, size);\r\n\tctx.fillStyle = 'red';\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(-0.35, 0);\r\n\tctx.arcTo(-0.35, -0.5, -0.15, -0.5, 0.1);\r\n\tctx.arcTo(-0.15, -0.5, -0.15, 0.5, 0.1);\r\n\tctx.arcTo(-0.15, 0.5, -0.35, 0.5, 0.1);\r\n\tctx.arcTo(-0.35, 0.5, -0.35, 0, 0.1);\r\n\tctx.lineTo(-0.35, 0);\r\n\tctx.fill();\r\n\tctx.closePath();\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(0.35, 0);\r\n\tctx.arcTo(0.35, -0.5, 0.15, -0.5, 0.1);\r\n\tctx.arcTo(0.15, -0.5, 0.15, 0.5, 0.1);\r\n\tctx.arcTo(0.15, 0.5, 0.35, 0.5, 0.1);\r\n\tctx.arcTo(0.35, 0.5, 0.35, 0, 0.1);\r\n\tctx.lineTo(0.35, 0);\r\n\tctx.fill();\r\n\tctx.closePath();\r\n\r\n\tctx.restore();\r\n}\r\n\r\nexport function drawTrashCan(ctx, size = 1) {\r\n\tctx.save();\r\n\tctx.scale(size, size);\r\n\tctx.lineWidth = 0.06;\r\n\tctx.strokeStyle = 'gray';\r\n\r\n\tfor (let i = 0; i < 3; i++) {\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(-0.2 + 0.2 * i, 0);\r\n\t\tctx.lineTo(-0.2 + 0.2 * i, 0.4);\r\n\t\tctx.stroke();\r\n\t\tctx.closePath();\r\n\t}\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(-0.4, -0.2);\r\n\tctx.arcTo(-0.4, 0.6, 0.4, 0.6, 0.1);\r\n\tctx.arcTo(0.4, 0.6, 0.4, -0.2, 0.1);\r\n\tctx.lineTo(0.4, -0.2);\r\n\tctx.stroke();\r\n\tctx.closePath();\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(-0.5, -0.4);\r\n\tctx.lineTo(0.5, -0.4);\r\n\tctx.lineTo(0.5, -0.2);\r\n\tctx.lineTo(-0.5, -0.2);\r\n\tctx.lineTo(-0.5, -0.4);\r\n\tctx.stroke();\r\n\tctx.closePath();\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(-0.2, -0.4);\r\n\tctx.lineTo(-0.2, -0.6);\r\n\tctx.lineTo(0.2, -0.6);\r\n\tctx.lineTo(0.2, -0.4);\r\n\tctx.stroke();\r\n\tctx.closePath();\r\n\r\n\tctx.restore();\r\n}","import * as api from './Drawer';\r\nimport constant from './constant';\r\nimport { useRef, useEffect } from 'react';\r\n\r\nconst Preview = (props) => {\r\n    const canvasRef = useRef();\r\n    let setting = props.setting;\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        const ctx = canvas.getContext(\"2d\");\r\n\r\n        ctx.save();\r\n        ctx.scale(0.1, 0.1);\r\n        api.drawMap(ctx, setting.map);\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        ctx.scale(0.1, 0.1);\r\n        ctx.translate(-constant.mapStart.x, -constant.mapStart.y);\r\n        for (let i = 0; i < constant.maxLayer; i++) {\r\n            for (let j = 0; j < setting.objects.length; j++) {\r\n                if (setting.objects[j].layer.status[i]) setting.objects[j].draw(ctx, i);\r\n            }\r\n        }\r\n        ctx.restore();\r\n    });\r\n\r\n    return (<canvas ref={canvasRef} width={`102.4px`} height={`51.2px`}></canvas>);\r\n}\r\n\r\nexport default Preview;","const example_0 = {\r\n    map:\r\n        [[{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'start' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'end' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'none' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }],\r\n        [{ type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' },\r\n        { type: 'block' }]],\r\n    objects: []\r\n};\r\n\r\nexport default example_0;","// from https://github.com/mui-org/material-ui/edit/master/docs/src/pages/getting-started/templates/album/Album.js\r\nimport React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { enpackage, unpackage, show } from \"../GameContainer/DataPackager\";\r\nimport LoadingPage from \"./LoadingPage\";\r\nimport instance from \"./Api\";\r\n\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport CameraIcon from \"@material-ui/icons/PhotoCamera\";\r\nimport SportsEsportsIcon from \"@material-ui/icons/SportsEsports\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardActions from \"@material-ui/core/CardActions\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport { withStyles, makeStyles } from \"@material-ui/core/styles\";\r\nimport { green, purple, pink } from \"@material-ui/core/colors\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Preview from \"../GameContainer/Preview\";\r\nimport initSetting from \"../GameContainer/Setting/example_0\";\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nconst ColorButton = withStyles((theme) => ({\r\n  root: {\r\n    color: theme.palette.getContrastText(pink[100]),\r\n    backgroundColor: pink[100],\r\n    \"&:hover\": {\r\n      backgroundColor: pink[100],\r\n    },\r\n  },\r\n}))(Button);\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {\"Copyright © \"}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        material-ui\r\n      </Link>{\" \"}\r\n      {new Date().getFullYear()}\r\n      {\".\"}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  icon: {\r\n    marginRight: theme.spacing(2),\r\n  },\r\n  heroContent: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    padding: theme.spacing(8, 0, 6),\r\n  },\r\n  heroButtons: {\r\n    marginTop: theme.spacing(4),\r\n  },\r\n  cardGrid: {\r\n    paddingTop: theme.spacing(8),\r\n    paddingBottom: theme.spacing(8),\r\n  },\r\n  card: {\r\n    height: \"100%\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n  },\r\n  cardMedia: {\r\n    paddingTop: \"56.25%\", // 16:9\r\n  },\r\n  cardContent: {\r\n    flexGrow: 1,\r\n  },\r\n  footer: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    padding: theme.spacing(6),\r\n  },\r\n}));\r\n\r\nexport default function Album(props) {\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n  const { uuid, name } = props.data;\r\n  const [mapIDs, setMapIDs] = useState(props.data.mapIDs);\r\n  // const [mapData, setMapData] = useState({});\r\n  // for Snackbar Alert\r\n  const [msgOpen, setMsgOpen] = useState(false);\r\n  const [alertMsg, setAlertMsg] = useState(\"\");\r\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\r\n  const [allMaps, setAllMaps] = useState([]);\r\n  // delete dialog\r\n  const [deleteID, setDeleteID] = useState(\"\");\r\n  const [openDialog, setOpenDialog] = useState(false);\r\n  // get data before render\r\n  const [isBusy, setBusy] = useState(true);\r\n\r\n  const DeleteSingleMap = async (id) => {\r\n    const {\r\n      data: { success, errorCode },\r\n    } = await instance.post(\"/api/deleteSingleMap\", {\r\n      id,\r\n      uuid,\r\n    });\r\n    if (!success) {\r\n      setAlertMsg(`Delete Fail`);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n    } else {\r\n      setAlertMsg(`Delete success`);\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n      getMapIDs();\r\n    }\r\n  };\r\n  const handlerDeleteSingleMap1 = () => {\r\n    DeleteSingleMap(deleteID);\r\n    setOpenDialog(false);\r\n  };\r\n  const handlerDeleteSingleMap = (id) => {\r\n    setDeleteID(id);\r\n    setOpenDialog(true);\r\n  };\r\n\r\n  const getAllMaps = async (mapIDs) => {\r\n    console.log(`getAllMaps`);\r\n    const {\r\n      data: { success, errorCode, maps },\r\n    } = await instance.post(\"/api/getAllMaps\", {\r\n      mapIDs,\r\n    });\r\n    if (!success) {\r\n      console.log(`FAIL`);\r\n    } else {\r\n      // console.log(maps);\r\n      setAllMaps(maps);\r\n    }\r\n  };\r\n\r\n  const getMapIDs = async () => {\r\n    // console.log(\"TT\");\r\n    const {\r\n      data: { success, mapIDs },\r\n    } = await instance.post(\"/api/getUserData\", {\r\n      uuid,\r\n    });\r\n    if (!success) {\r\n      console.log(`getMapids fail`);\r\n    } else {\r\n      console.log(mapIDs);\r\n      setMapIDs(mapIDs);\r\n      getAllMaps(mapIDs);\r\n    }\r\n    setBusy(false);\r\n  };\r\n\r\n  const handlerStatistic = (key) => {\r\n    if (allMaps[key] === undefined) {\r\n      return `...`;\r\n    } else {\r\n      const { fastestPass, fastestMan, passTime, playTime } =\r\n        allMaps[key].statistic;\r\n\r\n      return `fastestPass:${fastestPass}, fastestMan:${fastestMan}, passTime:${passTime}, playTime:${playTime}`;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log(`busy?${isBusy}`);\r\n    setBusy(true);\r\n    getMapIDs();\r\n  }, []);\r\n\r\n  // console.log(\"render\")\r\n  return (\r\n    <React.Fragment>\r\n      <CssBaseline />\r\n      <AppBar position=\"relative\">\r\n        <Toolbar>\r\n          <SportsEsportsIcon className={classes.icon} />\r\n          <Typography variant=\"h6\" color=\"inherit\" noWrap>\r\n            Play Ground\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <main>\r\n        <Snackbar\r\n          open={msgOpen}\r\n          autoHideDuration={3000}\r\n          onClose={() => {\r\n            setMsgOpen(false);\r\n          }}\r\n        >\r\n          <Alert\r\n            onClose={() => {\r\n              setMsgOpen(false);\r\n            }}\r\n            severity={alertType}\r\n          >\r\n            {alertMsg}\r\n          </Alert>\r\n        </Snackbar>\r\n        <div className={classes.heroContent}>\r\n          <Container maxWidth=\"sm\">\r\n            <Typography\r\n              component=\"h1\"\r\n              variant=\"h2\"\r\n              align=\"center\"\r\n              color=\"textPrimary\"\r\n              gutterBottom\r\n            >\r\n              Hi {name}\r\n            </Typography>\r\n            <Typography\r\n              variant=\"h5\"\r\n              align=\"center\"\r\n              color=\"textSecondary\"\r\n              paragraph\r\n            >\r\n              你可以在這邊設計、查看你所擁有的關卡！！\r\n            </Typography>\r\n            <div className={classes.heroButtons}>\r\n              <Grid container spacing={2} justify=\"center\">\r\n                <Grid item>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    onClick={() => {\r\n                      history.push(`/`);\r\n                    }}\r\n                  >\r\n                    登出\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={() => {\r\n                      history.push({\r\n                        pathname: `/PopularMap`,\r\n                        state: { uuid: uuid, name: name, login: true },\r\n                      });\r\n                    }}\r\n                  >\r\n                    查看熱門排行地圖\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    color=\"secondary\"\r\n                    variant=\"outlined\"\r\n                    onClick={() => {\r\n                      history.push({\r\n                        pathname: `/EditMode`,\r\n                        state: {\r\n                          uuid: uuid,\r\n                          name: name,\r\n                          login: true,\r\n                          id: 0,\r\n                          title: \"\",\r\n                          description: \"\",\r\n                        },\r\n                      });\r\n                    }}\r\n                  >\r\n                    新地圖\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    color=\"primary\"\r\n                    variant=\"outlined\"\r\n                    onClick={getMapIDs}\r\n                  >\r\n                    重新整理\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </div>\r\n          </Container>\r\n        </div>\r\n        <Dialog\r\n          open={openDialog}\r\n          onClose={() => {\r\n            setOpenDialog(false);\r\n          }}\r\n          aria-labelledby=\"alert-dialog-title\"\r\n          aria-describedby=\"alert-dialog-description\"\r\n        >\r\n          <DialogContent>\r\n            <DialogContentText id=\"alert-dialog-description\">\r\n              刪除地圖？（無法復原）\r\n            </DialogContentText>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button\r\n              onClick={() => {\r\n                setOpenDialog(false);\r\n              }}\r\n              color=\"primary\"\r\n            >\r\n              取消\r\n            </Button>\r\n            <Button onClick={handlerDeleteSingleMap1} color=\"primary\" autoFocus>\r\n              確認\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        {isBusy ? (\r\n          <LoadingPage />\r\n        ) : (\r\n          <Container className={classes.cardGrid} maxWidth=\"md\">\r\n            {/* End hero unit */}\r\n            <Grid container spacing={4}>\r\n              {mapIDs.map((ele, key) => (\r\n                <Grid item key={ele} xs={12} sm={6} md={4}>\r\n                  <Card className={classes.card}>\r\n                    {/* <CardMedia\r\n                      className={classes.cardMedia}\r\n                      image=\"https://source.unsplash.com/random\"\r\n                      title=\"Image title\"\r\n                    /> */}\r\n                    <Preview\r\n                      setting={unpackage(\r\n                        allMaps[key] ? allMaps[key].content : initSetting\r\n                      )}\r\n                    />\r\n                    <CardContent className={classes.cardContent}>\r\n                      <Typography gutterBottom variant=\"h5\" component=\"h2\">\r\n                        {/* {ele.title} */}\r\n                        {allMaps[key] ? allMaps[key].title : \"\"}\r\n                      </Typography>\r\n                      <Typography>\r\n                        {allMaps[key] ? allMaps[key].description : \"\"}\r\n                      </Typography>\r\n                    </CardContent>\r\n                    <CardActions>\r\n                      <Button\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        disabled={allMaps[key] === undefined}\r\n                        onClick={() => {\r\n                          history.push({\r\n                            pathname: `/PlayMode`,\r\n                            state: {\r\n                              uuid: uuid,\r\n                              name: name,\r\n                              login: true,\r\n                              id: ele,\r\n                              mode: \"test\",\r\n                            },\r\n                          });\r\n                        }}\r\n                      >\r\n                        Play\r\n                      </Button>\r\n                      <Button\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        disabled={\r\n                          allMaps[key] === undefined ||\r\n                          (allMaps[key] !== undefined && allMaps[key].publish)\r\n                        }\r\n                        onClick={() => {\r\n                          history.push({\r\n                            pathname: `/EditMode`,\r\n                            state: {\r\n                              uuid: uuid,\r\n                              name: name,\r\n                              login: true,\r\n                              id: ele,\r\n                              title: allMaps[key] ? allMaps[key].title : \"\",\r\n                              description: allMaps[key]\r\n                                ? allMaps[key].description\r\n                                : \"\",\r\n                            },\r\n                          });\r\n                        }}\r\n                      >\r\n                        Edit\r\n                      </Button>\r\n                      {allMaps[key] === undefined ? (\r\n                        <p>???</p>\r\n                      ) : allMaps[key].publish ? (\r\n                        <Tooltip title={handlerStatistic(key)}>\r\n                          <Button size=\"small\" color=\"primary\" variant=\"text\">\r\n                            Statistic\r\n                          </Button>\r\n                        </Tooltip>\r\n                      ) : (\r\n                        <>\r\n                          <ColorButton\r\n                            size=\"small\"\r\n                            color=\"primary\"\r\n                            variant=\"contained\"\r\n                          >\r\n                            Private\r\n                          </ColorButton>\r\n                        </>\r\n                      )}\r\n                      <IconButton\r\n                        className={classes.margin}\r\n                        size=\"large\"\r\n                        variant=\"outlined\"\r\n                        color=\"secondary\"\r\n                        onClick={() => {\r\n                          handlerDeleteSingleMap(ele);\r\n                        }}\r\n                      >\r\n                        <DeleteIcon />\r\n                      </IconButton>\r\n                    </CardActions>\r\n                  </Card>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Container>\r\n        )}\r\n      </main>\r\n      {/* Footer */}\r\n      <footer className={classes.footer}>\r\n        {/* <Typography variant=\"h6\" align=\"center\" gutterBottom>\r\n          Footer\r\n        </Typography>\r\n        <Typography\r\n          variant=\"subtitle1\"\r\n          align=\"center\"\r\n          color=\"textSecondary\"\r\n          component=\"p\"\r\n        >\r\n          Something here to give the footer a purpose!\r\n        </Typography> */}\r\n        {/* <Copyright /> */}\r\n      </footer>\r\n      {/* End footer */}\r\n    </React.Fragment>\r\n  );\r\n}\r\n","export default function ErrorPage(props) {\r\n  return (\r\n    <>\r\n      <h1> ERROR QAQ </h1>\r\n    </>\r\n  );\r\n}\r\n","import UserPage from \"./UserPage\";\r\nimport ErrorPage from \"./ErrorPage\";\r\n\r\nfunction checkLogin(props) {\r\n  if (props.location.state === undefined) return false;\r\n  else if (!props.location.state.login) return false;\r\n  return true;\r\n}\r\n\r\nfunction UserPage0(props) {\r\n  return (\r\n    <>\r\n      {checkLogin(props) ? (\r\n        <UserPage data={props.location.state} />\r\n      ) : (\r\n        <ErrorPage />\r\n      )}\r\n    </>\r\n  );\r\n}\r\nexport default UserPage0;\r\n","import React from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useState, useEffect } from \"react\";\r\nimport instance from \"../Api\";\r\n\r\nimport Link from \"@material-ui/core/Link\";\r\nimport { makeStyles, withStyles } from \"@material-ui/core/styles\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n// import ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\r\nimport SportsEsportsIcon from \"@material-ui/icons/SportsEsports\";\r\nimport GradeIcon from \"@material-ui/icons/Grade\";\r\nimport Modal from \"@material-ui/core/Modal\";\r\n// import Title from \"./Title\";\r\nimport Rating from \"@material-ui/lab/Rating\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nconst ColorButton = withStyles((theme) => ({\r\n  root: {\r\n    color: \"#ffc107\",\r\n    // backgroundColor: theme.palette.getContrastText(\"#ffc107\"),\r\n    \"&:hover\": {\r\n      backgroundColor: \"#fff7b0\",\r\n    },\r\n  },\r\n}))(IconButton);\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  seeMore: {\r\n    marginTop: theme.spacing(3),\r\n  },\r\n}));\r\n// const instance = axios.create({\r\n//   baseURL: `http://localhost:4000/`,\r\n// });\r\nexport default function Orders(props) {\r\n  const history = useHistory();\r\n  const classes = useStyles();\r\n  const { name, uuid, login } = props.info;\r\n  const [open, setOpen] = useState(false);\r\n  // record rate which map\r\n  const [rateID, setRateID] = useState(\"\");\r\n  const [rate, setRate] = useState(3);\r\n  // for Snackbar Alert\r\n  const [msgOpen, setMsgOpen] = useState(false);\r\n  const [alertMsg, setAlertMsg] = useState(\"\");\r\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\r\n\r\n  const rateMap = async (val) => {\r\n    console.log(`value:${val}`);\r\n    const {\r\n      data: { success, errorCode },\r\n    } = await instance.post(\"/api/rateMap\", {\r\n      rateID,\r\n      val,\r\n      name,\r\n    });\r\n    if (!success) {\r\n      if (errorCode === 1) {\r\n        setAlertMsg(`You need to pass this map to rate it`);\r\n        setAlertType(\"error\");\r\n        setMsgOpen(true);\r\n      } else if (errorCode === 2) {\r\n        setAlertMsg(`You rated it before, the previous rate has been updated!`);\r\n        setAlertType(\"info\");\r\n        setMsgOpen(true);\r\n      } else {\r\n        setAlertMsg(`Unknow error: ${errorCode}`);\r\n        setAlertType(\"error\");\r\n        setMsgOpen(true);\r\n      }\r\n    } else {\r\n      setAlertMsg(`Rate Success`);\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n    }\r\n  };\r\n  // console.log(props.data);\r\n  const computeScore = (arr) => {\r\n    let totalScore = 0;\r\n    let totalPeople = 0;\r\n    arr.forEach((ele) => {\r\n      totalScore += ele.rate;\r\n      // console.log(ele);\r\n      totalPeople += 1;\r\n    });\r\n    return [\r\n      totalScore,\r\n      totalPeople,\r\n      totalPeople === 0 ? 0 : totalScore / totalPeople,\r\n    ];\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Snackbar\r\n        open={msgOpen}\r\n        autoHideDuration={3000}\r\n        onClose={() => {\r\n          setMsgOpen(false);\r\n        }}\r\n      >\r\n        <Alert\r\n          onClose={() => {\r\n            setMsgOpen(false);\r\n          }}\r\n          severity={alertType}\r\n        >\r\n          {alertMsg}\r\n        </Alert>\r\n      </Snackbar>\r\n      <Modal\r\n        open={open}\r\n        onClose={() => {\r\n          setOpen(false);\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            backgroundColor: \"white\",\r\n            position: \"absolute\",\r\n            margin: \"0\",\r\n            top: \"50%\",\r\n            left: \"30%\",\r\n            width: \"40%\",\r\n            height: \"50%\",\r\n            // display: \"flex\",\r\n            transform: \"translateY(-50%)\",\r\n            // opacity: \"0.8\",\r\n            // msTransform: \"translateX(-50%)\",\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              marginTop: \"1cm\",\r\n              top: \"30%\",\r\n              left: \"50%\",\r\n              position: \"absolute\",\r\n              transform: \"translate(-50%,-50%)\",\r\n              msTransform: \"translate(-50%,-50%)\",\r\n            }}\r\n          >\r\n            <Typography component=\"legend\">Rate</Typography>\r\n            <Rating\r\n              name=\"simple-controlled\"\r\n              value={rate}\r\n              onChange={(event, newValue) => {\r\n                rateMap(newValue);\r\n                setOpen(false);\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n      {/* <Title>Recent Orders</Title> */}\r\n      <Table size=\"small\">\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell></TableCell>\r\n            <TableCell>Author</TableCell>\r\n            <TableCell>Title</TableCell>\r\n            <TableCell>Description</TableCell>\r\n            <TableCell>Number of Plays</TableCell>\r\n            <TableCell>Number of Passes</TableCell>\r\n            <TableCell>Fastest</TableCell>\r\n            <TableCell align=\"right\">Record holder</TableCell>\r\n            <TableCell></TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {props.data.map((map) => (\r\n            <TableRow>\r\n              <IconButton\r\n                className={classes.margin}\r\n                size=\"large\"\r\n                variant=\"outlined\"\r\n                color=\"secondary\"\r\n                onClick={() => {\r\n                  history.push({\r\n                    pathname: `/PlayMode`,\r\n                    state: {\r\n                      uuid: uuid,\r\n                      name: name,\r\n                      login: true,\r\n                      id: map.id,\r\n                      mode: \"challenge\",\r\n                    },\r\n                  });\r\n                }}\r\n              >\r\n                <SportsEsportsIcon />\r\n              </IconButton>\r\n              <TableCell>{map.author}</TableCell>\r\n              <TableCell>{map.title}</TableCell>\r\n              <TableCell>{map.description}</TableCell>\r\n              <TableCell>{map.statistic.playTime}</TableCell>\r\n              <TableCell>{map.statistic.passTime}</TableCell>\r\n              <TableCell>\r\n                {map.statistic.fastestPass === 999.9\r\n                  ? \"-\"\r\n                  : map.statistic.fastestPass}\r\n              </TableCell>\r\n              <TableCell align=\"right\">\r\n                {map.statistic.fastestMan === \"None\"\r\n                  ? \"-\"\r\n                  : map.statistic.fastestMan}\r\n              </TableCell>\r\n\r\n              {`${computeScore(map.rateRec)[2].toFixed(2)}(${\r\n                computeScore(map.rateRec)[1]\r\n              })`}\r\n              <ColorButton\r\n                className={classes.margin}\r\n                size=\"large\"\r\n                variant=\"outlined\"\r\n                color=\"primary\"\r\n                onClick={() => {\r\n                  setRateID(map.id);\r\n                  setOpen(true);\r\n                }}\r\n              >\r\n                <GradeIcon />\r\n              </ColorButton>\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n      {/* <div className={classes.seeMore}>\r\n        <Link color=\"primary\" href=\"#\" onClick={preventDefault}>\r\n          See more orders\r\n        </Link>\r\n      </div> */}\r\n    </React.Fragment>\r\n  );\r\n}\r\n","import ErrorPage from \"./ErrorPage\";\r\nimport {url} from \"./url\";\r\n\r\nimport React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport clsx from \"clsx\";\r\nimport instance from \"./Api\";\r\n\r\nimport { withStyles, makeStyles } from \"@material-ui/core/styles\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport List from \"@material-ui/core/List\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport DashboardIcon from \"@material-ui/icons/Dashboard\";\r\nimport WhatshotIcon from \"@material-ui/icons/Whatshot\";\r\nimport InsertEmoticonIcon from \"@material-ui/icons/InsertEmoticon\";\r\nimport FiberNewIcon from \"@material-ui/icons/FiberNew\";\r\nimport AccessibleForwardIcon from \"@material-ui/icons/AccessibleForward\";\r\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport GradeIcon from \"@material-ui/icons/Grade\";\r\n\r\nimport Orders from \"./PageComponent/Orders\";\r\n\r\nconst CssTextField = withStyles({\r\n  root: {\r\n    \"& label.Mui-focused\": {\r\n      color: \"black\",\r\n    },\r\n    \"& .MuiInput-underline:after\": {\r\n      borderBottomColor: \"green\",\r\n    },\r\n    \"& .MuiOutlinedInput-root\": {\r\n      \"& fieldset\": {\r\n        borderColor: \"red\",\r\n        backgroundColor: \"RoyalBlue\",\r\n      },\r\n      \"&:hover fieldset\": {\r\n        borderColor: \"yellow\",\r\n      },\r\n      \"&.Mui-focused fieldset\": {\r\n        borderColor: \"green\",\r\n        backgroundColor: \"white\",\r\n        opacity: \"0.1\",\r\n      },\r\n    },\r\n  },\r\n})(TextField);\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {\"Copyright © \"}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        Your Website\r\n      </Link>{\" \"}\r\n      {new Date().getFullYear()}\r\n      {\".\"}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: \"flex\",\r\n  },\r\n  toolbar: {\r\n    paddingRight: 24, // keep right padding when drawer closed\r\n  },\r\n  toolbarIcon: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"flex-end\",\r\n    padding: \"0 8px\",\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create([\"width\", \"margin\"], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create([\"width\", \"margin\"], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  menuButtonHidden: {\r\n    display: \"none\",\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n  drawerPaper: {\r\n    position: \"relative\",\r\n    whiteSpace: \"nowrap\",\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create(\"width\", {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerPaperClose: {\r\n    overflowX: \"hidden\",\r\n    transition: theme.transitions.create(\"width\", {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    width: theme.spacing(7),\r\n    [theme.breakpoints.up(\"sm\")]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  appBarSpacer: theme.mixins.toolbar,\r\n  content: {\r\n    flexGrow: 1,\r\n    height: \"100vh\",\r\n    overflow: \"auto\",\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(4),\r\n    paddingBottom: theme.spacing(4),\r\n  },\r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    display: \"flex\",\r\n    overflow: \"auto\",\r\n    flexDirection: \"column\",\r\n  },\r\n  fixedHeight: {\r\n    height: 240,\r\n  },\r\n}));\r\n\r\nfunction PopularMap(props) {\r\n  const history = useHistory();\r\n  const classes = useStyles();\r\n  const { name, uuid, login } = props.data;\r\n  const [open, setOpen] = useState(true);\r\n  const [newestMaps, setNewestMaps] = useState([]);\r\n  const [allMaps, setAllMaps] = useState([]);\r\n  const [isBusy, setBusy] = useState(true);\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setBusy(true);\r\n    const getAllMapsByOrder = async () => {\r\n      const {\r\n        data: { success, maps, errorCode },\r\n      } = await instance.post(\"/api/getAllMapsByOrder\", {});\r\n      if (!success) {\r\n        // alert(`Wrong password or the user doesn't exist.`);\r\n      } else {\r\n        console.log(`setAllMaps`);\r\n        setAllMaps(maps);\r\n        setNewestMaps(maps);\r\n      }\r\n      setBusy(false);\r\n    };\r\n    getAllMapsByOrder();\r\n  }, []);\r\n\r\n  // ref:https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\r\n  function shuffle(array) {\r\n    var currentIndex = array.length,\r\n      randomIndex;\r\n\r\n    // While there remain elements to shuffle...\r\n    while (0 !== currentIndex) {\r\n      // Pick a remaining element...\r\n      randomIndex = Math.floor(Math.random() * currentIndex);\r\n      currentIndex--;\r\n\r\n      // And swap it with the current element.\r\n      [array[currentIndex], array[randomIndex]] = [\r\n        array[randomIndex],\r\n        array[currentIndex],\r\n      ];\r\n    }\r\n\r\n    return array;\r\n  }\r\n  const handler1 = () => {\r\n    console.log(`Handler1`);\r\n    // random the order of allMaps\r\n    let arr = [...newestMaps];\r\n    shuffle(arr);\r\n    setAllMaps(arr);\r\n  };\r\n  const handler2 = () => {\r\n    console.log(`Handler2`);\r\n    let arr = [...newestMaps];\r\n    arr.sort((a, b) => {\r\n      return b.statistic.playTime - a.statistic.playTime;\r\n    });\r\n    setAllMaps(arr);\r\n  };\r\n  const handler3 = () => {\r\n    console.log(`Handler3`);\r\n    let arr = [...newestMaps];\r\n    arr.sort((a, b) => {\r\n      return b.statistic.passTime - a.statistic.passTime;\r\n    });\r\n    setAllMaps(arr);\r\n  };\r\n  const handler4 = () => {\r\n    console.log(`Handler4`);\r\n    setAllMaps(newestMaps);\r\n  };\r\n  const handler5 = () => {\r\n    console.log(`Handler5`);\r\n    let arr = [...newestMaps];\r\n    arr = arr.reverse();\r\n    setAllMaps(arr);\r\n  };\r\n  const computeScore = (arr) => {\r\n    let totalScore = 0;\r\n    let totalPeople = 0;\r\n    arr.forEach((ele) => {\r\n      totalScore += ele.rate;\r\n      totalPeople += 1;\r\n    });\r\n    return [\r\n      totalScore,\r\n      totalPeople,\r\n      totalPeople === 0 ? 0 : totalScore / totalPeople,\r\n    ];\r\n  };\r\n  const handlerGrade = () => {\r\n    console.log(`Handler3`);\r\n    let arr = [...newestMaps];\r\n    arr.sort((a, b) => {\r\n      return (\r\n        computeScore(b.rateRec)[2].toFixed(2) -\r\n        computeScore(a.rateRec)[2].toFixed(2)\r\n      );\r\n    });\r\n    setAllMaps(arr);\r\n  };\r\n  const handlerSearch = (w) => {\r\n    console.log(`HandlerSearch`);\r\n    let arr = [...newestMaps];\r\n    arr = arr.filter((ele) => {\r\n      return ele.author.toLowerCase().includes(w.toLowerCase());\r\n    });\r\n    setAllMaps(arr);\r\n  };\r\n\r\n  // const fixedHeightPaper = clsx(classes.paper, classes.fixedHeight);\r\n  // console.log(\"Render\");\r\n  return (\r\n    <div className={classes.root}>\r\n      <CssBaseline />\r\n      <AppBar\r\n        position=\"absolute\"\r\n        className={clsx(classes.appBar, open && classes.appBarShift)}\r\n      >\r\n        <Toolbar className={classes.toolbar}>\r\n          <IconButton\r\n            edge=\"start\"\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={() => {\r\n              setOpen(true);\r\n            }}\r\n            className={clsx(\r\n              classes.menuButton,\r\n              open && classes.menuButtonHidden\r\n            )}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography\r\n            component=\"h1\"\r\n            variant=\"h6\"\r\n            color=\"inherit\"\r\n            noWrap\r\n            className={classes.title}\r\n          >\r\n            Other Maps\r\n          </Typography>\r\n          <CssTextField\r\n            className={classes.margin}\r\n            label=\"Search Author\"\r\n            variant=\"outlined\"\r\n            id=\"custom-css-outlined-input\"\r\n            value={search}\r\n            onChange={(e) => {\r\n              setSearch(e.target.value.trim());\r\n              handlerSearch(e.target.value.trim());\r\n            }}\r\n          />\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        classes={{\r\n          paper: clsx(classes.drawerPaper, !open && classes.drawerPaperClose),\r\n        }}\r\n        open={open}\r\n      >\r\n        <div className={classes.toolbarIcon}>\r\n          <IconButton\r\n            onClick={() => {\r\n              setOpen(false);\r\n            }}\r\n          >\r\n            <ChevronLeftIcon />\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List>\r\n          <div>\r\n            <ListItem button onClick={handler1}>\r\n              <ListItemIcon>\r\n                <DashboardIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"All Maps\" />\r\n            </ListItem>\r\n            <ListItem button onClick={handlerGrade}>\r\n              <ListItemIcon>\r\n                <GradeIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"High Rate Maps\" />\r\n            </ListItem>\r\n            <ListItem button onClick={handler2}>\r\n              <ListItemIcon>\r\n                <WhatshotIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Most Plays\" />\r\n            </ListItem>\r\n            <ListItem button onClick={handler3}>\r\n              <ListItemIcon>\r\n                <InsertEmoticonIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Most Passes\" />\r\n            </ListItem>\r\n            <ListItem button onClick={handler4}>\r\n              <ListItemIcon>\r\n                <FiberNewIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Newest\" />\r\n            </ListItem>\r\n            <ListItem button onClick={handler5}>\r\n              <ListItemIcon>\r\n                <AccessibleForwardIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Oldest\" />\r\n            </ListItem>\r\n            <ListItem button onClick={history.goBack}>\r\n              <ListItemIcon>\r\n                <ArrowBackRoundedIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Go Back\" />\r\n            </ListItem>\r\n          </div>\r\n        </List>\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.appBarSpacer} />\r\n        <Container maxWidth=\"lg\" className={classes.container}>\r\n          <Grid container spacing={3}>\r\n            {/* Recent Orders */}\r\n            <Grid item xs={12}>\r\n              <Paper className={classes.paper}>\r\n                <Orders data={allMaps} info={props.data} />\r\n              </Paper>\r\n            </Grid>\r\n          </Grid>\r\n          <Box pt={4}>{/* <Copyright /> */}</Box>\r\n        </Container>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\nfunction checkLogin(props) {\r\n  if (props.location.state === undefined) return false;\r\n  else if (!props.location.state.login) return false;\r\n  return true;\r\n}\r\n\r\nfunction index(props) {\r\n  return (\r\n    <>\r\n      {checkLogin(props) ? (\r\n        <PopularMap data={props.location.state} />\r\n      ) : (\r\n        <ErrorPage />\r\n      )}\r\n    </>\r\n  );\r\n}\r\nexport default index;\r\n","import * as api from '../Drawer';\r\nimport Vec2 from '../Class/Vec2';\r\nimport constant from '../constant';\r\nimport * as GameObject from '../Class/GameObject';\r\n\r\nfunction Drawer(ctx, setting, status) {\r\n\tlet map = setting.map;\r\n\tlet objects = setting.objects;\r\n\tconst w = constant.gridWidth;\r\n\r\n\r\n\t/* 清空畫布 */\r\n\tapi.clear(ctx);\r\n\r\n\tctx.save();\r\n\tctx.rect(constant.mapStart.x, constant.mapStart.y, constant.mapSize.x * w, constant.mapSize.y * w);\r\n\tctx.clip();\r\n\r\n\t/* 繪製地圖 */\r\n\tctx.save();\r\n\tctx.translate(constant.mapStart.x, constant.mapStart.y);\r\n\tapi.drawMap(ctx, map);\r\n\r\n\t/* 繪製選擇格 */\r\n\tif (status.select) {\r\n\t\tlet luPos = Vec2.leftUp(status.selectPair[0], status.selectPair[1]);\r\n\t\tlet rdPos = Vec2.rightDown(status.selectPair[0], status.selectPair[1]);\r\n\t\tlet range = rdPos.sub(luPos).add(new Vec2(1, 1));\r\n\r\n\t\tctx.save();\r\n\t\tctx.beginPath();\r\n\t\tctx.rect(luPos.x * w, luPos.y * w, range.x * w, range.y * w);\r\n\t\tctx.setLineDash([0.5, 0, 5]);\r\n\t\tctx.strokeStyle = 'black';\r\n\t\tctx.stroke();\r\n\t\tctx.closePath();\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\tctx.restore();\r\n\r\n\t/* 繪製物件 */\r\n\tfor (let i = 0; i < constant.maxLayer; i++) {\r\n\t\tfor (let j = 0; j < objects.length; j++) {\r\n\t\t\tif (objects[j].layer.status[i]) objects[j].draw(ctx, i);\r\n\t\t}\r\n\t}\r\n\r\n\tctx.restore();\r\n\r\n\t/* 繪製編輯物件庫 */\r\n\tctx.save();\r\n\tconst editObjectSpace = new Vec2(64, 64);\r\n\tconst objectList = [];\r\n\tobjectList.push('class platform');\r\n\tif (status.opt === 1) objectList.push(...constant.editObjectList.platform);\r\n\tobjectList.push('class covering');\r\n\tif (status.opt === 2) objectList.push(...constant.editObjectList.covering);\r\n\tobjectList.push('class obstacle');\r\n\tif (status.opt === 3) objectList.push(...constant.editObjectList.obstacle);\r\n\tobjectList.push('class special');\r\n\tif (status.opt === 4) objectList.push(...constant.editObjectList.special);\r\n\tctx.translate(88, 516);\r\n\r\n\tfor (let i = 0; i < 16; i++) {\r\n\t\tlet o = null, type = 'default', fColor, sColor;\r\n\t\tif (objectList[i - 1]) {\r\n\t\t\tswitch (objectList[i - 1]) {\r\n\t\t\t\tcase 'class platform':\r\n\t\t\t\t\ttype = 'class';\r\n\t\t\t\t\tif (status.opt === 1) {\r\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\r\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\r\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['platform'].fColor);\r\n\t\t\t\t\t\tgrd.addColorStop(1, '#B9B9FF');\r\n\t\t\t\t\t\tfColor = grd;\r\n\t\t\t\t\t} else fColor = '#B9B9FF';\r\n\t\t\t\t\tsColor = '#9393FF';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'class covering':\r\n\t\t\t\t\ttype = 'class';\r\n\t\t\t\t\tif (status.opt === 2) {\r\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\r\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\r\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['covering'].fColor);\r\n\t\t\t\t\t\tgrd.addColorStop(1, '#96FED1');\r\n\t\t\t\t\t\tfColor = grd;\r\n\t\t\t\t\t} else fColor = '#96FED1';\r\n\t\t\t\t\tsColor = '#1AFD9C';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'class obstacle':\r\n\t\t\t\t\ttype = 'class';\r\n\t\t\t\t\tif (status.opt === 3) {\r\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\r\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\r\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['obstacle'].fColor);\r\n\t\t\t\t\t\tgrd.addColorStop(1, '#FF9797');\r\n\t\t\t\t\t\tfColor = grd;\r\n\t\t\t\t\t} else fColor = '#FF9797';\r\n\t\t\t\t\tsColor = '#FF5151';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'class special':\r\n\t\t\t\t\ttype = 'class';\r\n\t\t\t\t\tif (status.opt === 4) {\r\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\r\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\r\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['special'].fColor);\r\n\t\t\t\t\t\tgrd.addColorStop(1, '#FFE66F');\r\n\t\t\t\t\t\tfColor = grd;\r\n\t\t\t\t\t} else fColor = '#FFE66F';\r\n\t\t\t\t\tsColor = '#FFDC35';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'spikedBlock':\r\n\t\t\t\t\to = new GameObject.spikedBlock(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'obstacle';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'platform':\r\n\t\t\t\t\to = new GameObject.platform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'platform';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'bow':\r\n\t\t\t\t\to = new GameObject.bow(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 3));\r\n\t\t\t\t\ttype = 'obstacle';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'movingPlatform':\r\n\t\t\t\t\to = new GameObject.movingPlatform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 10));\r\n\t\t\t\t\ttype = 'platform';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'mucus':\r\n\t\t\t\t\to = new GameObject.mucus(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'covering';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'cymbal':\r\n\t\t\t\t\to = new GameObject.cymbal(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'obstacle';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ice':\r\n\t\t\t\t\to = new GameObject.ice(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'covering';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'conveyor':\r\n\t\t\t\t\to = new GameObject.conveyor(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'covering';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'portal':\r\n\t\t\t\t\to = new GameObject.portal(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'special';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'trapPlatform':\r\n\t\t\t\t\to = new GameObject.trapPlatform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'platform';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'missileBase':\r\n\t\t\t\t\to = new GameObject.missileBase(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'obstacle';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'lockedWall':\r\n\t\t\t\t\to = new GameObject.lockedWall(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'special';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'unlocker':\r\n\t\t\t\t\to = new GameObject.unlocker(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'special';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'block':\r\n\t\t\t\t\to = new GameObject.block(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'obstacle';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'movingPlatform_oblique':\r\n\t\t\t\t\to = new GameObject.movingPlatform_oblique(new Vec2(editObjectSpace.x * (i + 0.5) - 10, editObjectSpace.y * 0.5 + 10));\r\n\t\t\t\t\ttype = 'platform';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'movingPlatform_rect':\r\n\t\t\t\t\to = new GameObject.movingPlatform_rect(new Vec2(editObjectSpace.x * (i + 0.5) - 10, editObjectSpace.y * 0.5 + 10));\r\n\t\t\t\t\ttype = 'platform';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'woodenBox':\r\n\t\t\t\t\to = new GameObject.woodenBox(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'obstacle';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'magnet':\r\n\t\t\t\t\to = new GameObject.magnet(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'special';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'brokenPlatform':\r\n\t\t\t\t\to = new GameObject.brokenPlatform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'platform';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'deathTotem':\r\n\t\t\t\t\to = new GameObject.deathTotem(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\r\n\t\t\t\t\ttype = 'covering';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tctx.beginPath();\r\n\t\tctx.rect(0 + editObjectSpace.x * i + 3, 3, editObjectSpace.x - 6, editObjectSpace.y - 6);\r\n\t\tctx.fillStyle = (type === 'class') ? fColor : constant.editFrame[type].fColor;\r\n\t\tctx.fill();\r\n\t\tctx.lineWidth = 2;\r\n\t\tctx.strokeStyle = (type === 'class') ? sColor : constant.editFrame[type].sColor;\r\n\t\tctx.stroke();\r\n\t\tctx.lineWidth = 1;\r\n\t\tctx.closePath();\r\n\r\n\t\tif (i === 0) {\r\n\t\t\tctx.save();\r\n\t\t\tctx.translate(editObjectSpace.x * 0.5, editObjectSpace.y * 0.5);\r\n\t\t\tif (status.active) api.drawStopKey(ctx, w);\r\n\t\t\telse api.drawPlayKey(ctx, w);\r\n\t\t\tctx.restore();\r\n\t\t} else if (i === 15) {\r\n\t\t\tctx.save();\r\n\t\t\tctx.translate(editObjectSpace.x * 15.5, editObjectSpace.y * 0.5);\r\n\t\t\tapi.drawTrashCan(ctx, w);\r\n\t\t\tctx.restore();\r\n        }\r\n\t\tif (o) o.draw(ctx);\r\n\t\tif (objectList[i - 1] === 'class platform') {\r\n\t\t\tlet o1 = new GameObject.trapPlatform(new Vec2(editObjectSpace.x * (i + 0.5) - 8, editObjectSpace.y * 0.5 - 8));\r\n\t\t\to1.draw(ctx);\r\n\t\t\tlet o2 = new GameObject.platform(new Vec2(editObjectSpace.x * (i + 0.5) + 8, editObjectSpace.y * 0.5 - 0));\r\n\t\t\to2.draw(ctx);\r\n\t\t\tctx.textAlign = \"center\";\r\n\t\t\tctx.textBaseline = 'middle';\r\n\t\t\tctx.font = \"15px italic\";\r\n\t\t\tctx.strokeStyle = 'white';\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.strokeText(\"平台類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t\tctx.fillStyle = 'black';\r\n\t\t\tctx.fillText(\"平台類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t} else if (objectList[i - 1] === 'class covering') {\r\n\t\t\tlet o1 = new GameObject.mucus(new Vec2(editObjectSpace.x * (i + 0.5) - 10, editObjectSpace.y * 0.5 - 10));\r\n\t\t\to1.draw(ctx);\r\n\t\t\tlet o2 = new GameObject.conveyor(new Vec2(editObjectSpace.x * (i + 0.5) + 10, editObjectSpace.y * 0.5 - 5));\r\n\t\t\to2.draw(ctx);\r\n\t\t\tlet o3 = new GameObject.ice(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 3));\r\n\t\t\to3.draw(ctx);\r\n\t\t\tctx.textAlign = \"center\";\r\n\t\t\tctx.textBaseline = 'middle';\r\n\t\t\tctx.font = \"15px italic\";\r\n\t\t\tctx.strokeStyle = 'white';\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.strokeText(\"覆蓋類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t\tctx.fillStyle = 'black';\r\n\t\t\tctx.fillText(\"覆蓋類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t} else if (objectList[i - 1] === 'class obstacle') {\r\n\t\t\tlet o1 = new GameObject.spikedBlock(new Vec2(editObjectSpace.x * (i + 0.5) - 3, editObjectSpace.y * 0.5 - 6));\r\n\t\t\tctx.save();\r\n\t\t\tctx.translate(o1.pos.x, o1.pos.y);\r\n\t\t\tctx.scale(0.7, 0.7);\r\n\t\t\tctx.translate(-o1.pos.x, -o1.pos.y);\r\n\t\t\to1.draw(ctx);\r\n\t\t\tctx.restore();\r\n\t\t\tlet o2 = new GameObject.bow(new Vec2(editObjectSpace.x * (i + 0.5) - 3, editObjectSpace.y * 0.5 + 12));\r\n\t\t\tctx.save();\r\n\t\t\tctx.translate(o1.pos.x, o1.pos.y);\r\n\t\t\tctx.rotate(- 0.36 * Math.PI);\r\n\t\t\tctx.translate(-o1.pos.x, -o1.pos.y);\r\n\t\t\to2.draw(ctx);\r\n\t\t\tctx.restore();\r\n\t\t\tctx.textAlign = \"center\";\r\n\t\t\tctx.textBaseline = 'middle';\r\n\t\t\tctx.font = \"15px italic\";\r\n\t\t\tctx.strokeStyle = 'white';\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.strokeText(\"障礙類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t\tctx.fillStyle = 'black';\r\n\t\t\tctx.fillText(\"障礙類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t} else if (objectList[i - 1] === 'class special') {\r\n\t\t\tlet o1 = new GameObject.portal(new Vec2(editObjectSpace.x * (i + 0.5) - 2, editObjectSpace.y * 0.5 - 7));\r\n\t\t\to1.index = 1;\r\n\t\t\to1.open = true;\r\n\t\t\to1.draw(ctx);\r\n\t\t\tlet o2 = new GameObject.unlocker(new Vec2(editObjectSpace.x * (i + 0.5) + 10, editObjectSpace.y * 0.5));\r\n\t\t\to2.draw(ctx);\r\n\t\t\tctx.textAlign = \"center\";\r\n\t\t\tctx.textBaseline = 'middle';\r\n\t\t\tctx.font = '15px  sans-serif';\r\n\t\t\tctx.strokeStyle = 'white';\r\n\t\t\tctx.strokeText(\"特殊類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t\tctx.fillStyle = 'black';\r\n\t\t\tctx.fillText(\"特殊類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\r\n\t\t}\r\n    }\r\n\tctx.restore();\r\n\r\n\t/* 繪製手中的物件 */\r\n\tif (status.clear) {\r\n\t\tctx.save();\r\n\t\tctx.translate(status.holdObject.pos.x, status.holdObject.pos.y);\r\n\t\tapi.drawTrashCan(ctx, 0.5 * w);\r\n\t\tctx.restore();\r\n\t} else {\r\n\t\tif (status.holding || status.hold) {\r\n\t\t\tstatus.holdObject.draw(ctx);\r\n\t\t}\r\n    }\r\n\r\n\r\n\t/* 繪製訊息 */\r\n\tif (status.message.text !== '') {\r\n\t\tctx.save();\r\n\r\n\t\tlet messageCycle = ((Date.now() - status.message.lastPost) / 3000);\r\n\t\tmessageCycle = (messageCycle < 0.05) ? messageCycle / 0.05 :\r\n\t\t\t\t\t   (messageCycle > 0.9) ? Math.max((1 - messageCycle), 0) / 0.1: 1 ;\r\n\t\tctx.globalAlpha = messageCycle;\r\n\r\n\t\tctx.translate(constant.mapStart.x, constant.mapStart.y);\r\n\t\tctx.globalAlpha *= 0.2;\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.rect(constant.mapSize.x * w * 0.3, 0, constant.mapSize.x * w * 0.4, w);\r\n\t\tctx.fillStyle = 'white';\r\n\t\tctx.fill();\r\n\t\tctx.closePath();\r\n\r\n\t\tctx.globalAlpha *= 5;\r\n\t\tctx.textAlign = \"center\";\r\n\t\tctx.textBaseline = 'middle';\r\n\t\tctx.font = \"15px italic\";\r\n\t\tctx.lineWidth = 2;\r\n\t\tctx.fillStyle = (status.message.color) ? status.message.color: 'red';\r\n\t\tctx.fillText(status.message.text, constant.mapSize.x * w * 0.5, 0.5 * w);\r\n\r\n\t\tctx.restore();\r\n    }\r\n}\r\n\r\nexport default Drawer;","import React, {\r\n    useState,\r\n    useEffect,\r\n    useRef,\r\n    useImperativeHandle,\r\n    forwardRef,\r\n} from \"react\";\r\nimport Drawer from \"./Drawer\";\r\nimport Engine from \"./Engine\";\r\nimport Controller from \"./Controller\";\r\nimport Vec2 from \"../Class/Vec2\";\r\nimport constant from \"../constant\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport Modal from \"@material-ui/core/Modal\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport { unpackage, enpackage } from \"../DataPackager\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Slider from \"@material-ui/core/Slider\";\r\n\r\nconst EtC = {\r\n    name: '名稱',\r\n    platform: '平台',\r\n    movingPlatform: '移動平台(直行)',\r\n    movingPlatform_oblique: '移動平台(斜向)',\r\n    movingPlatform_rect: '移動平台(矩形)',\r\n    trapPlatform: '陷阱平台',\r\n    mucus: '黏液',\r\n    ice: '冰層',\r\n    conveyor: '傳輸帶',\r\n    block: '方塊',\r\n    spikedBlock: '尖刺方塊',\r\n    bow: '弓箭座',\r\n    cymbal: '音鈸',\r\n    missileBase: '追蹤導彈發射台',\r\n    portal: '傳送門',\r\n    lockedWall: '上鎖的牆',\r\n    unlocker: '鑰匙',\r\n    woodenBox: '木箱',\r\n    magnet: '磁鐵',\r\n    brokenPlatform: '破碎平台',\r\n    deathTotem: '死亡圖騰',\r\n\r\n    direction: '方向',\r\n    up: '上',\r\n    down: '下',\r\n    left: '左',\r\n    right: '右',\r\n    'left-up': '左上',\r\n    'left-down': '左下',\r\n    'right-up': '右上',\r\n    'right-down': '右下',\r\n    horizontal: '水平',\r\n    vertical: '重直',\r\n    speed: '速度',\r\n    'super slow': '超級慢',\r\n    slow: '慢',\r\n    normal: '普通',\r\n    fast: '快',\r\n    'super fast': '超級快',\r\n    clock: '旋轉方向',\r\n    clockwise: '順時鐘',\r\n    counterclockwise: '逆時鐘',\r\n    duration: '間隔',\r\n    short: '短',\r\n    long: '長',\r\n    RoF: '射速',\r\n    range: '範圍',\r\n    large: '大',\r\n    small: '小',\r\n    magneticField: '磁場',\r\n    attraction: '吸引',\r\n    repulsion: '排斥',\r\n\r\n    distance: '距離',\r\n    width: '寬',\r\n    height: '高',\r\n\r\n    upSpike: '上方有刺',\r\n    downSpike: '下方有刺',\r\n    leftSpike: '左方有刺',\r\n    rightSpike: '右方有刺',\r\n    rotate: '旋轉',\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    formControl: {\r\n        margin: theme.spacing(1),\r\n        minWidth: 120,\r\n    },\r\n    selectEmpty: {\r\n        marginTop: theme.spacing(2),\r\n    },\r\n}));\r\nconst EditGameMode = forwardRef((props, ref) => {\r\n    const canvasRef = useRef();\r\n    const classes = useStyles();\r\n    const [value, setValue] = useState(1);\r\n\r\n    let setting = props.setting;\r\n    const [status, setStatus] = useState({\r\n        select: false,\r\n        selecting: false,\r\n        selectPair: [new Vec2(), new Vec2()],\r\n        hold: false,\r\n        holding: false,\r\n        holdObject: null,\r\n        holdDetail: {},\r\n        clear: false,\r\n        active: false,\r\n        opt: 0,\r\n        message: { text: '', lastPost: 0 },\r\n    });\r\n    const reset = () => {\r\n        props.save(setting);\r\n    };\r\n    useImperativeHandle(ref, () => ({\r\n        returnSetting() {\r\n            props.save(setting);\r\n        },\r\n    }));\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        const ctx = canvas.getContext(\"2d\");\r\n\r\n        let cancelController;\r\n        cancelController = Controller(canvas, status, setStatus, setting, reset);\r\n\r\n        let requestId;\r\n        const update = () => {\r\n            /* �C�@��(fps = 60)�i�檺��s */\r\n            if (status.active) Engine(setting.objects, setting.map);\r\n            Drawer(ctx, setting, status);\r\n\r\n            if (status.message.text !== '' && Date.now() > status.message.lastPost + 3000) {\r\n                status.message.text = '';\r\n            }\r\n\r\n            requestId = requestAnimationFrame(update);\r\n        };\r\n        update();\r\n\r\n        return () => {\r\n            cancelController();\r\n            cancelAnimationFrame(requestId);\r\n        };\r\n    }, [setStatus, status, setting]);\r\n\r\n    /* ���ܳQ��ܪ���l�ݩ� */\r\n    const changeSelectedGridsType = (newType) => {\r\n        if (!status.select) return;\r\n        let luPos = Vec2.leftUp(status.selectPair[0], status.selectPair[1]);\r\n        let rdPos = Vec2.rightDown(status.selectPair[0], status.selectPair[1]);\r\n        let range = rdPos.sub(luPos).add(new Vec2(1, 1));\r\n\r\n        for (let i = 0; i < range.x; i++) {\r\n            for (let j = 0; j < range.y; j++) {\r\n                if (setting.map[luPos.y + j][luPos.x + i].layer.isOverlap(constant.typeLayerPairs[newType])) return;\r\n            }\r\n        }\r\n        let oldTypes = [];\r\n        for (let i = 0; i < range.x; i++) {\r\n            for (let j = 0; j < range.y; j++) {\r\n                oldTypes.push(setting.map[luPos.y + j][luPos.x + i].type);\r\n                setting.map[luPos.y + j][luPos.x + i].type = newType;\r\n            }\r\n        }\r\n        let hasStart = false, hasEnd = false;\r\n        for (let i = 0; i < constant.mapSize.x; i++) {\r\n            for (let j = 0; j < constant.mapSize.y && (!hasEnd || !hasStart); j++) {\r\n                if (setting.map[j][i].type === 'start') hasStart = true;\r\n                else if (setting.map[j][i].type === 'end') hasEnd = true;\r\n            }\r\n        }\r\n        console.log(hasStart);\r\n        if (!hasEnd || !hasStart) {\r\n            for (let i = 0; i < range.x; i++) {\r\n                for (let j = 0; j < range.y; j++) {\r\n                    setting.map[luPos.y + j][luPos.x + i].type = oldTypes.shift();\r\n                }\r\n            }\r\n            status.message = { text: '地圖上至少必須包含一格起點和一格終點', lastPost: Date.now() };\r\n        }\r\n    };\r\n    /* ��l�ݩʦC�� */\r\n    const typeButtonPairs = [\r\n        [\"none\", \"空地\"],\r\n        [\"block\", \"場外\"],\r\n        [\"start\", \"起點\"],\r\n        [\"end\", \"終點\"],\r\n        [\"dead\", \"毒面\"],\r\n        [\"ice\", \"冰面\"],\r\n        [\"muddy\", \"泥面\"],\r\n    ];\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                <meta charset=\"utf-8\" />\r\n                <canvas\r\n                    id=\"EditModeCanvas\"\r\n                    ref={canvasRef}\r\n                    width={`1200px`}\r\n                    height={`582px`}\r\n                    style={{ textAlign: \"center\" }}\r\n                ></canvas>\r\n                <div\r\n                    style={{\r\n                        width: 1024,\r\n                        height: 64,\r\n                        backgroundColor: 'inherit',\r\n                        margin: \"0px auto\",\r\n                    }}\r\n                >\r\n                    <div id=\"EditModeParameters\" style={{ backgroundColor: \"inherit\" }}>\r\n                        {status.select ? (\r\n                            <div style={{ textAlign: \"center\" }}>\r\n                                {typeButtonPairs.map((pair) => (\r\n                                    <Button\r\n                                        size=\"small\"\r\n                                        color=\"secondary\"\r\n                                        variant=\"outlined\"\r\n                                        onClick={() => {\r\n                                            changeSelectedGridsType(pair[0]);\r\n                                        }}\r\n                                        disabled={!status.select}\r\n                                    >\r\n                                        {pair[1]}\r\n                                    </Button>\r\n                                ))}\r\n                            </div>\r\n                        ) : (\r\n                                <div></div>\r\n                            )}\r\n                        {status.holding || status.hold ? (\r\n                            <div style={{ backgroundColor: \"inherit\", marginRight: \"0.1cm\" }}>\r\n                                {Object.keys(status.holdDetail).map((p) => {\r\n                                    switch (status.holdDetail[p].type) {\r\n                                        case \"text\":\r\n                                            return (\r\n                                                <div\r\n                                                    style={{\r\n                                                        display: \"inline-block\",\r\n                                                        float: \"left\",\r\n                                                        backgroundColor: \"inherit\",\r\n                                                        marginRight: \"0.5cm\",\r\n                                                    }}\r\n                                                >\r\n                                                    <TextField\r\n                                                        label={EtC[p] ? EtC[p] : p}\r\n                                                        value={status.holdObject.detail[p]}\r\n                                                        onChange={(e) => {\r\n                                                            let newStatus = { ...status };\r\n                                                            let newDetail = { ...status.holdObject.detail };\r\n                                                            newDetail[p] = e.target.value;\r\n                                                            newStatus.holdObject.detail = newDetail;\r\n                                                            setStatus(newStatus);\r\n                                                        }}\r\n                                                    />\r\n                                                </div>\r\n                                            );\r\n                                        case \"select\":\r\n                                            return (\r\n                                                <div\r\n                                                    style={{\r\n                                                        display: \"inline-block\",\r\n                                                        float: \"left\",\r\n                                                        backgroundColor: \"inherit\",\r\n                                                        marginRight: \"0.5cm\",\r\n                                                    }}\r\n                                                >\r\n                                                    <FormControl\r\n                                                        variant=\"outlined\"\r\n                                                        className={classes.formControl}\r\n                                                    >\r\n                                                        <InputLabel>{EtC[p] ? EtC[p] : p}</InputLabel>\r\n                                                        <Select\r\n                                                            value={status.holdObject.detail[p]}\r\n                                                            onChange={(e) => {\r\n                                                                let newStatus = { ...status };\r\n                                                                let newDetail = { ...status.holdObject.detail };\r\n                                                                newDetail[p] = e.target.value;\r\n                                                                newStatus.holdObject.detail = newDetail;\r\n                                                                setStatus(newStatus);\r\n                                                            }}\r\n                                                            label={EtC[p] ? EtC[p] : p}\r\n                                                        >\r\n                                                            {status.holdDetail[p].options.map((o) => (\r\n                                                                <MenuItem value={o}>{EtC[o] ? EtC[o]: o}</MenuItem>\r\n                                                            ))}\r\n                                                        </Select>\r\n                                                    </FormControl>\r\n                                                </div>\r\n                                            );\r\n                                        case \"int\":\r\n                                            return (\r\n                                                <div\r\n                                                    style={{\r\n                                                        display: \"inline-block\",\r\n                                                        float: \"left\",\r\n                                                        backgroundColor: \"inherit\",\r\n                                                        marginRight: \"0.5cm\",\r\n                                                    }}\r\n                                                >\r\n                                                    <Typography id=\"discrete-slider\" gutterBottom>\r\n                                                        {EtC[p] ? EtC[p] : p}\r\n                          </Typography>\r\n                                                    <Slider\r\n                                                        style={{ minWidth: 200 }}\r\n                                                        value={status.holdObject.detail[p]}\r\n                                                        aria-labelledby=\"discrete-slider\"\r\n                                                        valueLabelDisplay=\"auto\"\r\n                                                        step={1}\r\n                                                        marks\r\n                                                        min={status.holdDetail[p].min}\r\n                                                        max={status.holdDetail[p].max}\r\n                                                        onChange={(e, newValue) => {\r\n                                                            let newStatus = { ...status };\r\n                                                            let newDetail = { ...status.holdObject.detail };\r\n                                                            newDetail[p] = newValue;\r\n                                                            newStatus.holdObject.detail = newDetail;\r\n                                                            setStatus(newStatus);\r\n                                                        }}\r\n                                                    />\r\n                                                </div>\r\n                                            );\r\n                                        case \"check\":\r\n                                            return (\r\n                                                <div\r\n                                                    style={{\r\n                                                        display: \"inline-block\",\r\n                                                        float: \"left\",\r\n                                                        backgroundColor: \"inherit\",\r\n                                                        marginRight: \"0.5cm\",\r\n                                                    }}\r\n                                                >\r\n                                                    <FormControlLabel\r\n                                                        control={\r\n                                                            <Checkbox\r\n                                                                checked={status.holdObject.detail[p]}\r\n                                                                onChange={(e) => {\r\n                                                                    let newStatus = { ...status };\r\n                                                                    let newDetail = {\r\n                                                                        ...status.holdObject.detail,\r\n                                                                    };\r\n                                                                    newDetail[p] = e.target.checked;\r\n                                                                    newStatus.holdObject.detail = newDetail;\r\n                                                                    setStatus(newStatus);\r\n                                                                }}\r\n                                                            />\r\n                                                        }\r\n                                                        label={EtC[p] ? EtC[p] : p}\r\n                                                    />\r\n                                                </div>\r\n                                            );\r\n                                        default:\r\n                                            return <div></div>;\r\n                                    }\r\n                                })}\r\n                            </div>\r\n                        ) : (\r\n                                <div style={{ backgroundColor: \"inherit\" }}></div>\r\n                            )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n});\r\n\r\nexport default EditGameMode;\r\n","import Vec2 from '../Class/Vec2';\r\nimport * as GameObject from '../Class/GameObject';\r\nimport constant from '../constant';\r\n\r\nexport default function Controller(scene, status, setStatus, setting, reset) {\r\n\tconst mapStart = constant.mapStart;\r\n\tconst mapEnd = constant.mapStart.add(constant.mapSize.mul(constant.gridWidth));\r\n\tconst w = constant.gridWidth;\r\n\tconst copyable = (e, object) => {\r\n\t\treturn (e.ctrlKey && object.type !== 'portal' && object.type !== 'lockedWall' && object.type !== 'unlocker' && object.type !== 'woodenBox')\r\n\t};\r\n\r\n\tconst mouseMoveHandler = (e) => {\r\n\t\tconst mousePos = new Vec2(e.offsetX, e.offsetY);\r\n\t\tif (!status.holding && status.selecting && mousePos.between(mapStart, mapEnd)) {\r\n\t\t\t/* 當使用者沒有操控物件時並且正在選擇格子的時候，在地圖空間內即時更新選擇範圍 */\r\n\t\t\tlet selectGridPos = mousePos.sub(mapStart).toGrid(w);\r\n\t\t\tstatus.selectPair[1] = selectGridPos;\r\n\t\t} else if (status.holding) {\r\n\t\t\t/* 當使用者正在操控物件時，更新物件位子到滑鼠位子 */\r\n\t\t\tif (mousePos.between(mapStart, mapEnd) && !status.clear) {\r\n\t\t\t\t/* 物件在地圖內時必須即時校正位子 */\r\n\t\t\t\tstatus.holdObject.pos = mousePos.sub(mapStart).toGrid(w).mul(w).add(mapStart.add(new Vec2(0.5 * w, 0.5 * w)));\r\n\t\t\t} else status.holdObject.pos = mousePos.clone();\r\n\t\t}\r\n\t};\r\n\r\n\tconst mouseDownHandler = (e) => {\r\n\t\tconst mousePos = new Vec2(e.offsetX, e.offsetY);\r\n\t\tif (e.button === 0) {\r\n\t\t\tif (mousePos.between(mapStart, mapEnd)) {\r\n\t\t\t\tconsole.log(status.clear);\r\n\t\t\t\tif (status.clear) {\r\n\t\t\t\t\tlet gridPos = mousePos.sub(mapStart).toGrid(w);\r\n\t\t\t\t\tlet topLayer = setting.map[gridPos.y][gridPos.x].layer.top();\r\n\t\t\t\t\tif (topLayer !== -1) { // 代表有物件疊在格子上(處理物件清除)\r\n\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\r\n\t\t\t\t\t\t\tif (setting.objects[i].gridPos.equal(gridPos)) {\r\n\t\t\t\t\t\t\t\tif (e.ctrlKey || setting.objects[i].layer.top() === topLayer) {\r\n\t\t\t\t\t\t\t\t\tsetting.objects[i].remove(setting.map, setting.objects);\r\n\t\t\t\t\t\t\t\t\tsetting.objects.splice(i--, 1);\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t/* 在地圖內按下滑鼠左鍵 */\r\n\t\t\t\t\tif (status.holding) {\r\n\t\t\t\t\t\tstatus.holdObject.pos = mousePos.sub(mapStart).toGrid(w).mul(w).add(mapStart.add(new Vec2(0.5 * w, 0.5 * w)));\r\n\t\t\t\t\t\t/* 嘗試把物件放在地圖上 */\r\n\t\t\t\t\t\tlet newStatus = { ...status };\r\n\t\t\t\t\t\tif (e.ctrlKey && !copyable(e, status.holdObject)) {\r\n\t\t\t\t\t\t\tnewStatus.message = { text: '這個物件無法被複製', lastPost: Date.now() };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewStatus.holding = copyable(e, status.holdObject);\r\n\t\t\t\t\t\tif (status.holdObject.place(setting.map, setting.objects)) {\r\n\t\t\t\t\t\t\tsetting.objects.push(status.holdObject);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewStatus.message = { text: '這個格子已經被其他同種的物件佔據', lastPost: Date.now() };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewStatus.holdObject = (copyable(e, status.holdObject)) ? status.holdObject.clone() : null;\r\n\t\t\t\t\t\tsetStatus(newStatus);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t/* 如果沒有在操控物件則開始選擇格子或是選取在地圖上的物件 */\r\n\t\t\t\t\t\tlet newStatus = { ...status };\r\n\t\t\t\t\t\tlet gridPos = mousePos.sub(mapStart).toGrid(w);\r\n\t\t\t\t\t\tlet topLayer = setting.map[gridPos.y][gridPos.x].layer.top();\r\n\t\t\t\t\t\tif (topLayer !== -1) { // 代表有物件疊在格子上(優先處理物件操控)\r\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\r\n\t\t\t\t\t\t\t\tif (setting.objects[i].gridPos.equal(gridPos) && setting.objects[i].layer.top() === topLayer) {\r\n\t\t\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\t\t\tnewStatus.hold = false;\r\n\t\t\t\t\t\t\t\t\tnewStatus.select = false;\r\n\t\t\t\t\t\t\t\t\tnewStatus.selecting = false;\r\n\t\t\t\t\t\t\t\t\tif (e.ctrlKey && !copyable(e, setting.objects[i])) {\r\n\t\t\t\t\t\t\t\t\t\tnewStatus.message = { text: '這個物件無法被複製', lastPost: Date.now() };\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (!copyable(e, setting.objects[i])) setting.objects[i].remove(setting.map, setting.objects);\r\n\t\t\t\t\t\t\t\t\tnewStatus.holdObject = (copyable(e, setting.objects[i])) ? setting.objects[i].clone() : setting.objects[i];\r\n\t\t\t\t\t\t\t\t\tnewStatus.holdObject.pos = mousePos.sub(mapStart).toGrid(w).mul(w).add(mapStart.add(new Vec2(0.5 * w, 0.5 * w)));\r\n\t\t\t\t\t\t\t\t\tnewStatus.holdDetail = setting.objects[i].detailFunction();\r\n\t\t\t\t\t\t\t\t\tif (!copyable(e, setting.objects[i])) setting.objects.splice(i, 1);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewStatus.select = true;\r\n\t\t\t\t\t\t\tnewStatus.selecting = true;\r\n\t\t\t\t\t\t\tnewStatus.selectPair = [gridPos, gridPos];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetStatus(newStatus);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t/* 左鍵點到地圖外則將一切狀態解除(點到物件編輯庫例外) */\r\n\t\t\t\tlet newStatus = { ...status };\r\n\t\t\t\tnewStatus.select = false;\r\n\t\t\t\tnewStatus.selecting = false;\r\n\t\t\t\tnewStatus.holding = false;\r\n\t\t\t\tnewStatus.hold = false;\r\n\t\t\t\tnewStatus.holdObject = null;\r\n\t\t\t\tnewStatus.clear = false;\r\n\t\t\t\tsetStatus(newStatus);\r\n\t\t\t\tif (mousePos.between(new Vec2(88, 516), new Vec2(1112, 580))) {\r\n\t\t\t\t\t/* 在物件編輯庫內點擊則獲得一個新物件進行操控 */\r\n\t\t\t\t\tlet objectIndex = ~~((e.offsetX - 88) / 64);\r\n\t\t\t\t\tlet result = '';\r\n\t\t\t\t\tif (objectIndex === 0) result = 'stoporplay';\r\n\t\t\t\t\telse if (objectIndex === 15) result = 'clear';\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tconst objectList = [];\r\n\t\t\t\t\t\tobjectList.push('class platform');\r\n\t\t\t\t\t\tif (status.opt === 1) objectList.push(...constant.editObjectList.platform);\r\n\t\t\t\t\t\tobjectList.push('class covering');\r\n\t\t\t\t\t\tif (status.opt === 2) objectList.push(...constant.editObjectList.covering);\r\n\t\t\t\t\t\tobjectList.push('class obstacle');\r\n\t\t\t\t\t\tif (status.opt === 3) objectList.push(...constant.editObjectList.obstacle);\r\n\t\t\t\t\t\tobjectList.push('class special');\r\n\t\t\t\t\t\tif (status.opt === 4) objectList.push(...constant.editObjectList.special);\r\n\t\t\t\t\t\tresult = (objectList[objectIndex - 1]) ? objectList[objectIndex - 1] : '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet count = 0;\r\n\t\t\t\t\tswitch (result) {\r\n\t\t\t\t\t\tcase 'stoporplay':\r\n\t\t\t\t\t\t\tnewStatus.clear = false;\r\n\t\t\t\t\t\t\tnewStatus.active = !newStatus.active;\r\n\t\t\t\t\t\t\tif (newStatus.active) {\r\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '建議在靜止狀態下編輯物件', lastPost: Date.now(), color: 'green'};\r\n                            }\r\n\t\t\t\t\t\t\treset();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'clear':\r\n\t\t\t\t\t\t\tnewStatus.clear = !newStatus.clear;\r\n\t\t\t\t\t\t\tif (newStatus.clear) {\r\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '注意！你現在處於清除物件的狀態', lastPost: Date.now(), color: 'green' };\r\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject = { type: 'trashCan', pos: new Vec2(e.offsetX, e.offsetY)};\r\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = {};\r\n                            }\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'class platform':\r\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 1) ? 0 : 1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'class covering':\r\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 2) ? 0 : 2;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'class obstacle':\r\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 3) ? 0 :  3;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'class special':\r\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 4) ? 0 : 4;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'spikedBlock':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.spikedBlock(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'platform':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.platform(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'bow':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.bow(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'movingPlatform':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.movingPlatform(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mucus':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.mucus(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'cymbal':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.cymbal(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'ice':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.ice(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'conveyor':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.conveyor(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'portal':\r\n\t\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\r\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'portal') count++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (count < 16) {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.portal(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\r\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '傳送門最多只能放置 16 個', lastPost: Date.now() };\r\n                            }\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'trapPlatform':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.trapPlatform(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'missileBase':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.missileBase(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'lockedWall':\r\n\t\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\r\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'lockedWall') count++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (count < 8) {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.lockedWall(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\r\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '上鎖的牆最多只能放置 8 個', lastPost: Date.now() };\r\n                            }\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'unlocker':\r\n\t\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\r\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'unlocker') count++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (count < 8) {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.unlocker(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\r\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '鑰匙最多只能放置 8 個', lastPost: Date.now() };\r\n                            }\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'block':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.block(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak; \r\n\t\t\t\t\t\tcase 'movingPlatform_oblique':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.movingPlatform_oblique(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'movingPlatform_rect':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.movingPlatform_rect(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'woodenBox':\r\n\t\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\r\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'woodenBox') count++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (count < 16) {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.woodenBox(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\r\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '木箱最多只能放置 16 個', lastPost: Date.now() };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'magnet':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.magnet(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'brokenPlatform':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.brokenPlatform(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'deathTotem':\r\n\t\t\t\t\t\t\tnewStatus.holding = true;\r\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.deathTotem(new Vec2(e.offsetX, e.offsetY));\r\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\r\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (result !== 'clear') newStatus.clear = false;\r\n\t\t\t\t\tsetStatus(newStatus);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst mouseUpHandler = (e) => {\r\n\t\tconst mousePos = new Vec2(e.offsetX, e.offsetY);\r\n\t\tif (e.button === 0 && status.select && status.selecting && mousePos.between(mapStart, mapEnd)) {\r\n\t\t\t/* 在正在選擇的狀態下放開左鍵確定選擇格子的範圍後解除正在選擇的狀態 */\r\n\t\t\tlet newStatus = { ...status };\r\n\t\t\tnewStatus.selecting = false;\r\n\t\t\tlet selectGridPos = mousePos.sub(mapStart).toGrid(w);\r\n\t\t\tnewStatus.selectPair[1] = selectGridPos;\r\n\t\t\tsetStatus(newStatus);\r\n\t\t} else {\r\n\t\t\t/* 否則在任何其他狀況都直接解除選擇/正在選擇的狀態 */\r\n\t\t\tlet newStatus = { ...status };\r\n\t\t\tnewStatus.select = false;\r\n\t\t\tnewStatus.selecting = false;\r\n\t\t\tsetStatus(newStatus);\r\n\t\t}\r\n\t}\r\n\r\n\tconst stopContextMenu = (e) => {\r\n\t\te.preventDefault();\r\n\t};\r\n\r\n\tscene.addEventListener('mousemove', mouseMoveHandler);\r\n\tscene.addEventListener('mousedown', mouseDownHandler);\r\n\tscene.addEventListener('mouseup', mouseUpHandler);\r\n\tscene.addEventListener('contextmenu', stopContextMenu);\r\n\r\n\treturn () => {\r\n\t\tscene.removeEventListener('mousemove', mouseMoveHandler);\r\n\t\tscene.removeEventListener('mousedown', mouseDownHandler);\r\n\t\tscene.removeEventListener('mouseup', mouseUpHandler);\r\n\t\tscene.removeEventListener('contextmenu', stopContextMenu);\r\n\t};\r\n};","import constant from '../constant';\r\n\r\nexport default function Engine(objects, map) {\r\n    for (let i = 0; i < constant.maxLayer; i++) {\r\n        for (let j = 0; j < objects.length; j++) {\r\n            if (objects[j].update) {\r\n                const result = objects[j].update(objects, map);\r\n                switch (result.type) {\r\n                    case 'produce':\r\n                        objects.push(result.object);\r\n                        break;\r\n                    case 'destory':\r\n                        objects.splice(j--, 1);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport { useState, useRef } from \"react\";\r\nimport EditMode from \"../GameContainer/EditMode/Main\";\r\nimport Vec2 from \"../GameContainer/Class/Vec2\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport ErrorPage from \"./ErrorPage\";\r\nimport LoadingPage from \"./LoadingPage\";\r\nimport instance from \"./Api\";\r\n\r\n// import util from \"util\";\r\nimport init from \"../GameContainer/Setting/example_0\";\r\nimport { enpackage, unpackage, show } from \"../GameContainer/DataPackager\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CloudUploadIcon from \"@material-ui/icons/CloudUpload\";\r\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport Modal from \"@material-ui/core/Modal\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport {url} from \"./url\";\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  margin: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  extendedIcon: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n}));\r\nfunction checkLogin(props) {\r\n  if (props.location.state === undefined) return false;\r\n  else if (!props.location.state.login) return false;\r\n  return true;\r\n}\r\n\r\nfunction Edit(props) {\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n  const [open, setOpen] = useState(false);\r\n  const [title, setTitle] = useState(props.data.title);\r\n  const [description, setDescription] = useState(props.data.description);\r\n  // for Snackbar Alert\r\n  const [msgOpen, setMsgOpen] = useState(false);\r\n  const [alertMsg, setAlertMsg] = useState(\"\");\r\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\r\n  const [setting, setSetting] = useState(init);\r\n  const [idGetMap, setidGetMap] = useState(false);\r\n  const [publish, setPublish] = useState(false);\r\n  // upload work around\r\n  const [delayUpload, setDelayUpload] = useState(false);\r\n\r\n  const [id, setId] = useState(props.data.id);\r\n  const childRef = useRef();\r\n\r\n  let { name, uuid, login } = props.data;\r\n\r\n  const handleUpload = async () => {\r\n    console.log(\"upload function\");\r\n    let settingPack = setting;\r\n    let id0 = id;\r\n    const {\r\n      data: { success, errorCode, idNew },\r\n    } = await instance.post(\"/api/upload\", {\r\n      uuid,\r\n      settingPack,\r\n      title,\r\n      description,\r\n      name,\r\n      publish,\r\n      id0,\r\n    });\r\n    if (!success) {\r\n      if (errorCode === 1) {\r\n        setAlertMsg(\"This map exists. The map has been updated\");\r\n        setAlertType(\"info\");\r\n        setMsgOpen(true);\r\n        // alert(`This map exists.`);\r\n      } else if (errorCode === 2) {\r\n        // alert(`Too many maps!! Every user can only save 8 maps.`);\r\n        setAlertMsg(\"Too many maps!! Every user can only save 8 maps.\");\r\n        setAlertType(\"error\");\r\n        setMsgOpen(true);\r\n      } else {\r\n        // alert(`Unknow error. Error code:${errorCode}`);\r\n        setAlertMsg(`Unknow error. Error code:${errorCode}`);\r\n        setAlertType(\"error\");\r\n        setMsgOpen(true);\r\n      }\r\n    } else {\r\n      setAlertMsg(\"This is a success message!\");\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n    }\r\n    // id = idNew;\r\n    setId(idNew);\r\n    console.log(\"Upload success\");\r\n    setOpen(false);\r\n  };\r\n\r\n  const getMap = async () => {\r\n    const {\r\n      data: { success, errorCode, map },\r\n    } = await instance.post(\"/api/getMap\", {\r\n      id,\r\n    });\r\n    if (!success) {\r\n      setAlertMsg(`Error. Error code:${errorCode}`);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n    } else {\r\n      setAlertMsg(`Load data success`);\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n      setSetting(map[\"content\"]);\r\n      setidGetMap(true);\r\n    }\r\n  };\r\n\r\n  if (id !== 0 && idGetMap === false) {\r\n    getMap();\r\n  }\r\n  if (delayUpload) {\r\n    handleUpload();\r\n    setDelayUpload(false);\r\n  }\r\n\r\n  const save = (setting) => {\r\n    console.log(\"Update setting\");\r\n    setSetting(enpackage(setting));\r\n    // show(enpackage(setting));\r\n  };\r\n\r\n  // console.log(util.inspect(setting, {showHidden: false, depth: null}))\r\n\r\n  return (\r\n    <div style={{ textAlign: \"center\" }}>\r\n      <Snackbar\r\n        open={msgOpen}\r\n        autoHideDuration={500}\r\n        onClose={() => {\r\n          setMsgOpen(false);\r\n        }}\r\n      >\r\n        <Alert\r\n          onClose={() => {\r\n            setMsgOpen(false);\r\n          }}\r\n          severity={alertType}\r\n        >\r\n          {alertMsg}\r\n        </Alert>\r\n      </Snackbar>\r\n      <div style={{ marginTop: \"1em\" }}>\r\n        <IconButton\r\n          className={classes.margin}\r\n          size=\"large\"\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n          onClick={history.goBack}\r\n        >\r\n          <ArrowBackRoundedIcon />\r\n        </IconButton>\r\n\r\n        <IconButton\r\n          className={classes.margin}\r\n          size=\"large\"\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n          disabled={Object.entries(setting).length === 0}\r\n          onClick={() => {\r\n            childRef.current.returnSetting();\r\n            setOpen(true);\r\n          }}\r\n        >\r\n          <CloudUploadIcon />\r\n        </IconButton>\r\n        <IconButton\r\n          size=\"large\"\r\n          variant=\"contained\"\r\n          color=\"secondary\"\r\n          onClick={() => {\r\n            if (childRef.current) {\r\n              childRef.current.returnSetting();\r\n            }\r\n            if (!title || !description) {\r\n              setOpen(true);\r\n            } else {\r\n              setPublish(false);\r\n              setDelayUpload(true);\r\n              // setTimeout(setOpen(true), 500);\r\n              // setOpen(false);\r\n\r\n              // handleUpload();\r\n              // setTimeout(handleUpload, 600);\r\n            }\r\n          }}\r\n        >\r\n          <SaveIcon />\r\n        </IconButton>\r\n      </div>\r\n      <Modal\r\n        open={open}\r\n        onClose={() => {\r\n          setOpen(false);\r\n        }}\r\n      >\r\n        <>\r\n          <div className=\"upload\">\r\n            <TextField\r\n              label=\"Title\"\r\n              variant=\"filled\"\r\n              rows={1}\r\n              placeholder=\"Title\"\r\n              defaultValue=\"\"\r\n              value={title}\r\n              onChange={(event) => {\r\n                setTitle(event.target.value);\r\n              }}\r\n            />\r\n            <TextField\r\n              id=\"filled-textarea\"\r\n              label=\"Description\"\r\n              variant=\"filled\"\r\n              multiline\r\n              placeholder=\"Description\"\r\n              defaultValue=\"\"\r\n              value={description}\r\n              onChange={(event) => {\r\n                setDescription(event.target.value);\r\n              }}\r\n            />\r\n            <IconButton\r\n              className={classes.margin}\r\n              size=\"large\"\r\n              variant=\"contained\"\r\n              color=\"secondary\"\r\n              onClick={handleUpload}\r\n              disabled={!title || !description}\r\n            >\r\n              <CloudUploadIcon />\r\n            </IconButton>\r\n          </div>\r\n          <div className=\"upload_\">\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={publish}\r\n                  onChange={() => setPublish(!publish)}\r\n                  name=\"public on internet\"\r\n                />\r\n              }\r\n              label=\"public on internet\"\r\n            />\r\n          </div>\r\n        </>\r\n      </Modal>\r\n      {msgOpen === true ? (\r\n        <LoadingPage />\r\n      ) : (\r\n        <EditMode\r\n          width=\"1200px\"\r\n          height=\"600px\"\r\n          ref={childRef}\r\n          setting={unpackage(setting)}\r\n          save={save}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\nfunction Editmode(props) {\r\n  return (\r\n    <>\r\n      {checkLogin(props) ? <Edit data={props.location.state} /> : <ErrorPage />}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Editmode;\r\n","\r\nexport const CONSTANT = {\r\n\tgridWidth: 32,\r\n\tblockColor: '#E0E0E0',\r\n\t// canvasLeft: 150,\r\n\t// canvasTop: 70,\r\n    CanvasWidth: \"1250\",\r\n    CanvasHeight: \"680\",\r\n\ttranslate: {x: -270,y:-110},\r\n\tscale: {w: 2.5,h:2.5},\r\n\tPlayerR: 10,\r\n\tPLAYING:'playing',\r\n\tGameOver: 'GAME OVER',\r\n\tWIN: 'WIN'\r\n};\r\n\r\nexport const Msg = {\r\n\tspike: [\"死於【尖刺】\", \"被刺到了啦\"],\r\n\tarrow: [\"死於【箭矢】\", \"暗箭難防QQ\"],\r\n\tcymbalWave: [\"死於【音波】\", \"你的耳膜還好嗎？\"],\r\n\tmissile: [\"死於【飛彈】\", \"來自北緯38度線的問候\"],\r\n\tdeathTotem: [\"死於【死亡圖騰】\", \"太小看圖騰的威力！\"],\r\n\t// floor\r\n\tdead: [\"死於【毒面】\", \"紫水有毒...\"],\r\n\tend: [\"耶黑\", \"逃出來惹\"]\r\n}\r\n\r\nexport const Link = {\r\n\tgithub: \"https://github.com/allpass122/WebProgrammmingFinal2020\"\r\n}\r\n","export default __webpack_public_path__ + \"static/media/seal.def45113.svg\";","export default __webpack_public_path__ + \"static/media/lion.d23746ff.svg\";","export default __webpack_public_path__ + \"static/media/cat.79597c16.svg\";","export default __webpack_public_path__ + \"static/media/star.9ea2b3d5.svg\";","// tribute to https://github.com/vzhou842/example-.io-game\n// svg source: https://www.flaticon.com/\nimport axios from \"axios\";\nimport SealIcon from \"../../assets/seal.svg\";\nimport LionIcon from \"../../assets/lion.svg\";\nimport CatIcon from \"../../assets/cat.svg\";\nimport StarIcon from \"../../assets/star.svg\";\n\nconst ASSET_NAMES = [\"seal.svg\", \"lion.svg\", \"cat.svg\"];\nconst ALL_ASSET_NAMES = [\"seal.svg\", \"lion.svg\", \"cat.svg\", \"star.svg\"];\n\nconst mapName2Path = {\n  \"seal.svg\": SealIcon,\n  \"lion.svg\": LionIcon,\n  \"cat.svg\": CatIcon,\n  \"star.svg\": StarIcon,\n};\n\nconst assets = {};\n\nconst downloadPromise = Promise.all(ALL_ASSET_NAMES.map(downloadAsset));\n\n/** @param {keyof mapName2Path} name */\nasync function downloadAsset(name) {\n  const image = new Image();\n  let imageSrc = mapName2Path[name];\n  if (imageSrc.endsWith(\".svg\")) {\n    const resp = await axios.get(mapName2Path[name]);\n    const doc = new DOMParser().parseFromString(resp.data, \"text/xml\");\n    const svgElem = doc.getElementsByTagName(\"svg\")[0];\n    svgElem.setAttribute(\"width\", \"48px\");\n    svgElem.setAttribute(\"height\", \"48px\");\n    const b64Svg = btoa(new XMLSerializer().serializeToString(svgElem));\n    imageSrc = \"data:image/svg+xml;base64,\" + b64Svg;\n  }\n  await new Promise((resolve) => {\n    image.onload = () => resolve();\n    image.src = imageSrc;\n  });\n  assets[name] = image;\n}\n\nexport const downloadAssets = () => downloadPromise;\n\nexport const getAsset = (assetName) => assets[assetName];\n\nexport const getAssetNames = () => ASSET_NAMES;\n","import {clear, drawMap} from '../Drawer'\r\nimport constant from '../constant';\r\nimport {CONSTANT} from './PlayModeConstant'\r\nimport { getAsset } from './assets';\r\n\r\nlet FOCUS_PLAYER = true\r\nlet PLAY_MODE = true\r\n\r\nfunction Drawer(ctx, setting, status) {\r\n\tlet map = setting.map;\r\n\tlet objects = setting.objects;\r\n\tlet me = status.me.serializeForUpdate()\r\n\tconst w = constant.gridWidth\r\n\r\n\t/* �M�ŵe�� */\r\n\tclear(ctx);\r\n\r\n\t\r\n\tctx.restore()\r\n\tctx.save()\r\n\r\n\t// draw background\r\n\tctx.fillStyle = constant.blockColor\r\n\tctx.fillRect(0, -100, constant.mapSize.x*w*2, constant.mapSize.y*w*2);\r\n\r\n\tif (status.FOCUS_PLAYER) {\r\n\t\tctx.scale(CONSTANT.scale.w, CONSTANT.scale.h);\r\n\t\tctx.translate(CONSTANT.translate.x, CONSTANT.translate.y);        \r\n\t} else {\r\n\t\t// playmode whole view\r\n\t\tctx.scale(1.2, 1.2);\r\n\t\tctx.translate(-80, 30);\t\r\n\t}\r\n\t\r\n\t/* ø�s�a�� */\r\n\tctx.save();\r\n\tctx.translate(constant.mapStart.x, constant.mapStart.y); \r\n\tfocusPlayer(ctx, me, status)\r\n\tdrawMap(ctx, map, PLAY_MODE);\r\n\tctx.restore();\r\n\r\n\t/* ø�s���� */\r\n\tctx.save();\r\n\tfocusPlayer(ctx, me, status)\r\n\tfor (let i = 0; i < constant.maxLayer; i++) {\r\n\t\t// 2 < player layer < 3\r\n\t\tif (i === 3) drawPlayer(ctx, me, me, status.head)\r\n\t\tfor (let j = 0; j < objects.length; j++) {\r\n\t\t\tif (objects[j].layer.top() === i) objects[j].draw(ctx);\r\n\t\t}\r\n\t}\r\n\tctx.restore();\r\n\t\r\n}\r\n\r\nfunction focusPlayer(context, me, status) {\r\n\tif (!status.FOCUS_PLAYER) return\r\n\tconst w = constant.gridWidth\r\n\tlet focusX =  0*constant.mapStart.x + constant.mapSize.x*w/2 - me.x\r\n\tlet focusY =  0*constant.mapStart.y + constant.mapSize.y*w/2 - me.y\r\n\tcontext.translate(focusX, focusY); \r\n}\r\n\r\n// Renders a player at the given coordinates\r\nfunction drawPlayer(context, me, player, head = 'seal.svg') {\r\n\tconst { x, y } = me;\r\n\tconst w = constant.gridWidth\r\n  \r\n\tcontext.save();\r\n\tcontext.translate(x, y);\r\n\r\n\t// context.globalAlpha = 0.5\r\n\tcontext.drawImage(\r\n\t\tgetAsset(head),\r\n\t\t-CONSTANT.PlayerR,\r\n\t\t-CONSTANT.PlayerR,\r\n\t\tCONSTANT.PlayerR * 2,\r\n\t\tCONSTANT.PlayerR * 2,\r\n\t  );\r\n  \r\n\tcontext.restore();\r\n  }\r\n\r\nexport default Drawer;","import constant from '../constant';\r\nimport { CONSTANT } from './PlayModeConstant';\r\n\r\nexport default function Engine(objects, map, status) {\r\n    const {me} = status\r\n    const needEngin = ['movingPlatform','movingPlatform_oblique', 'movingPlatform_rect', \r\n                'bow', 'arrow', 'missile', 'missileBase', 'cymbal','cymbalWave', 'woodenBox', 'mucus' ]\r\n\r\n    for (let i = 0; i < constant.maxLayer; i++) {\r\n        for (let j = 0; j < objects.length; j++) {\r\n            if ( status.gameState === CONSTANT.PLAYING \r\n                && !inView(objects[j].pos, me) \r\n                && !needEngin.includes(objects[j].type) ) continue \r\n            if (objects[j].update) {\r\n                const result = objects[j].update(objects, map);\r\n                switch (result.type) {\r\n                    case 'produce':\r\n                        objects.push(result.object);\r\n                        break;\r\n                    case 'destory':\r\n                        objects.splice(j--, 1);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction inView(ObjPos, me){\r\n    const [halfViewX, halfViewY] = [250, 180]\r\n    if ( ObjPos.x > me.pos.x - halfViewX && ObjPos.x < me.pos.x + halfViewX \r\n            && ObjPos.y > me.pos.y - halfViewY && ObjPos.y < me.pos.y + halfViewY ){\r\n                // console.log('me ', me.pos)\r\n                // console.log('obj ', ObjPos)\r\n                // console.log(\"inView\")\r\n                return true\r\n            }\r\n    else return false\r\n}","import Vec2 from \"../Class/Vec2\";\r\nimport constant from \"../constant\"\r\nimport {CONSTANT, Msg} from \"./PlayModeConstant\"\r\n\r\nconst w = constant.gridWidth;\r\nlet blockArea = []\r\n\r\nexport function initState(status, setting) {\r\n  const { map, objects } = setting\r\n\r\n  // random player start area\r\n  const startArea = []\r\n  map.forEach((line, y) => (line.forEach((square, x) => {\r\n    if (square.type.includes('start')) startArea.push({ x, y })\r\n  })))\r\n  const { x, y } = startArea[Math.floor(Math.random() * startArea.length)]\r\n  status.me.moveTo(constant.mapStart.x + (x + 0.5) * w, constant.mapStart.y + (y + 0.5) * w)\r\n\r\n  blockArea = []\r\n  map.forEach((line, y) => (line.forEach((square, x) => {\r\n    if (square.type.includes('block')) blockArea.push({ x, y })\r\n  })))\r\n\r\n  // set object no transparant\r\n  for (let i = 0; i < objects.length; i++) {\r\n    if (objects[i].setPerspective) objects[i].setPerspective(false)\r\n  }\r\n\r\n  status.startTime = Date.now()\r\n  status.lastUpdateTime = Date.now()\r\n}\r\n\r\nexport function updateState(status, setting, setStatus) {\r\n  const { map } = setting\r\n\r\n  const dt = Date.now() - status.lastUpdateTime\r\n\r\n  checkLocation(status, map, setStatus)\r\n  checkEncounter(status, setting, setStatus)\r\n  status.lastUpdateTime = Date.now()\r\n  push(status)\r\n\r\n  status.me.update(dt)\r\n\r\n}\r\n\r\nfunction push(status){\r\n  let { pressDown, pressRight, pressLeft, pressUp } = status\r\n  let [pushX, pushY] = [0, 0]\r\n  if (pressDown) pushY += 1\r\n  if (pressUp) pushY -= 1\r\n  if (pressRight) pushX += 1\r\n  if (pressLeft) pushX -= 1\r\n  status.me.push(new Vec2(pushX, pushY))\r\n}\r\n\r\n\r\nfunction checkLocation(status, map, setStatus) {\r\n  let { x, y } = status.me.serializeForUpdate()\r\n  let {me} = status.me \r\n  const LeftBound = constant.mapStart.x + CONSTANT.PlayerR\r\n  const RightBound = constant.mapStart.x + constant.mapSize.x * w - CONSTANT.PlayerR\r\n  const UpperBound = constant.mapStart.y + CONSTANT.PlayerR\r\n  const LowerBound = constant.mapStart.y + constant.mapSize.y * w - CONSTANT.PlayerR\r\n\r\n  // canvas 4 sides rebound\r\n  if (x < LeftBound || x > RightBound || y < UpperBound || y > LowerBound) {\r\n    status.me.returnLastLoc()\r\n    if (x < LeftBound)\r\n      status.me.rebound(new Vec2(LeftBound - w, y))\r\n    else if (x > RightBound)\r\n      status.me.rebound(new Vec2(RightBound + w, y))\r\n    else if (y < UpperBound)\r\n      status.me.rebound(new Vec2(x, UpperBound - w))\r\n    else if (y > LowerBound)\r\n      status.me.rebound(new Vec2(x, 9999))\r\n  }\r\n\r\n  // block 4 sides rebound\r\n  blockArea.some(block => {\r\n    if (x + CONSTANT.PlayerR > constant.mapStart.x + (block.x) * w\r\n      && x - CONSTANT.PlayerR < constant.mapStart.x + (block.x + 1) * w\r\n      && y + CONSTANT.PlayerR > constant.mapStart.y + (block.y) * w\r\n      && y - CONSTANT.PlayerR < constant.mapStart.y + (block.y + 1) * w) {\r\n      status.me.returnLastLoc()\r\n      status.me.squareRebound(new Vec2(constant.mapStart.x + (block.x + 0.5) * w, constant.mapStart.y + (block.y + 0.5) * w))\r\n      return true\r\n    }\r\n  })\r\n\r\n  // check floor type & onPlateform\r\n  let mapX = Math.floor((x - constant.mapStart.x) / w)\r\n  let mapY = Math.floor((y - constant.mapStart.y) / w)\r\n  // console.log('mapX', mapX, ' mapY', mapY)\r\n  if ( (mapX < 0 || mapX > constant.mapSize.x) || (mapY < 0 || mapY > constant.mapSize.y) ) return\r\n  const floorType = map[mapY][mapX].type\r\n  status.me.resetFriction()\r\n  if (status.me.onPlatform() ){\r\n    status.me.setFriction(6)\r\n  } else if (floorType.includes('none') || floorType.includes('start') || floorType.includes('end') )\r\n    status.me.setFriction(1)\r\n  else if (floorType.includes('muddy'))\r\n    status.me.setFriction(5)\r\n  else if (floorType.includes('ice'))\r\n    status.me.setFriction(0.5)\r\n  else if (floorType.includes('dead')) \r\n    setStatus( () => ({...status, gameState: CONSTANT.GameOver,msg: Msg[\"dead\"], endTime: Date.now(), playTime:Date.now()-status.startTime })) \r\n\r\n  if (floorType.includes('end'))\r\n    setStatus( () => ({...status, gameState: CONSTANT.WIN, msg: Msg[\"end\"], endTime: Date.now(), playTime:Date.now()-status.startTime })) \r\n\r\n  status.me.updateLastLoc()\r\n}\r\n\r\n\r\n// check Live: Code from EditMode/Engine\r\nfunction checkEncounter(status, setting, setStatus) {\r\n  let {objects, map} = setting\r\n  let { me } = status\r\n  let onPlatform = false\r\n  let platformID, platformPos\r\n  let platformDistance = Math.MAX_SAFE_INTEGER\r\n  let beBlocked = false\r\n  let touchConveyor = 0\r\n  \r\n  for (let i = 0; i < objects.length; i++) {\r\n    if (objects[i].collision) {\r\n      const result = objects[i].collision({ type: 'sphere', pos: me.loc, r: CONSTANT.PlayerR });\r\n      if (result.includes('none')) continue\r\n      me.resetFriction()\r\n      // console.log('result', result)\r\n      if ( (result === 'block' || result === 'lockedWall' || result === 'cymbal' \r\n      || result === 'missileBase' || result === 'woodenBox') && !beBlocked ) {\r\n        if (result === 'woodenBox') objects[i].push(objects, map, me.pos);\r\n        beBlocked = true\r\n        me.returnLastLoc()\r\n        me.squareRebound(objects[i].pos)\r\n      }\r\n      // me.loc.length( objects[i].pos) < platformDistance: find the closest platform to transport\r\n      else if (result === 'platform' || result === 'movingPlatform' || result === 'brokenPlatform' \r\n                || me.loc.length( objects[i].pos) < platformDistance ) {\r\n        if (result === 'brokenPlatform') objects[i].break();\r\n        onPlatform = true\r\n        platformDistance =  me.loc.length( objects[i].pos)\r\n        platformID = i\r\n        platformPos = objects[i].pos\r\n        status.me.setFriction(3)\r\n      } else if (result === 'unlocker') objects[i].unlock(objects)\r\n      else if (result === 'portal') me.moveTo(objects[i].teleport(objects)) \r\n      else if (result === 'conveyor' && touchConveyor < 0.99 ) {\r\n        me.addVelocity(objects[i].detail.direction, 12)\r\n        touchConveyor++\r\n      } else if (result === 'missileRay') objects[i].fire(me);\r\n      else if (result === 'trap') me.setLastFriction()\r\n      else if (result === 'magneticField') \r\n      // me.pull(objects[i].getDisplacement().mul(1000)) BUG\r\n      me.loc = me.loc.add(objects[i].getDisplacement())\r\n      else if ( result === 'spike' || result === 'arrow' ||  result === 'cymbalWave' || result === 'missile' || result === 'deathTotem' ){\r\n        setStatus( () => ({...status, gameState: CONSTANT.GameOver, msg: Msg[result],endTime: Date.now(), playTime:Date.now()-status.startTime})) \r\n      }\r\n\r\n      // floor \r\n      if (result === 'mucus')\r\n        status.me.setFriction(10)\r\n      else if (result === 'ice')\r\n        status.me.setFriction(0.4)\r\n    }\r\n  }\r\n  // platForm logic\r\n  if (onPlatform && !beBlocked)\r\n    me.moveOnPlatform(platformID , platformPos)\r\n  if ( !onPlatform )\r\n    me.leavePlatform()\r\n}\r\n\r\n\r\n","// import ObjectClass from './object';\r\nimport Vec2 from '../../Class/Vec2';\r\nconst PUSH_FORCE = 800\r\nconst FRICTION = 0.09\r\nconst MAX_VELOCITY = 160\r\n\r\nexport default class Player {\r\n  constructor(id, username, x, y) {\r\n    this.id = id;\r\n    this.loc = new Vec2(x, y);\r\n    this.velocity = new Vec2(0, 0);\r\n    this.username = username;\r\n    this.score = 0;\r\n    this.pos = new Vec2(0, 0)\r\n\r\n    this.friction = FRICTION\r\n    this.lastFriction = 0\r\n    this.m = 1\r\n    this.force = new Vec2(0, 0)\r\n    this.acceleration = new Vec2(0, 0)\r\n    this.lastLoc = new Vec2(x, y)\r\n    this.lastPlatformID = \"-1\" \r\n    this.lastPlatformPos = new Vec2(0, 0)\r\n  }\r\n\r\n\r\n  update(dt) {\r\n    // ms to s\r\n    dt = dt / 1000\r\n    this.updateFAV(dt)\r\n    this.pos = this.loc\r\n    return null;\r\n  }\r\n\r\n  updateFAV(dt) {\r\n    // acceleration change  a = (F + f*v*v) / m\r\n    const v2 = this.velocity.unit().mul( Math.pow(this.velocity.length(),2))\r\n    this.acceleration = this.force.sub(v2.mul(this.friction)).div(this.m)\r\n\r\n    // velocity change\r\n    this.velocity = this.velocity.add(this.acceleration.mul(dt))\r\n    // somthing cause velocity exceed\r\n    this.checkVelocity()\r\n\r\n    // location change\r\n    this.loc = this.loc.add( this.velocity.mul(dt) )\r\n    this.force = new Vec2(0, 0)\r\n  }\r\n\r\n  checkVelocity() {\r\n    if (this.velocity.length() > MAX_VELOCITY)\r\n    this.velocity = this.velocity.unit().mul(MAX_VELOCITY)\r\n  }\r\n\r\n  moveTo(x, y) {\r\n    if (!y){\r\n      const newLoc = x\r\n      this.loc = newLoc\r\n    } else this.loc = new Vec2(x, y)\r\n  }\r\n\r\n  addVelocity(dir, vel) {\r\n    switch (dir) {\r\n      case 'down':\r\n        this.velocity = this.velocity.add(new Vec2(0, vel))\r\n        break\r\n      case 'right':\r\n        this.velocity = this.velocity.add(new Vec2(vel, 0))\r\n        break\r\n      case 'left':\r\n        this.velocity = this.velocity.add(new Vec2(-vel, 0))\r\n        break\r\n      case 'up':\r\n        this.velocity = this.velocity.add(new Vec2(0, -vel))\r\n        break\r\n    }\r\n  }\r\n\r\n  moveOnPlatform(id, platformPos) {\r\n    id = id.toString()\r\n    // meet a platform or change a platform\r\n    if(this.lastPlatformID === \"-1\" || this.lastPlatformID !== id ){\r\n      this.lastPlatformID = id\r\n      this.lastPlatformPos = platformPos\r\n    }\r\n    if(this.lastPlatformID === id){\r\n      this.loc = this.loc.add( platformPos.sub(this.lastPlatformPos) )\r\n      this.lastPlatformPos = platformPos\r\n    }\r\n  }\r\n\r\n  leavePlatform() {\r\n    this.lastPlatformID = \"-1\"\r\n  }\r\n\r\n  onPlatform() {\r\n    if (this.lastPlatformID === \"-1\")\r\n      return false\r\n    else return true\r\n  }\r\n\r\n  squareRebound(target) {\r\n    const vector = (new Vec2(this.loc.x - target.x, this.loc.y - target.y))\r\n    const Theta = Math.atan2(vector.y, vector.x)\r\n    // bound lower, left, upper, right in order\r\n    if (-3 / 4 * Math.PI < Theta && Theta < -1 / 4 * Math.PI)\r\n      this.rebound(new Vec2(this.loc.x, 9999))\r\n    else if (-1 / 4 * Math.PI < Theta && Theta < 1 / 4 * Math.PI)\r\n      this.rebound(new Vec2(0, this.loc.y))\r\n    else if (1 / 4 * Math.PI < Theta && Theta < 3 / 4 * Math.PI)\r\n      this.rebound(new Vec2(this.loc.x, 0))\r\n    else if (3 / 4 * Math.PI < Theta || (-3 / 4 * Math.PI > Theta && Theta < 0))\r\n      this.rebound(new Vec2(9999, this.loc.y))\r\n    else\r\n      console.log(\"why? no bound\")\r\n  }\r\n\r\n  /* reflect by this.velocity, but have bug */\r\n  // rebound(target) {\r\n  //   const normal = (new Vec2(this.loc.x - target.x, this.loc.y - target.y))\r\n  //   const reflectLineTheta = Math.atan2(normal.y, normal.x) + 0.5 * Math.PI\r\n  //   const newVelocityX = Math.cos(2 * reflectLineTheta) * this.velocity.x + Math.sin(2 * reflectLineTheta) * this.velocity.y\r\n  //   const newVelocityY = Math.sin(2 * reflectLineTheta) * this.velocity.x - Math.cos(2 * reflectLineTheta) * this.velocity.y\r\n  //   this.velocity = new Vec2(newVelocityX, newVelocityY).mul(4)\r\n  //   this.checkVelocity()\r\n  // }\r\n\r\n  rebound(target) {\r\n    const normal = new Vec2(this.loc.x - target.x, this.loc.y - target.y)\r\n    const reflectLineTheta = Math.atan2(normal.y, normal.x) + 0.5 * Math.PI\r\n    const vec = normal.mul(-1).unit()\r\n    const newVelocityX = Math.cos(2 * reflectLineTheta) * vec.x + Math.sin(2 * reflectLineTheta) * vec.y\r\n    const newVelocityY = Math.sin(2 * reflectLineTheta) * vec.x - Math.cos(2 * reflectLineTheta) * vec.y\r\n    this.velocity = new Vec2(newVelocityX, newVelocityY).mul(40)\r\n    this.checkVelocity()\r\n  }\r\n\r\n  returnLastLoc(dt) {\r\n    this.loc = this.lastLoc\r\n  }\r\n\r\n  setFriction(ratio) {\r\n    this.lastFriction = this.friction\r\n    this.friction = this.friction * ratio\r\n  }\r\n  setLastFriction() {\r\n    this.friction = this.lastFriction\r\n  }\r\n  resetFriction() {\r\n    this.lastFriction = this.friction\r\n    this.friction = FRICTION \r\n  }\r\n\r\n  updateLastLoc() {\r\n    this.lastLoc = this.loc\r\n  }\r\n  // manipulate by key: left, up, right, down \r\n  push(vec) {\r\n    this.force = vec.mul(PUSH_FORCE)\r\n  }\r\n\r\n  // pull(vec) {\r\n  //   console.log(vec)\r\n  //   this.force = this.force.add(vec)\r\n  // }\r\n\r\n  serializeForUpdate() {\r\n    return {\r\n      id: this.id,\r\n      loc: this.loc,\r\n      x: this.loc.x,\r\n      y: this.loc.y,\r\n      velocity: this.velocity\r\n    };\r\n  }\r\n}\r\n\r\n","import React, { useRef, useEffect, useState } from 'react';\r\nimport DrawMap from './Drawer';\r\nimport Engine from './Engine';\r\nimport Controller from './Controller';\r\nimport { initState, updateState } from './state'\r\nimport { getAsset, getAssetNames, downloadAssets } from './assets';\r\nimport { enpackage, unpackage } from \"../DataPackager\";\r\n\r\n\r\nimport {CONSTANT, Link} from './PlayModeConstant'\r\nimport Player from './Object/player'\r\n\r\nimport \"./PlayMode.css\"\r\n\r\n\r\nconst PlayMapCreater = (props) => {\r\n    // let { setting } = props\r\n    const [setting, setSetting] = useState(props.setting)\r\n    const [loading, setLoading] = useState(false);\r\n    useEffect( async () => {\r\n        downloadAssets().then( setLoading(true) )\r\n    })\r\n    // const { mapSize, map, objects } = setting\r\n    let canvasRef = useRef();\r\n    // const [head, setHead] = useState('seal.svg')\r\n    const defaultState = {\r\n        me: new Player(1, 'name', 0, 0),\r\n        startTime: Date.now(),\r\n        endTime: Date.now(),\r\n        playTime: 0,\r\n        gameState: 'start',\r\n        head: 'seal.svg',\r\n        msg: [\"Happy\"],\r\n        FOCUS_PLAYER: false,\r\n        pressDown: false,\r\n        pressRight: false,\r\n        pressLeft: false,\r\n        pressUp: false\r\n    }\r\n\r\n    const [status, setStatus] = useState(defaultState);\r\n\r\n\r\n    useEffect(() => {\r\n        if (\r\n            status.gameState === CONSTANT.GameOver ||\r\n            status.gameState === CONSTANT.WIN\r\n        ) {\r\n\r\n            props.challenge(\r\n                status.endTime - status.startTime,\r\n                status.gameState === CONSTANT.WIN\r\n            );\r\n\r\n            openForm(\"gameForm\")\r\n            setSetting( ()=> unpackage(enpackage(setting)) )\r\n        }\r\n    }, [status]);\r\n\r\n\r\n    function closeForm(form) {\r\n        document.getElementById(form).style.display = \"none\";\r\n        startPlay()\r\n    }\r\n\r\n    function startPlay(){\r\n        setStatus(() => ({ ...defaultState, head: status.head , gameState: CONSTANT.PLAYING, FOCUS_PLAYER: true }))\r\n    }\r\n\r\n    function openForm(form) {\r\n        document.getElementById(form).style.display = \"block\";\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (!loading) return\r\n\r\n        const canvas = canvasRef.current;\r\n        const ctx = canvas.getContext('2d');\r\n\r\n        let cancelController;\r\n        let requestId;      \r\n        cancelController = Controller(canvas, status, setStatus, setting);\r\n\r\n        initState(status, setting)\r\n\r\n        let fpsInterval, startTime, now, then, elapsed;\r\n\r\n        function update() {\r\n            requestId = requestAnimationFrame(update);\r\n            updateState(status, setting, setStatus)\r\n\r\n            now = Date.now();\r\n            elapsed = now - then;\r\n            if (elapsed > fpsInterval) {\r\n                then = now - (elapsed % fpsInterval);\r\n                Engine(setting.objects, setting.map, status);\r\n                DrawMap(ctx, setting, status);\r\n            }\r\n        };\r\n        // initialize the timer variables and start the animation\r\n        function startAnimating(fps) {\r\n            fpsInterval = 1000 / fps;\r\n            then = Date.now();\r\n            startTime = then;\r\n            update();\r\n        }\r\n        startAnimating(30)\r\n\r\n\r\n        if (status.gameState === CONSTANT.GameOver || status.gameState === 'start'){\r\n            cancelController()\r\n        }\r\n        if (status.gameState === 'start')\r\n            openForm(\"startForm\")\r\n\r\n        if ( !(status.gameState === 'start' || status.gameState === CONSTANT.PLAYING))\r\n            cancelAnimationFrame(requestId);\r\n\r\n        return () => {\r\n            cancelController();\r\n            cancelAnimationFrame(requestId);\r\n        };\r\n    }, [setStatus, status, setting, loading]);\r\n\r\n    function toTimeFormate(ms) {\r\n        return `${Math.floor(ms / 1000 / 60)\r\n            .toString()\r\n            .padStart(2, \"0\")} : ${Math.floor((ms / 1000) % 60)\r\n                .toString()\r\n                .padStart(2, \"0\")}`;\r\n    }\r\n\r\n    const getImg = async (assetName) => {\r\n        console.log( assetName)\r\n         const img = await getAsset(assetName)\r\n        return <img src={img.src}/>\r\n    }\r\n\r\n    \r\n      const githubButton = \r\n        <div><button className='githubButton' onClick={() => { window.open(Link.github, \"_blank\"); }}>\r\n            <img src={getAsset('star.svg').src} /> Star\r\n            </button></div>\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                <canvas ref={canvasRef} id='PlayModeCanvas'\r\n                    width={CONSTANT.CanvasWidth}\r\n                    height={CONSTANT.CanvasHeight}\r\n                ></canvas>\r\n            </div>\r\n            {/* Game Over form */}\r\n            <div className=\"form-popup\" id=\"gameForm\">\r\n                <span>{status.gameState}</span>\r\n                {status.msg.map( (m)=> (<p>{m}</p>) )}\r\n                <span>{toTimeFormate(status.playTime)}</span>\r\n                <button className='gameButton' onClick={() => { closeForm(\"gameForm\") }}>Try Again</button>\r\n                {githubButton}\r\n            </div>\r\n            {/* select player form */}\r\n            <div className=\"form-popup\" id=\"startForm\">\r\n                <span>Choose A Player</span>\r\n                <div onChange={ (e)=>{ status.head = e.target.value}}>\r\n                    { (loading) ?\r\n                    getAssetNames().map((assetName) => (\r\n                        <label>\r\n                            <input type=\"radio\" name=\"test\" value={assetName} />\r\n                            <img src={getAsset(assetName).src}/>\r\n                        </label>\r\n                    )) : <></>}\r\n                </div>\r\n                <button className='gameButton' onClick={ () =>{ closeForm(\"startForm\");} }>START</button>\r\n                {githubButton}\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport default PlayMapCreater;\r\n","import Vec2 from \"../../GameContainer/Class/Vec2\"\r\n\r\nexport default function Controller(scene, status, setStatus, setting) {\r\n\r\n\tconst KeyCode = {37:'left', 38:'up', 39:'right', 40:'down'}\r\n\r\n\tfunction onKeyDown(e) {\r\n\t\tswitch (KeyCode[e.keyCode]) {\r\n\t\t\tcase 'down':\r\n\t\t\t\tstatus.pressDown = true\r\n\t\t\t\tbreak\r\n\t\t\tcase 'right':\r\n\t\t\t\tstatus.pressRight = true\r\n\t\t\t\tbreak\r\n\t\t\tcase 'left':\r\n\t\t\t\tstatus.pressLeft = true\r\n\t\t\t\tbreak\r\n\t\t\tcase 'up':\r\n\t\t\t\tstatus.pressUp = true\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onKeyUp(e) {\r\n\t\tswitch (KeyCode[e.keyCode]) {\r\n\t\t\tcase 'down':\r\n\t\t\t\tstatus.pressDown = false\r\n\t\t\t\tbreak\r\n\t\t\tcase 'right':\r\n\t\t\t\tstatus.pressRight = false\r\n\t\t\t\tbreak\r\n\t\t\tcase 'left':\r\n\t\t\t\tstatus.pressLeft = false\r\n\t\t\t\tbreak\r\n\t\t\tcase 'up':\r\n\t\t\t\tstatus.pressUp = false\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t}\r\n\r\n\twindow.addEventListener('keydown', onKeyDown);\r\n\twindow.addEventListener('keyup', onKeyUp);\r\n\r\n\treturn () => {\r\n\t\twindow.removeEventListener('keydown', onKeyDown);\r\n\t\twindow.removeEventListener('keyup', onKeyUp);\r\n\t};\r\n};\r\n\r\n\r\n\r\n","import React from \"react\";\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { enpackage, unpackage, show } from \"../GameContainer/DataPackager\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport ErrorPage from \"./ErrorPage\";\r\nimport LoadingPage from \"./LoadingPage\";\r\nimport instance from \"./Api\";\r\n\r\nimport PlayMode from \"../GameContainer/PlayMode/PlayMapCreater\";\r\nimport init from \"../GameContainer/Setting/example_0\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport SettingsApplicationsIcon from \"@material-ui/icons/SettingsApplications\";\r\nimport FlagIcon from \"@material-ui/icons/Flag\";\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\nfunction checkLogin(props) {\r\n  if (props.location.state === undefined) return false;\r\n  else if (!props.location.state.login) return false;\r\n  return true;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  margin: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  extendedIcon: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n}));\r\n\r\nconst Play = (props) => {\r\n  const history = useHistory();\r\n  const classes = useStyles();\r\n  const [open, setOpen] = useState(false);\r\n  // for Snackbar Alert\r\n  const [msgOpen, setMsgOpen] = useState(false);\r\n  const [alertMsg, setAlertMsg] = useState(\"\");\r\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\r\n  const [idGetMap, setidGetMap] = useState(false);\r\n  const [setting, setSetting] = useState(\"\");\r\n  const [mapp, setMapp] = useState({});\r\n  // get data before render\r\n  const [isBusy, setBusy] = useState(true);\r\n\r\n  const { name, uuid, login, id, mode } = props.data;\r\n\r\n  const getMap = async () => {\r\n    const {\r\n      data: { success, errorCode, map },\r\n    } = await instance.post(\"/api/getMap\", {\r\n      id,\r\n    });\r\n    if (!success) {\r\n      setAlertMsg(`Error. Error code:${errorCode}`);\r\n      setAlertType(\"error\");\r\n      setMsgOpen(true);\r\n    } else {\r\n      setAlertMsg(`Load data success`);\r\n      setAlertType(\"success\");\r\n      setMsgOpen(true);\r\n      setSetting(map[\"content\"]);\r\n      setMapp(map);\r\n      setidGetMap(true);\r\n    }\r\n  };\r\n\r\n  // if (id !== 0 && idGetMap === false) {\r\n  //   getMap();\r\n  // }\r\n\r\n  const challengeSuccess = async (mapLocal) => {\r\n    const {\r\n      data: { success, errorCode },\r\n    } = await instance.post(\"/api/challengeSuccess\", {\r\n      mapLocal,\r\n    });\r\n    console.log(`challenge: ${success}`);\r\n    if (!success) {\r\n    } else {\r\n    }\r\n  };\r\n\r\n  const challenge = (time, pass) => {\r\n    if (mode !== \"challenge\") {\r\n      console.log(`practice no record`);\r\n      return;\r\n    }\r\n    console.log(`receive challenge ${time}`);\r\n    let mapLocal = { ...mapp };\r\n    mapLocal.statistic.playTime += 1;\r\n    // pass\r\n    if (pass) {\r\n      mapLocal.statistic.passTime += 1;\r\n      if (!mapLocal.passPeople.includes(name)) {\r\n        mapLocal.passPeople.push(name);\r\n      }\r\n    }\r\n    // new record\r\n    if (mapLocal.statistic.fastestPass > time / 1000.0 && pass) {\r\n      mapLocal.statistic.fastestPass = time / 1000.0;\r\n      mapLocal.statistic.fastestMan = name;\r\n    }\r\n    challengeSuccess(mapLocal);\r\n  };\r\n\r\n  useEffect(() => {\r\n    // console.log(`busy?${isBusy}`);\r\n    setBusy(true);\r\n    getMap();\r\n  }, []);\r\n\r\n  return (\r\n    <div style={{ textAlign: \"center\" }}>\r\n      <Snackbar\r\n        open={msgOpen}\r\n        autoHideDuration={500}\r\n        onClose={() => {\r\n          setMsgOpen(false);\r\n        }}\r\n      >\r\n        <Alert\r\n          onClose={() => {\r\n            setMsgOpen(false);\r\n          }}\r\n          severity={alertType}\r\n        >\r\n          {alertMsg}\r\n        </Alert>\r\n      </Snackbar>\r\n      <div style={{ marginTop: \"1em\" }}>\r\n        <IconButton\r\n          className={classes.margin}\r\n          size=\"large\"\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n          onClick={history.goBack}\r\n        >\r\n          <ArrowBackRoundedIcon />\r\n        </IconButton>\r\n        <IconButton\r\n          className={classes.margin}\r\n          size=\"large\"\r\n          variant=\"outlined\"\r\n          color=\"secondary\"\r\n        >\r\n          {mode === \"challenge\" ? <FlagIcon /> : <SettingsIcon />}\r\n          {mode === \"challenge\" ? \"Challenge Mode\" : \" Practice Mode\"}\r\n        </IconButton>\r\n      </div>\r\n      {setting === \"\" || msgOpen === true ? (\r\n        <LoadingPage />\r\n      ) : (\r\n        <PlayMode\r\n          width=\"1200px\"\r\n          height=\"600px\"\r\n          setting={unpackage(setting)}\r\n          challenge={challenge}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\nfunction Playmode(props) {\r\n  return (\r\n    <>\r\n      {checkLogin(props) ? <Play data={props.location.state} /> : <ErrorPage />}\r\n    </>\r\n  );\r\n}\r\nexport default Playmode;\r\n","import \"./App.css\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport Login from \"./Pages/Login\";\r\nimport {\r\n  NavLink,\r\n  Switch,\r\n  Route,\r\n  BrowserRouter,\r\n  HashRouter as Router,\r\n} from \"react-router-dom\";\r\nimport SelectPage from \"./Pages/SelectPage\";\r\nimport PopularMap from \"./Pages/PopularMap\";\r\nimport EditMode from \"./Pages/EditMode\";\r\nimport PlayMode from \"./Pages/PlayMode\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n      <Switch>\r\n        <Route exact path=\"/\" component={Login} />\r\n        <Route exact path=\"/users/selectPage\" component={SelectPage} />\r\n        <Route exact path=\"/PopularMap\" component={PopularMap} />\r\n        <Route exact path=\"/EditMode\" component={EditMode} />\r\n        <Route exact path=\"/PlayMode\" component={PlayMode} />\r\n      </Switch>\r\n    </BrowserRouter>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}