{"version":3,"sources":["reportWebVitals.js","Pages/Api.js","Pages/Login.js","GameContainer/Class/Vec2.js","GameContainer/Class/Layer.js","GameContainer/constant.js","GameContainer/Class/GameObject.js","GameContainer/DataPackager.js","Pages/LoadingPage.js","GameContainer/Drawer.js","GameContainer/Preview.js","GameContainer/Setting/example_0.js","Pages/UserPage.js","Pages/ErrorPage.js","Pages/SelectPage.js","Pages/PageComponent/Orders.js","Pages/PopularMap.js","GameContainer/EditMode/Drawer.js","GameContainer/EditMode/Main.js","GameContainer/EditMode/Controller.js","GameContainer/EditMode/Engine.js","Pages/EditMode.js","GameContainer/PlayMode/PlayModeConstant.js","assets/seal.svg","assets/lion.svg","assets/cat.svg","assets/star.svg","GameContainer/PlayMode/assets.js","GameContainer/PlayMode/Drawer.js","GameContainer/PlayMode/Engine.js","GameContainer/PlayMode/state.js","GameContainer/PlayMode/Object/player.js","GameContainer/PlayMode/PlayMapCreater.js","GameContainer/PlayMode/Controller.js","Pages/PlayMode.js","index.js"],"names":["reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","instance","axios","create","baseURL","Alert","props","elevation","variant","useStyles","makeStyles","input","margin","button","width","marginLeft","Body","history","useHistory","classes","useState","name","setName","pwd","setPwd","name_","setName_","pwd_","setPwd_","pwd_repeat","setPwd_repeat","open","setOpen","show","setShow","msgOpen","setMsgOpen","alertMsg","setAlertMsg","alertType","setAlertType","handleChange","func","event","target","value","trim","handleLogin","a","post","data","success","uuid","mapIDs","push","pathname","search","state","login","handleSignUp","msg","className","Snackbar","autoHideDuration","onClose","severity","TextField","placeholder","onChange","style","type","Button","color","disabled","onClick","FormControlLabel","control","Switch","checked","label","Modal","Vec2","x","y","this","v","c","Math","sqrt","length","div","dot","PI","atan","v1","v2","min","max","w","dir","up","down","left","right","add","unit","Layer","status","fill","targets","i","that","isOverlap","maxLayer","constant","mapStart","mapSize","gridWidth","blockColor","startColor","endColor","noneColor","deadColor","iceColor","muddyColor","boundaryColor","auxiliaryColor","typeLayerPairs","editObjectList","platform","covering","obstacle","special","editFrame","default","fColor","sColor","uuidv4","require","isCollision","obj1","obj2","pos","sub","r","sObj","cObj","between","size","mul","pointList","map","p","abs","colorList","spikedBlock","id","gridPos","toGrid","detail","upSpike","downSpike","leftSpike","rightSpike","loadable","perspective","layer","cloneObject","unpackage","enpackage","objectSetting","ctx","save","translate","globalAlpha","beginPath","moveTo","lineTo","fillStyle","strokeStyle","stroke","closePath","rect","restore","objects","equal","top","loadObject","object","arcTo","movingPlatform","direction","distance","speed","lastRecord","Date","now","active","options","parameters","dirVec","originPos","rotate","relativePos","bow","RoF","lastFire","lifeCycle","slow","normal","fast","result","arrow","drawPoint","tempArrow","draw","arc","collision","teleport","getDisplacement","scale","mucus","clone","grd","createLinearGradient","addColorStop","cymbal","range","cymbalWave","pivot","createRadialGradient","lineWidth","small","large","pow","ice","conveyor","clip","portal","index","cooldown","lastClose","cooldownTime","cooldownCycle","usedIndex","j","trapPlatform","duration","lastChange","openCycle","short","long","missileBase","unfoldTime","unfoldCycle","rotateSpeed","rotateCycle","find","findTarget","lastFind","findCycle","findTime","missile","radian","minRadian","maxRadian","random","lockedWall","locked","horizontal","vertical","unlocker","used","block","movingPlatform_oblique","movingPlatform_rect","clock","height","start","totalDist","cycleList","clockwise","moveCycle","woodenBox","moveTime","moveRate","break","targetPos","magnet","magneticField","textAlign","textBaseline","font","fillText","setLineDash","brokenPlatform","stage","count","stageCount","deathTotem","grd2","setting","levelSetting","types","place","LoadingPage","clear","canvas","clearRect","drawMap","playMode","relation","pos1","pos2","includes","drawPlayKey","drawStopKey","drawTrashCan","Preview","canvasRef","useRef","useEffect","current","getContext","api","ref","example_0","ColorButton","withStyles","theme","root","palette","getContrastText","pink","backgroundColor","icon","marginRight","spacing","heroContent","background","paper","padding","heroButtons","marginTop","cardGrid","paddingTop","paddingBottom","card","display","flexDirection","cardMedia","cardContent","flexGrow","footer","Album","setMapIDs","allMaps","setAllMaps","deleteID","setDeleteID","openDialog","setOpenDialog","isBusy","setBusy","DeleteSingleMap","errorCode","getMapIDs","getAllMaps","console","log","maps","handlerStatistic","key","undefined","statistic","fastestPass","fastestMan","passTime","playTime","Fragment","CssBaseline","AppBar","position","Toolbar","Typography","noWrap","Container","maxWidth","component","align","gutterBottom","paragraph","Grid","container","justify","item","title","description","Dialog","aria-labelledby","aria-describedby","DialogContent","DialogContentText","DialogActions","autoFocus","ele","xs","sm","md","Card","content","initSetting","CardContent","CardActions","mode","publish","Tooltip","IconButton","ErrorPage","checkLogin","location","UserPage0","seeMore","Orders","info","rateID","setRateID","rate","rateMap","val","computeScore","arr","totalScore","totalPeople","forEach","transform","msTransform","Rating","newValue","Table","TableHead","TableRow","TableCell","TableBody","author","rateRec","toFixed","CssTextField","borderBottomColor","borderColor","opacity","toolbar","paddingRight","toolbarIcon","alignItems","justifyContent","mixins","appBar","zIndex","drawer","transition","transitions","easing","sharp","leavingScreen","appBarShift","enteringScreen","menuButton","menuButtonHidden","drawerPaper","whiteSpace","drawerPaperClose","overflowX","breakpoints","appBarSpacer","overflow","fixedHeight","PopularMap","newestMaps","setNewestMaps","setSearch","getAllMapsByOrder","clsx","edge","aria-label","e","filter","toLowerCase","handlerSearch","Drawer","Divider","List","ListItem","array","randomIndex","currentIndex","floor","shuffle","ListItemIcon","ListItemText","primary","sort","b","reverse","goBack","Paper","Box","pt","select","luPos","leftUp","selectPair","rightDown","editObjectSpace","objectList","opt","o","GameObject","strokeText","o1","o2","holdObject","holding","hold","message","text","messageCycle","lastPost","EtC","counterclockwise","attraction","repulsion","formControl","minWidth","selectEmpty","EditGameMode","forwardRef","selecting","holdDetail","setStatus","reset","useImperativeHandle","returnSetting","cancelController","requestId","scene","mapEnd","copyable","ctrlKey","mouseMoveHandler","mousePos","offsetX","offsetY","selectGridPos","mouseDownHandler","topLayer","remove","splice","newStatus","detailFunction","objectIndex","setPerspective","mouseUpHandler","stopContextMenu","preventDefault","addEventListener","removeEventListener","Controller","update","Engine","requestAnimationFrame","cancelAnimationFrame","charset","pair","newType","oldTypes","hasStart","hasEnd","shift","changeSelectedGridsType","Object","keys","float","newDetail","FormControl","InputLabel","Select","MenuItem","Slider","valueLabelDisplay","step","marks","Checkbox","extendedIcon","Edit","setTitle","setDescription","init","setSetting","idGetMap","setidGetMap","setPublish","delayUpload","setDelayUpload","setId","childRef","handleUpload","settingPack","id0","idNew","getMap","entries","rows","defaultValue","multiline","Editmode","CONSTANT","h","Msg","spike","dead","end","Link","ASSET_NAMES","mapName2Path","SealIcon","LionIcon","CatIcon","StarIcon","assets","downloadPromise","Promise","all","image","Image","imageSrc","endsWith","get","resp","doc","DOMParser","parseFromString","svgElem","getElementsByTagName","setAttribute","b64Svg","btoa","XMLSerializer","serializeToString","resolve","onload","src","getAsset","assetName","focusPlayer","context","me","FOCUS_PLAYER","focusX","focusY","drawPlayer","player","head","drawImage","serializeForUpdate","fillRect","inView","ObjPos","blockArea","updateState","dt","lastUpdateTime","LeftBound","RightBound","UpperBound","LowerBound","returnLastLoc","rebound","some","squareRebound","mapX","mapY","floorType","resetFriction","onPlatform","setFriction","gameState","endTime","startTime","updateLastLoc","checkLocation","platformID","platformPos","platformDistance","MAX_SAFE_INTEGER","beBlocked","touchConveyor","loc","unlock","addVelocity","fire","setLastFriction","moveOnPlatform","leavePlatform","checkEncounter","pressDown","pressRight","pressLeft","pressUp","pushX","pushY","Player","username","velocity","score","friction","lastFriction","m","force","acceleration","lastLoc","lastPlatformID","lastPlatformPos","updateFAV","checkVelocity","newLoc","vel","toString","vector","Theta","atan2","reflectLineTheta","vec","newVelocityX","cos","sin","newVelocityY","ratio","PlayMapCreater","loading","setLoading","defaultState","closeForm","form","document","getElementById","openForm","challenge","fpsInterval","elapsed","KeyCode","37","38","39","40","onKeyDown","keyCode","onKeyUp","window","startArea","line","square","initState","needEngin","DrawMap","ms","githubButton","padStart","Play","mapp","setMapp","challengeSuccess","mapLocal","time","pass","passPeople","Playmode","ReactDOM","render","StrictMode","basename","process","exact","path","Login","SelectPage","EditMode","PlayMode"],"mappings":"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M,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,OACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,QACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,UACR,CAAC,CAAEA,KAAM,SACT,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,SACR,CAAEA,KAAM,WACZkH,QAAS,IC3db,SAASnL,GAAMC,GACb,OAAO,cAAC,IAAD,aAAUC,UAAW,EAAGC,QAAQ,UAAaF,IAGtD,IAAMiU,GAAcC,cAAW,SAACC,GAAD,MAAY,CACzCC,KAAM,CACJlQ,MAAOiQ,EAAME,QAAQC,gBAAgBC,KAAK,MAC1CC,gBAAiBD,KAAK,KACtB,UAAW,CACTC,gBAAiBD,KAAK,UALRL,CAQhBjQ,KAeJ,IAAM9D,GAAYC,aAAW,SAAC+T,GAAD,MAAY,CACvCM,KAAM,CACJC,YAAaP,EAAMQ,QAAQ,IAE7BC,YAAa,CACXJ,gBAAiBL,EAAME,QAAQQ,WAAWC,MAC1CC,QAASZ,EAAMQ,QAAQ,EAAG,EAAG,IAE/BK,YAAa,CACXC,UAAWd,EAAMQ,QAAQ,IAE3BO,SAAU,CACRC,WAAYhB,EAAMQ,QAAQ,GAC1BS,cAAejB,EAAMQ,QAAQ,IAE/BU,KAAM,CACJtE,OAAQ,OACRuE,QAAS,OACTC,cAAe,UAEjBC,UAAW,CACTL,WAAY,UAEdM,YAAa,CACXC,SAAU,GAEZC,OAAQ,CACNnB,gBAAiBL,EAAME,QAAQQ,WAAWC,MAC1CC,QAASZ,EAAMQ,QAAQ,QAIZ,SAASiB,GAAM5V,GAC5B,IAAMa,EAAUV,KACVQ,EAAUC,cAChB,EAAuBZ,EAAM4C,KAArBE,EAAR,EAAQA,KAAM/B,EAAd,EAAcA,KACd,EAA4BD,mBAASd,EAAM4C,KAAKG,QAAhD,mBAAOA,EAAP,KAAe8S,EAAf,KAGA,EAA8B/U,oBAAS,GAAvC,mBAAOe,EAAP,KAAgBC,EAAhB,KACA,EAAgChB,mBAAS,IAAzC,mBAAOiB,EAAP,KAAiBC,EAAjB,KACA,EAAkClB,mBAAS,WAA3C,mBAAOmB,EAAP,KAAkBC,EAAlB,KACA,EAA8BpB,mBAAS,IAAvC,mBAAOgV,EAAP,KAAgBC,EAAhB,KAEA,EAAgCjV,mBAAS,IAAzC,mBAAOkV,EAAP,KAAiBC,EAAjB,KACA,EAAoCnV,oBAAS,GAA7C,mBAAOoV,EAAP,KAAmBC,EAAnB,KAEA,EAA0BrV,oBAAS,GAAnC,mBAAOsV,EAAP,KAAeC,EAAf,KAEMC,EAAe,uCAAG,WAAOhN,GAAP,mBAAA5G,EAAA,sEAGZ/C,EAASgD,KAAK,uBAAwB,CAC9C2G,KACAxG,SALoB,oBAEpBF,KAAQC,EAFY,EAEZA,QAFY,EAEH0T,UAKd1T,GAKHb,EAAY,kBACZE,EAAa,WACbJ,GAAW,GACX0U,MAPAxU,EAAY,eACZE,EAAa,SACbJ,GAAW,IAVS,2CAAH,sDA2Bf2U,EAAU,uCAAG,WAAO1T,GAAP,qBAAAL,EAAA,6DACjBgU,QAAQC,IAAR,cADiB,SAIPhX,EAASgD,KAAK,kBAAmB,CACzCI,WALe,oBAGfH,KAAQC,EAHO,EAGPA,QAHO,EAGE0T,UAAWK,EAHb,EAGaA,KAIzB/T,EAIHkT,EAAWa,GAHXF,QAAQC,IAAR,QARe,2CAAH,sDAeVH,EAAS,uCAAG,kCAAA9T,EAAA,sEAIN/C,EAASgD,KAAK,mBAAoB,CAC1CG,SALc,oBAGdF,KAAQC,EAHM,EAGNA,QAASE,EAHH,EAGGA,OAIdF,GAGH6T,QAAQC,IAAI5T,GACZ8S,EAAU9S,GACV0T,EAAW1T,IAJX2T,QAAQC,IAAR,kBAMFN,GAAQ,GAdQ,2CAAH,qDAiBTQ,EAAmB,SAACC,GACxB,QAAqBC,IAAjBjB,EAAQgB,GACV,MAAM,MAEN,MACEhB,EAAQgB,GAAKE,UADPC,EAAR,EAAQA,YAAaC,EAArB,EAAqBA,WAAYC,EAAjC,EAAiCA,SAAUC,EAA3C,EAA2CA,SAG3C,MAAM,eAAN,OAAsBH,EAAtB,wBAAiDC,EAAjD,sBAAyEC,EAAzE,sBAA+FC,IAWnG,OAPAzD,qBAAU,WACR+C,QAAQC,IAAR,eAAoBP,IACpBC,GAAQ,GACRG,MACC,IAID,eAAC,IAAMa,SAAP,WACE,cAACC,GAAA,EAAD,IACA,cAACC,GAAA,EAAD,CAAQC,SAAS,WAAjB,SACE,eAACC,GAAA,EAAD,WACE,cAAC,KAAD,CAAmBlU,UAAW1C,EAAQ4T,OACtC,cAACiD,GAAA,EAAD,CAAYxX,QAAQ,KAAKgE,MAAM,UAAUyT,QAAM,EAA/C,8BAKJ,iCACE,cAACnU,EAAA,EAAD,CACE/B,KAAMI,EACN4B,iBAAkB,IAClBC,QAAS,WACP5B,GAAW,IAJf,SAOE,cAAC,GAAD,CACE4B,QAAS,WACP5B,GAAW,IAEb6B,SAAU1B,EAJZ,SAMGF,MAGL,qBAAKwB,UAAW1C,EAAQ+T,YAAxB,SACE,eAACgD,GAAA,EAAD,CAAWC,SAAS,KAApB,UACE,eAACH,GAAA,EAAD,CACEI,UAAU,KACV5X,QAAQ,KACR6X,MAAM,SACN7T,MAAM,cACN8T,cAAY,EALd,gBAOMjX,KAEN,cAAC2W,GAAA,EAAD,CACExX,QAAQ,KACR6X,MAAM,SACN7T,MAAM,gBACN+T,WAAS,EAJX,sIAQA,qBAAK1U,UAAW1C,EAAQmU,YAAxB,SACE,eAACkD,GAAA,EAAD,CAAMC,WAAS,EAACxD,QAAS,EAAGyD,QAAQ,SAApC,UACE,cAACF,GAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAACpU,EAAA,EAAD,CACE/D,QAAQ,YACRgE,MAAM,YACNE,QAAS,WACPzD,EAAQqC,KAAR,MAJJ,4BAUF,cAACkV,GAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAACpU,EAAA,EAAD,CACE/D,QAAQ,YACRgE,MAAM,UACNE,QAAS,WACPzD,EAAQqC,KAAK,CACXC,SAAS,cACTE,MAAO,CAAEL,KAAMA,EAAM/B,KAAMA,EAAMqC,OAAO,MAN9C,gEAaF,cAAC8U,GAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAACpU,EAAA,EAAD,CACEC,MAAM,YACNhE,QAAQ,WACRkE,QAAS,WACPzD,EAAQqC,KAAK,CACXC,SAAS,YACTE,MAAO,CACLL,KAAMA,EACN/B,KAAMA,EACNqC,OAAO,EACPkG,GAAI,EACJgP,MAAO,GACPC,YAAa,OAZrB,kCAoBF,cAACL,GAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAACpU,EAAA,EAAD,CACEC,MAAM,UACNhE,QAAQ,WACRkE,QAASoS,EAHX,kDAYV,eAACgC,GAAA,EAAD,CACE/W,KAAMyU,EACNxS,QAAS,WACPyS,GAAc,IAEhBsC,kBAAgB,qBAChBC,mBAAiB,2BANnB,UAQE,cAACC,GAAA,EAAD,UACE,cAACC,GAAA,EAAD,CAAmBtP,GAAG,2BAAtB,kFAIF,eAACuP,GAAA,EAAD,WACE,cAAC5U,EAAA,EAAD,CACEG,QAAS,WACP+R,GAAc,IAEhBjS,MAAM,UAJR,0BAQA,cAACD,EAAA,EAAD,CAAQG,QA7Lc,WAC9BkS,EAAgBN,GAChBG,GAAc,IA2LoCjS,MAAM,UAAU4U,WAAS,EAAnE,gCAKH1C,EACC,cAACzD,GAAD,IAEA,cAACiF,GAAA,EAAD,CAAWrU,UAAW1C,EAAQqU,SAAU2C,SAAS,KAAjD,SAEE,cAACK,GAAA,EAAD,CAAMC,WAAS,EAACxD,QAAS,EAAzB,SACG5R,EAAOkG,KAAI,SAAC8P,EAAKjC,GAAN,OACV,cAACoB,GAAA,EAAD,CAAMG,MAAI,EAAWW,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAxC,SACE,eAACC,GAAA,EAAD,CAAM5V,UAAW1C,EAAQwU,KAAzB,UAME,cAAC,GAAD,CACE9C,QAASrI,GACP4L,EAAQgB,GAAOhB,EAAQgB,GAAKsC,QAAUC,MAG1C,eAACC,GAAA,EAAD,CAAa/V,UAAW1C,EAAQ4U,YAAhC,UACE,cAACiC,GAAA,EAAD,CAAYM,cAAY,EAAC9X,QAAQ,KAAK4X,UAAU,KAAhD,SAEGhC,EAAQgB,GAAOhB,EAAQgB,GAAKwB,MAAQ,KAEvC,cAACZ,GAAA,EAAD,UACG5B,EAAQgB,GAAOhB,EAAQgB,GAAKyB,YAAc,QAG/C,eAACgB,GAAA,EAAD,WACE,cAACtV,EAAA,EAAD,CACE6E,KAAK,QACL5E,MAAM,UACNC,cAA2B4S,IAAjBjB,EAAQgB,GAClB1S,QAAS,WACPzD,EAAQqC,KAAK,CACXC,SAAS,YACTE,MAAO,CACLL,KAAMA,EACN/B,KAAMA,EACNqC,OAAO,EACPkG,GAAIyP,EACJS,KAAM,WAZd,kBAmBA,cAACvV,EAAA,EAAD,CACE6E,KAAK,QACL5E,MAAM,UACNC,cACmB4S,IAAjBjB,EAAQgB,SACUC,IAAjBjB,EAAQgB,IAAsBhB,EAAQgB,GAAK2C,QAE9CrV,QAAS,WACPzD,EAAQqC,KAAK,CACXC,SAAS,YACTE,MAAO,CACLL,KAAMA,EACN/B,KAAMA,EACNqC,OAAO,EACPkG,GAAIyP,EACJT,MAAOxC,EAAQgB,GAAOhB,EAAQgB,GAAKwB,MAAQ,GAC3CC,YAAazC,EAAQgB,GACjBhB,EAAQgB,GAAKyB,YACb,OAlBZ,uBAyBkBxB,IAAjBjB,EAAQgB,GACP,oCACEhB,EAAQgB,GAAK2C,QACf,cAACC,GAAA,EAAD,CAASpB,MAAOzB,EAAiBC,GAAjC,SACE,cAAC7S,EAAA,EAAD,CAAQ6E,KAAK,QAAQ5E,MAAM,UAAUhE,QAAQ,OAA7C,yBAKF,mCACE,cAAC+T,GAAD,CACEnL,KAAK,QACL5E,MAAM,UACNhE,QAAQ,YAHV,uBASJ,cAACyZ,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,YACNE,QAAS,WA9R7B6R,EA+R6C8C,GA9R7C5C,GAAc,IAwRI,SASE,cAAC,KAAD,aA9FQ4C,aAyG1B,wBAAQxV,UAAW1C,EAAQ8U,YCvblB,SAASiE,GAAU5Z,GAChC,OACE,mCACE,+CCAN,SAAS6Z,GAAW7Z,GAClB,YAA6B+W,IAAzB/W,EAAM8Z,SAAS3W,SACTnD,EAAM8Z,SAAS3W,MAAMC,MAelB2W,OAXf,SAAmB/Z,GACjB,OACE,mCACG6Z,GAAW7Z,GACV,cAAC,GAAD,CAAU4C,KAAM5C,EAAM8Z,SAAS3W,QAE/B,cAACyW,GAAD,O,gWCQR,SAAS7Z,GAAMC,GACb,OAAO,cAAC,IAAD,aAAUC,UAAW,EAAGC,QAAQ,UAAaF,IAGtD,IAAMiU,GAAcC,cAAW,SAACC,GAAD,MAAY,CACzCC,KAAM,CACJlQ,MAAO,UAEP,UAAW,CACTsQ,gBAAiB,eALHN,CAQhByF,MAEExZ,GAAYC,aAAW,SAAC+T,GAAD,MAAY,CACvC6F,QAAS,CACP/E,UAAWd,EAAMQ,QAAQ,QAMd,SAASsF,GAAOja,GAC7B,IAAMW,EAAUC,cACVC,EAAUV,KAChB,EAA8BH,EAAMka,KAA5BnZ,EAAR,EAAQA,KAAM+B,EAAd,EAAcA,KACd,GADA,EAAoBM,MACItC,oBAAS,IAAjC,mBAAOW,EAAP,KAAaC,EAAb,KAEA,EAA4BZ,mBAAS,IAArC,mBAAOqZ,EAAP,KAAeC,EAAf,KACA,EAAwBtZ,mBAAS,GAAjC,mBAAOuZ,EAAP,KAEA,GAFA,KAE8BvZ,oBAAS,IAAvC,mBAAOe,EAAP,KAAgBC,EAAhB,KACA,EAAgChB,mBAAS,IAAzC,mBAAOiB,EAAP,KAAiBC,EAAjB,KACA,EAAkClB,mBAAS,WAA3C,mBAAOmB,EAAP,KAAkBC,EAAlB,KAEMoY,EAAO,uCAAG,WAAOC,GAAP,qBAAA7X,EAAA,6DACdgU,QAAQC,IAAR,gBAAqB4D,IADP,SAIJ5a,EAASgD,KAAK,eAAgB,CACtCwX,SACAI,MACAxZ,SAPY,oBAGZ6B,KAAQC,EAHI,EAGJA,QAAS0T,EAHL,EAGKA,UAMd1T,GAeHb,EAAY,gBACZE,EAAa,WACbJ,GAAW,IAhBO,IAAdyU,GACFvU,EAAY,wCACZE,EAAa,SACbJ,GAAW,IACY,IAAdyU,GACTvU,EAAY,4DACZE,EAAa,QACbJ,GAAW,KAEXE,EAAY,iBAAD,OAAkBuU,IAC7BrU,EAAa,SACbJ,GAAW,IArBD,2CAAH,sDA8BP0Y,EAAe,SAACC,GACpB,IAAIC,EAAa,EACbC,EAAc,EAMlB,OALAF,EAAIG,SAAQ,SAAC7B,GACX2B,GAAc3B,EAAIsB,KAElBM,GAAe,KAEV,CACLD,EACAC,EACgB,IAAhBA,EAAoB,EAAID,EAAaC,IAIzC,OACE,eAAC,IAAMtD,SAAP,WACE,cAAC7T,EAAA,EAAD,CACE/B,KAAMI,EACN4B,iBAAkB,IAClBC,QAAS,WACP5B,GAAW,IAJf,SAOE,cAAC,GAAD,CACE4B,QAAS,WACP5B,GAAW,IAEb6B,SAAU1B,EAJZ,SAMGF,MAGL,cAAC2C,EAAA,EAAD,CACEjD,KAAMA,EACNiC,QAAS,WACPhC,GAAQ,IAHZ,SAME,qBACEqC,MAAO,CACLyQ,gBAAiB,QACjBgD,SAAU,WACVlX,OAAQ,IACR8K,IAAK,MACLpF,KAAM,MACNxF,MAAO,MACPuQ,OAAQ,MAER8J,UAAW,oBAVf,SAeE,sBACE9W,MAAO,CACLkR,UAAW,MACX7J,IAAK,MACLpF,KAAM,MACNwR,SAAU,WACVqD,UAAW,uBACXC,YAAa,wBAPjB,UAUE,cAACpD,GAAA,EAAD,CAAYI,UAAU,SAAtB,kBACA,cAACiD,GAAA,EAAD,CACEha,KAAK,oBACLwB,MAAO8X,EACPvW,SAAU,SAACzB,EAAO2Y,GAChBV,EAAQU,GACRtZ,GAAQ,aAOlB,eAACuZ,GAAA,EAAD,CAAOnS,KAAK,QAAZ,UACE,cAACoS,GAAA,EAAD,UACE,eAACC,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,IACA,cAACA,GAAA,EAAD,qBACA,cAACA,GAAA,EAAD,oBACA,cAACA,GAAA,EAAD,0BACA,cAACA,GAAA,EAAD,8BACA,cAACA,GAAA,EAAD,+BACA,cAACA,GAAA,EAAD,sBACA,cAACA,GAAA,EAAD,CAAWrD,MAAM,QAAjB,2BACA,cAACqD,GAAA,EAAD,SAGJ,cAACC,GAAA,EAAD,UACGrb,EAAM4C,KAAKqG,KAAI,SAACA,GAAD,OACd,eAACkS,GAAA,EAAD,WACE,cAACxB,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,YACNE,QAAS,WACPzD,EAAQqC,KAAK,CACXC,SAAS,YACTE,MAAO,CACLL,KAAMA,EACN/B,KAAMA,EACNqC,OAAO,EACPkG,GAAIL,EAAIK,GACRkQ,KAAM,gBAbd,SAkBE,cAAC,KAAD,MAEF,cAAC4B,GAAA,EAAD,UAAYnS,EAAIqS,SAChB,cAACF,GAAA,EAAD,UAAYnS,EAAIqP,QAChB,cAAC8C,GAAA,EAAD,UAAYnS,EAAIsP,cAChB,cAAC6C,GAAA,EAAD,UAAYnS,EAAI+N,UAAUI,WAC1B,cAACgE,GAAA,EAAD,UAAYnS,EAAI+N,UAAUG,WAC1B,cAACiE,GAAA,EAAD,UACiC,QAA9BnS,EAAI+N,UAAUC,YACX,IACAhO,EAAI+N,UAAUC,cAEpB,cAACmE,GAAA,EAAD,CAAWrD,MAAM,QAAjB,SACgC,SAA7B9O,EAAI+N,UAAUE,WACX,IACAjO,EAAI+N,UAAUE,aAlCtB,UAqCMsD,EAAavR,EAAIsS,SAAS,GAAGC,QAAQ,GArC3C,YAsCIhB,EAAavR,EAAIsS,SAAS,GAtC9B,KAwCE,cAAC,GAAD,CACEhY,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,UACNE,QAAS,WACPgW,EAAUnR,EAAIK,IACd5H,GAAQ,IAPZ,SAUE,cAAC,KAAD,oBChMhB,IAAM+Z,GAAevH,aAAW,CAC9BE,KAAM,CACJ,sBAAuB,CACrBlQ,MAAO,SAET,8BAA+B,CAC7BwX,kBAAmB,SAErB,2BAA4B,CAC1B,aAAc,CACZC,YAAa,MACbnH,gBAAiB,aAEnB,mBAAoB,CAClBmH,YAAa,UAEf,yBAA0B,CACxBA,YAAa,QACbnH,gBAAiB,QACjBoH,QAAS,UAnBI1H,CAuBlBtQ,KAeH,IAEMzD,GAAYC,aAAW,SAAC+T,GAAD,MAAY,CACvCC,KAAM,CACJkB,QAAS,QAEXuG,QAAS,CACPC,aAAc,IAEhBC,YAAY,aACVzG,QAAS,OACT0G,WAAY,SACZC,eAAgB,WAChBlH,QAAS,SACNZ,EAAM+H,OAAOL,SAElBM,OAAQ,CACNC,OAAQjI,EAAMiI,OAAOC,OAAS,EAC9BC,WAAYnI,EAAMoI,YAAY1c,OAAO,CAAC,QAAS,UAAW,CACxD2c,OAAQrI,EAAMoI,YAAYC,OAAOC,MACjCxN,SAAUkF,EAAMoI,YAAYtN,SAASyN,iBAGzCC,YAAa,CACXlc,WAxBgB,IAyBhBD,MAAM,eAAD,OAzBW,IAyBX,OACL8b,WAAYnI,EAAMoI,YAAY1c,OAAO,CAAC,QAAS,UAAW,CACxD2c,OAAQrI,EAAMoI,YAAYC,OAAOC,MACjCxN,SAAUkF,EAAMoI,YAAYtN,SAAS2N,kBAGzCC,WAAY,CACVnI,YAAa,IAEfoI,iBAAkB,CAChBxH,QAAS,QAEXgD,MAAO,CACL5C,SAAU,GAEZqH,YAAa,CACXvF,SAAU,WACVwF,WAAY,SACZxc,MA3CgB,IA4ChB8b,WAAYnI,EAAMoI,YAAY1c,OAAO,QAAS,CAC5C2c,OAAQrI,EAAMoI,YAAYC,OAAOC,MACjCxN,SAAUkF,EAAMoI,YAAYtN,SAAS2N,kBAGzCK,iBAAiB,cACfC,UAAW,SACXZ,WAAYnI,EAAMoI,YAAY1c,OAAO,QAAS,CAC5C2c,OAAQrI,EAAMoI,YAAYC,OAAOC,MACjCxN,SAAUkF,EAAMoI,YAAYtN,SAASyN,gBAEvClc,MAAO2T,EAAMQ,QAAQ,IACpBR,EAAMgJ,YAAYrX,GAAG,MAAQ,CAC5BtF,MAAO2T,EAAMQ,QAAQ,KAGzByI,aAAcjJ,EAAM+H,OAAOL,QAC3BzC,QAAS,CACP1D,SAAU,EACV3E,OAAQ,QACRsM,SAAU,QAEZlF,UAAW,CACThD,WAAYhB,EAAMQ,QAAQ,GAC1BS,cAAejB,EAAMQ,QAAQ,IAE/BG,MAAO,CACLC,QAASZ,EAAMQ,QAAQ,GACvBW,QAAS,OACT+H,SAAU,OACV9H,cAAe,UAEjB+H,YAAa,CACXvM,OAAQ,SAIZ,SAASwM,GAAWvd,GAClB,IAAMW,EAAUC,cACVC,EAAUV,KAChB,EAA8BH,EAAM4C,KACpC,GADA,EAAQ7B,KAAR,EAAc+B,KAAd,EAAoBM,MACItC,oBAAS,IAAjC,mBAAOW,EAAP,KAAaC,EAAb,KACA,EAAoCZ,mBAAS,IAA7C,mBAAO0c,EAAP,KAAmBC,EAAnB,KACA,EAA8B3c,mBAAS,IAAvC,mBAAOgV,EAAP,KAAgBC,EAAhB,KACA,EAA0BjV,oBAAS,GAAnC,mBAAeuV,GAAf,WACA,EAA4BvV,mBAAS,IAArC,mBAAOoC,EAAP,KAAewa,EAAf,KAEA/J,qBAAU,WACR0C,GAAQ,GACe,uCAAG,kCAAA3T,EAAA,sEAGd/C,EAASgD,KAAK,yBAA0B,IAH1B,oBAEtBC,KAAQC,EAFc,EAEdA,QAAS+T,EAFK,EAELA,KAFK,EAECL,UAEpB1T,IAGH6T,QAAQC,IAAR,cACAZ,EAAWa,GACX6G,EAAc7G,IAEhBP,GAAQ,GAXgB,2CAAH,oDAavBsH,KACC,IAsBH,IAiCMnD,EAAe,SAACC,GACpB,IAAIC,EAAa,EACbC,EAAc,EAKlB,OAJAF,EAAIG,SAAQ,SAAC7B,GACX2B,GAAc3B,EAAIsB,KAClBM,GAAe,KAEV,CACLD,EACAC,EACgB,IAAhBA,EAAoB,EAAID,EAAaC,IAyBzC,OACE,sBAAKpX,UAAW1C,EAAQuT,KAAxB,UACE,cAACkD,GAAA,EAAD,IACA,cAACC,GAAA,EAAD,CACEC,SAAS,WACTjU,UAAWqa,aAAK/c,EAAQsb,OAAQ1a,GAAQZ,EAAQ8b,aAFlD,SAIE,eAAClF,GAAA,EAAD,CAASlU,UAAW1C,EAAQgb,QAA5B,UACE,cAAClC,GAAA,EAAD,CACEkE,KAAK,QACL3Z,MAAM,UACN4Z,aAAW,cACX1Z,QAAS,WACP1C,GAAQ,IAEV6B,UAAWqa,aACT/c,EAAQgc,WACRpb,GAAQZ,EAAQic,kBATpB,SAYE,cAAC,KAAD,MAEF,cAACpF,GAAA,EAAD,CACEI,UAAU,KACV5X,QAAQ,KACRgE,MAAM,UACNyT,QAAM,EACNpU,UAAW1C,EAAQyX,MALrB,wBASA,cAACmD,GAAD,CACElY,UAAW1C,EAAQP,OACnBmE,MAAM,gBACNvE,QAAQ,WACRoJ,GAAG,4BACH/G,MAAOW,EACPY,SAAU,SAACia,GACTL,EAAUK,EAAEzb,OAAOC,MAAMC,QAjDf,SAACoD,GACrB8Q,QAAQC,IAAR,iBACA,IAAI8D,EAAG,aAAO+C,GACd/C,EAAMA,EAAIuD,QAAO,SAACjF,GAChB,OAAOA,EAAIuC,OAAO2C,cAAc7K,SAASxN,EAAEqY,kBAE7ClI,EAAW0E,GA4CDyD,CAAcH,EAAEzb,OAAOC,MAAMC,gBAKrC,eAAC2b,GAAA,EAAD,CACEje,QAAQ,YACRW,QAAS,CACPiU,MAAO8I,aAAK/c,EAAQkc,aAActb,GAAQZ,EAAQoc,mBAEpDxb,KAAMA,EALR,UAOE,qBAAK8B,UAAW1C,EAAQkb,YAAxB,SACE,cAACpC,GAAA,EAAD,CACEvV,QAAS,WACP1C,GAAQ,IAFZ,SAKE,cAAC,KAAD,QAGJ,cAAC0c,GAAA,EAAD,IACA,cAACC,GAAA,EAAD,UACE,gCACE,eAACC,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QAnIV,WACfsS,QAAQC,IAAR,YAEA,IAAI8D,EAAG,aAAO+C,IAtBhB,SAAiBe,GAKf,IAJA,IACEC,EADEC,EAAeF,EAAMpZ,OAIlB,IAAMsZ,GAAc,CAEzBD,EAAcvZ,KAAKyZ,MAAMzZ,KAAKmL,SAAWqO,GACzCA,IAHyB,MAMmB,CAC1CF,EAAMC,GACND,EAAME,IAFPF,EAAME,GANkB,KAMHF,EAAMC,GANH,MAkB3BG,CAAQlE,GACR1E,EAAW0E,IA8HH,UACE,cAACmE,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,gBAExB,eAACR,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QA3FN,WACnBsS,QAAQC,IAAR,YACA,IAAI8D,EAAG,aAAO+C,GACd/C,EAAIsE,MAAK,SAACrc,EAAGsc,GACX,OACExE,EAAawE,EAAEzD,SAAS,GAAGC,QAAQ,GACnChB,EAAa9X,EAAE6Y,SAAS,GAAGC,QAAQ,MAGvCzF,EAAW0E,IAkFH,UACE,cAACmE,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,sBAExB,eAACR,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QAxIV,WACfsS,QAAQC,IAAR,YACA,IAAI8D,EAAG,aAAO+C,GACd/C,EAAIsE,MAAK,SAACrc,EAAGsc,GACX,OAAOA,EAAEhI,UAAUI,SAAW1U,EAAEsU,UAAUI,YAE5CrB,EAAW0E,IAkIH,UACE,cAACmE,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,kBAExB,eAACR,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QAtIV,WACfsS,QAAQC,IAAR,YACA,IAAI8D,EAAG,aAAO+C,GACd/C,EAAIsE,MAAK,SAACrc,EAAGsc,GACX,OAAOA,EAAEhI,UAAUG,SAAWzU,EAAEsU,UAAUG,YAE5CpB,EAAW0E,IAgIH,UACE,cAACmE,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,mBAExB,eAACR,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QApIV,WACfsS,QAAQC,IAAR,YACAZ,EAAWyH,IAkIH,UACE,cAACoB,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,cAExB,eAACR,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QAtIV,WACfsS,QAAQC,IAAR,YACA,IAAI8D,EAAG,aAAO+C,GACd/C,EAAMA,EAAIwE,UACVlJ,EAAW0E,IAkIH,UACE,cAACmE,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,cAExB,eAACR,GAAA,EAAD,CAAU/d,QAAM,EAAC6D,QAASzD,EAAQue,OAAlC,UACE,cAACN,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAcC,QAAQ,uBAK9B,uBAAMvb,UAAW1C,EAAQuY,QAAzB,UACE,qBAAK7V,UAAW1C,EAAQuc,eACxB,eAACxF,GAAA,EAAD,CAAWC,SAAS,KAAKtU,UAAW1C,EAAQsX,UAA5C,UACE,cAACD,GAAA,EAAD,CAAMC,WAAS,EAACxD,QAAS,EAAzB,SAEE,cAACuD,GAAA,EAAD,CAAMG,MAAI,EAACW,GAAI,GAAf,SACE,cAACmG,GAAA,EAAD,CAAO5b,UAAW1C,EAAQiU,MAA1B,SACE,cAACmF,GAAD,CAAQrX,KAAMkT,EAASoE,KAAMla,EAAM4C,aAIzC,cAACwc,GAAA,EAAD,CAAKC,GAAI,aAMnB,SAASxF,GAAW7Z,GAClB,YAA6B+W,IAAzB/W,EAAM8Z,SAAS3W,SACTnD,EAAM8Z,SAAS3W,MAAMC,MAelBqL,OAXf,SAAezO,GACb,OACE,mCACG6Z,GAAW7Z,GACV,cAACud,GAAD,CAAY3a,KAAM5C,EAAM8Z,SAAS3W,QAEjC,cAACyW,GAAD,OClFOuE,OApUf,SAAgB9T,EAAKkI,EAASlM,GAC7B,IAAI4C,EAAMsJ,EAAQtJ,IACdiC,EAAUqH,EAAQrH,QAChBtF,EAAIgB,EAASG,UAgBnB,GAZA+M,GAAUzJ,GAEVA,EAAIC,OACJD,EAAIW,KAAKpE,EAASC,SAASjC,EAAGgC,EAASC,SAAShC,EAAG+B,EAASE,QAAQlC,EAAIgB,EAAGgB,EAASE,QAAQjC,EAAIe,GAChGyE,EAAIkE,OAGJlE,EAAIC,OACJD,EAAIE,UAAU3D,EAASC,SAASjC,EAAGgC,EAASC,SAAShC,GACrDiP,GAAYzJ,EAAKpB,GAGb5C,EAAOiZ,OAAQ,CAClB,IAAIC,EAAQ5a,EAAK6a,OAAOnZ,EAAOoZ,WAAW,GAAIpZ,EAAOoZ,WAAW,IAE5D5R,EADQlJ,EAAK+a,UAAUrZ,EAAOoZ,WAAW,GAAIpZ,EAAOoZ,WAAW,IACjDhX,IAAI8W,GAAOrZ,IAAI,IAAIvB,EAAK,EAAG,IAE7C0F,EAAIC,OACJD,EAAII,YACJJ,EAAIW,KAAKuU,EAAM3a,EAAIgB,EAAG2Z,EAAM1a,EAAIe,EAAGiI,EAAMjJ,EAAIgB,EAAGiI,EAAMhJ,EAAIe,GAC1DyE,EAAI2H,YAAY,CAAC,GAAK,EAAG,IACzB3H,EAAIQ,YAAc,QAClBR,EAAIS,SACJT,EAAIU,YACJV,EAAIY,UAGLZ,EAAIY,UAGJ,IAAK,IAAIzE,EAAI,EAAGA,EAAII,EAASD,SAAUH,IACtC,IAAK,IAAIuI,EAAI,EAAGA,EAAI7D,EAAQ/F,OAAQ4J,IAC/B7D,EAAQ6D,GAAG/E,MAAM3D,OAAOG,IAAI0E,EAAQ6D,GAAG9B,KAAK5C,EAAK7D,GAIvD6D,EAAIY,UAGJZ,EAAIC,OACJ,IAAMqV,EAAkB,IAAIhb,EAAK,GAAI,IAC/Bib,EAAa,GACnBA,EAAW5c,KAAK,kBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeC,WACjEiY,EAAW5c,KAAK,kBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeE,WACjEgY,EAAW5c,KAAK,kBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeG,WACjE+X,EAAW5c,KAAK,iBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeI,UACjEuC,EAAIE,UAAU,GAAI,KAElB,IAAK,IAAI/D,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC5B,IAAIsZ,EAAI,KAAM9b,EAAO,UAAWiE,OAAM,EAAEC,OAAM,EAC9C,GAAI0X,EAAWpZ,EAAI,GAClB,OAAQoZ,EAAWpZ,EAAI,IACtB,IAAK,iBAEJ,GADAxC,EAAO,QACY,IAAfqC,EAAOwZ,IAAW,CACrB,IAAIrX,EAAM,IAAI7D,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,GAC9D4I,EAAMpD,EAAI2D,qBAAqBxF,EAAI5D,EAAG4D,EAAI3D,EAAG,EAAG2D,EAAI5D,EAAG4D,EAAI3D,EAAG,IAAMe,GACxE6H,EAAIE,aAAa,EAAG/G,EAASmB,UAAT,SAA+BE,QACnDwF,EAAIE,aAAa,EAAG,WACpB1F,EAASwF,OACHxF,EAAS,UAChBC,EAAS,UACT,MACD,IAAK,iBAEJ,GADAlE,EAAO,QACY,IAAfqC,EAAOwZ,IAAW,CACrB,IAAIrX,EAAM,IAAI7D,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,GAC9D4I,EAAMpD,EAAI2D,qBAAqBxF,EAAI5D,EAAG4D,EAAI3D,EAAG,EAAG2D,EAAI5D,EAAG4D,EAAI3D,EAAG,IAAMe,GACxE6H,EAAIE,aAAa,EAAG/G,EAASmB,UAAT,SAA+BE,QACnDwF,EAAIE,aAAa,EAAG,WACpB1F,EAASwF,OACHxF,EAAS,UAChBC,EAAS,UACT,MACD,IAAK,iBAEJ,GADAlE,EAAO,QACY,IAAfqC,EAAOwZ,IAAW,CACrB,IAAIrX,EAAM,IAAI7D,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,GAC9D4I,EAAMpD,EAAI2D,qBAAqBxF,EAAI5D,EAAG4D,EAAI3D,EAAG,EAAG2D,EAAI5D,EAAG4D,EAAI3D,EAAG,IAAMe,GACxE6H,EAAIE,aAAa,EAAG/G,EAASmB,UAAT,SAA+BE,QACnDwF,EAAIE,aAAa,EAAG,WACpB1F,EAASwF,OACHxF,EAAS,UAChBC,EAAS,UACT,MACD,IAAK,gBAEJ,GADAlE,EAAO,QACY,IAAfqC,EAAOwZ,IAAW,CACrB,IAAIrX,EAAM,IAAI7D,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,GAC9D4I,EAAMpD,EAAI2D,qBAAqBxF,EAAI5D,EAAG4D,EAAI3D,EAAG,EAAG2D,EAAI5D,EAAG4D,EAAI3D,EAAG,IAAMe,GACxE6H,EAAIE,aAAa,EAAG/G,EAASmB,UAAT,QAA8BE,QAClDwF,EAAIE,aAAa,EAAG,WACpB1F,EAASwF,OACHxF,EAAS,UAChBC,EAAS,UACT,MACD,IAAK,cACJ4X,EAAI,IAAIC,EAAuB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACvFb,EAAO,WACP,MACD,IAAK,WACJ8b,EAAI,IAAIC,EAAoB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACpFb,EAAO,WACP,MACD,IAAK,MACJ8b,EAAI,IAAIC,EAAe,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,IACzFb,EAAO,WACP,MACD,IAAK,iBACJ8b,EAAI,IAAIC,EAA0B,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,KACpGb,EAAO,WACP,MACD,IAAK,QACJ8b,EAAI,IAAIC,EAAiB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACjFb,EAAO,WACP,MACD,IAAK,SACJ8b,EAAI,IAAIC,EAAkB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IAClFb,EAAO,WACP,MACD,IAAK,MACJ8b,EAAI,IAAIC,EAAe,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IAC/Eb,EAAO,WACP,MACD,IAAK,WACJ8b,EAAI,IAAIC,EAAoB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACpFb,EAAO,WACP,MACD,IAAK,SACJ8b,EAAI,IAAIC,EAAkB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IAClFb,EAAO,UACP,MACD,IAAK,eACJ8b,EAAI,IAAIC,EAAwB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACxFb,EAAO,WACP,MACD,IAAK,cACJ8b,EAAI,IAAIC,EAAuB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACvFb,EAAO,WACP,MACD,IAAK,aACJ8b,EAAI,IAAIC,GAAsB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACtFb,EAAO,UACP,MACD,IAAK,WACJ8b,EAAI,IAAIC,GAAoB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACpFb,EAAO,UACP,MACD,IAAK,QACJ8b,EAAI,IAAIC,GAAiB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACjFb,EAAO,WACP,MACD,IAAK,yBACJ8b,EAAI,IAAIC,GAAkC,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,GAAwB,GAApBmZ,EAAgB9a,EAAU,KACjHb,EAAO,WACP,MACD,IAAK,sBACJ8b,EAAI,IAAIC,GAA+B,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,GAAwB,GAApBmZ,EAAgB9a,EAAU,KAC9Gb,EAAO,WACP,MACD,IAAK,YACJ8b,EAAI,IAAIC,GAAqB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACrFb,EAAO,WACP,MACD,IAAK,SACJ8b,EAAI,IAAIC,GAAkB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IAClFb,EAAO,UACP,MACD,IAAK,iBACJ8b,EAAI,IAAIC,GAA0B,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IAC1Fb,EAAO,WACP,MACD,IAAK,aACJ8b,EAAI,IAAIC,GAAsB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,IACtFb,EAAO,WA2BV,GAvBAqG,EAAII,YACJJ,EAAIW,KAAK,EAAI2U,EAAgB/a,EAAI4B,EAAI,EAAG,EAAGmZ,EAAgB/a,EAAI,EAAG+a,EAAgB9a,EAAI,GACtFwF,EAAIO,UAAsB,UAAT5G,EAAoBiE,EAASrB,EAASmB,UAAU/D,GAAMiE,OACvEoC,EAAI/D,OACJ+D,EAAI4D,UAAY,EAChB5D,EAAIQ,YAAwB,UAAT7G,EAAoBkE,EAAStB,EAASmB,UAAU/D,GAAMkE,OACzEmC,EAAIS,SACJT,EAAI4D,UAAY,EAChB5D,EAAIU,YAEM,IAANvE,GACH6D,EAAIC,OACJD,EAAIE,UAA8B,GAApBoV,EAAgB/a,EAA6B,GAApB+a,EAAgB9a,GACnDwB,EAAO0F,OAAQ+H,GAAgBzJ,EAAKzE,GACnCkO,GAAgBzJ,EAAKzE,GAC1ByE,EAAIY,WACY,KAANzE,IACV6D,EAAIC,OACJD,EAAIE,UAA8B,KAApBoV,EAAgB/a,EAA8B,GAApB+a,EAAgB9a,GACxDiP,GAAiBzJ,EAAKzE,GACtByE,EAAIY,WAED6U,GAAGA,EAAE7S,KAAK5C,GACY,mBAAtBuV,EAAWpZ,EAAI,GACT,IAAIuZ,EAAwB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,EAAuB,GAApBmZ,EAAgB9a,EAAU,IACxGoI,KAAK5C,GACC,IAAI0V,EAAoB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,EAAuB,GAApBmZ,EAAgB9a,EAAU,IACpGoI,KAAK5C,GACRA,EAAIuH,UAAY,SAChBvH,EAAIwH,aAAe,SACnBxH,EAAIyH,KAAO,cACXzH,EAAIQ,YAAc,QAClBR,EAAI4D,UAAY,EAChB5D,EAAI2V,WAAW,qBAAOL,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,IAC/EwF,EAAIO,UAAY,QAChBP,EAAI0H,SAAS,qBAAO4N,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,SACvE,GAA0B,mBAAtB+a,EAAWpZ,EAAI,GAAyB,CACzC,IAAIuZ,EAAiB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,GAAwB,GAApBmZ,EAAgB9a,EAAU,KAClGoI,KAAK5C,GACC,IAAI0V,EAAoB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,GAAwB,GAApBmZ,EAAgB9a,EAAU,IACrGoI,KAAK5C,GACC,IAAI0V,EAAe,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,IAC3FoI,KAAK5C,GACRA,EAAIuH,UAAY,SAChBvH,EAAIwH,aAAe,SACnBxH,EAAIyH,KAAO,cACXzH,EAAIQ,YAAc,QAClBR,EAAI4D,UAAY,EAChB5D,EAAI2V,WAAW,qBAAOL,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,IAC/EwF,EAAIO,UAAY,QAChBP,EAAI0H,SAAS,qBAAO4N,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,SACvE,GAA0B,mBAAtB+a,EAAWpZ,EAAI,GAAyB,CAClD,IAAIyZ,EAAK,IAAIF,EAAuB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,EAAuB,GAApBmZ,EAAgB9a,EAAU,IAC1GwF,EAAIC,OACJD,EAAIE,UAAU0V,EAAGzX,IAAI5D,EAAGqb,EAAGzX,IAAI3D,GAC/BwF,EAAIiD,MAAM,GAAK,IACfjD,EAAIE,WAAW0V,EAAGzX,IAAI5D,GAAIqb,EAAGzX,IAAI3D,GACjCob,EAAGhT,KAAK5C,GACRA,EAAIY,UACJ,IAAIiV,EAAK,IAAIH,EAAe,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,EAAuB,GAApBmZ,EAAgB9a,EAAU,KAClGwF,EAAIC,OACJD,EAAIE,UAAU0V,EAAGzX,IAAI5D,EAAGqb,EAAGzX,IAAI3D,GAC/BwF,EAAI+B,QAAS,IAAOnH,KAAKK,IACzB+E,EAAIE,WAAW0V,EAAGzX,IAAI5D,GAAIqb,EAAGzX,IAAI3D,GACjCqb,EAAGjT,KAAK5C,GACRA,EAAIY,UACJZ,EAAIuH,UAAY,SAChBvH,EAAIwH,aAAe,SACnBxH,EAAIyH,KAAO,cACXzH,EAAIQ,YAAc,QAClBR,EAAI4D,UAAY,EAChB5D,EAAI2V,WAAW,qBAAOL,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,IAC/EwF,EAAIO,UAAY,QAChBP,EAAI0H,SAAS,qBAAO4N,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,SACvE,GAA0B,kBAAtB+a,EAAWpZ,EAAI,GAAwB,CACjD,IAAIyZ,EAAK,IAAIF,EAAkB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,EAAuB,GAApBmZ,EAAgB9a,EAAU,IACrGob,EAAGxR,MAAQ,EACXwR,EAAGxe,MAAO,EACVwe,EAAGhT,KAAK5C,GACC,IAAI0V,GAAoB,IAAIpb,EAAKgb,EAAgB/a,GAAK4B,EAAI,IAAO,GAAwB,GAApBmZ,EAAgB9a,IAC3FoI,KAAK5C,GACRA,EAAIuH,UAAY,SAChBvH,EAAIwH,aAAe,SACnBxH,EAAIyH,KAAO,mBACXzH,EAAIQ,YAAc,QAClBR,EAAI2V,WAAW,qBAAOL,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,IAC/EwF,EAAIO,UAAY,QAChBP,EAAI0H,SAAS,qBAAO4N,EAAgB/a,GAAK4B,EAAI,IAA0B,GAApBmZ,EAAgB9a,EAAU,KAmB/E,GAhBAwF,EAAIY,UAGA5E,EAAOuM,OACVvI,EAAIC,OACJD,EAAIE,UAAUlE,EAAO8Z,WAAW3X,IAAI5D,EAAGyB,EAAO8Z,WAAW3X,IAAI3D,GAC7DiP,GAAiBzJ,EAAK,GAAMzE,GAC5ByE,EAAIY,YAEA5E,EAAO+Z,SAAW/Z,EAAOga,OAC5Bha,EAAO8Z,WAAWlT,KAAK5C,GAMG,KAAxBhE,EAAOia,QAAQC,KAAa,CAC/BlW,EAAIC,OAEJ,IAAIkW,GAAiB3U,KAAKC,MAAQzF,EAAOia,QAAQG,UAAY,IAC7DD,EAAgBA,EAAe,IAAQA,EAAe,IAC/CA,EAAe,GAAOvb,KAAKU,IAAK,EAAI6a,EAAe,GAAK,GAAK,EACpEnW,EAAIG,YAAcgW,EAElBnW,EAAIE,UAAU3D,EAASC,SAASjC,EAAGgC,EAASC,SAAShC,GACrDwF,EAAIG,aAAe,GAEnBH,EAAII,YACJJ,EAAIW,KAAKpE,EAASE,QAAQlC,EAAIgB,EAAI,GAAK,EAAGgB,EAASE,QAAQlC,EAAIgB,EAAI,GAAKA,GACxEyE,EAAIO,UAAY,QAChBP,EAAI/D,OACJ+D,EAAIU,YAEJV,EAAIG,aAAe,EACnBH,EAAIuH,UAAY,SAChBvH,EAAIwH,aAAe,SACnBxH,EAAIyH,KAAO,cACXzH,EAAI4D,UAAY,EAChB5D,EAAIO,UAAavE,EAAOia,QAAQpc,MAASmC,EAAOia,QAAQpc,MAAO,MAC/DmG,EAAI0H,SAAS1L,EAAOia,QAAQC,KAAM3Z,EAASE,QAAQlC,EAAIgB,EAAI,GAAK,GAAMA,GAEtEyE,EAAIY,Y,gECxSAyV,GAAM,CACR3f,KAAM,eACN4G,SAAU,eACV6D,eAAgB,yCAChBoF,uBAAwB,yCACxBC,oBAAqB,yCACrB7B,aAAc,2BACdzB,MAAO,eACPc,IAAK,eACLC,SAAU,qBACVqC,MAAO,eACPtH,YAAa,2BACbiD,IAAK,qBACLsB,OAAQ,eACR0B,YAAa,6CACbd,OAAQ,qBACR6B,WAAY,2BACZI,SAAU,eACVY,UAAW,eACXK,OAAQ,eACRO,eAAgB,2BAChBI,WAAY,2BAEZ5G,UAAW,eACX3F,GAAI,SACJC,KAAM,SACNC,KAAM,SACNC,MAAO,SACP,UAAW,eACX,YAAa,eACb,WAAY,eACZ,aAAc,eACdsK,WAAY,eACZC,SAAU,eACV7E,MAAO,eACP,aAAc,qBACde,KAAM,SACNC,OAAQ,eACRC,KAAM,SACN,aAAc,qBACdkE,MAAO,2BACPK,UAAW,qBACXwP,iBAAkB,qBAClB1R,SAAU,eACVG,MAAO,SACPC,KAAM,SACN9C,IAAK,eACLsB,MAAO,eACPM,MAAO,SACPD,MAAO,SACPyD,cAAe,eACfiP,WAAY,eACZC,UAAW,eAEXnV,SAAU,eACVlL,MAAO,SACPuQ,OAAQ,SAERrH,QAAS,2BACTC,UAAW,2BACXC,UAAW,2BACXC,WAAY,2BACZuC,OAAQ,gBAGNjM,GAAYC,aAAW,SAAC+T,GAAD,MAAY,CACrC2M,YAAa,CACTxgB,OAAQ6T,EAAMQ,QAAQ,GACtBoM,SAAU,KAEdC,YAAa,CACT/L,UAAWd,EAAMQ,QAAQ,QAwRlBsM,GArRMC,sBAAW,SAAClhB,EAAO+T,GACpC,IAAMN,EAAYC,mBACZ7S,EAAUV,KAChB,EAA0BW,mBAAS,GAAnC,mBAEIyR,GAFJ,UAEcvS,EAAMuS,SACpB,EAA4BzR,mBAAS,CACjCwe,QAAQ,EACR6B,WAAW,EACX1B,WAAY,CAAC,IAAI9a,EAAQ,IAAIA,GAC7B0b,MAAM,EACND,SAAS,EACTD,WAAY,KACZiB,WAAY,GACZxO,OAAO,EACP7G,QAAQ,EACR8T,IAAK,EACLS,QAAS,CAAEC,KAAM,GAAIE,SAAU,KAXnC,mBAAOpa,EAAP,KAAegb,EAAf,KAaMC,EAAQ,WACVthB,EAAMsK,KAAKiI,IAEfgP,8BAAoBxN,GAAK,iBAAO,CAC5ByN,cAD4B,WAExBxhB,EAAMsK,KAAKiI,QAInBoB,qBAAU,WACN,IAGI8N,EAGAC,EANE7O,EAASY,EAAUG,QACnBvJ,EAAMwI,EAAOgB,WAAW,MAG9B4N,ECpIO,SAAoBE,EAAOtb,EAAQgb,EAAW9O,EAAS+O,GACrE,IAAMza,EAAWD,EAASC,SACpB+a,EAAShb,EAASC,SAASX,IAAIU,EAASE,QAAQiC,IAAInC,EAASG,YAC7DnB,EAAIgB,EAASG,UACb8a,EAAW,SAAC9D,EAAGzS,GACpB,OAAQyS,EAAE+D,SAA2B,WAAhBxW,EAAOtH,MAAqC,eAAhBsH,EAAOtH,MAAyC,aAAhBsH,EAAOtH,MAAuC,cAAhBsH,EAAOtH,MAGjH+d,EAAmB,SAAChE,GACzB,IAAMiE,EAAW,IAAIrd,EAAKoZ,EAAEkE,QAASlE,EAAEmE,SACvC,IAAK7b,EAAO+Z,SAAW/Z,EAAO8a,WAAaa,EAASnZ,QAAQhC,EAAU+a,GAAS,CAE9E,IAAIO,EAAgBH,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GAClDS,EAAOoZ,WAAW,GAAK0C,OACb9b,EAAO+Z,UAEb4B,EAASnZ,QAAQhC,EAAU+a,KAAYvb,EAAOuM,MAEjDvM,EAAO8Z,WAAW3X,IAAMwZ,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GAAGmD,IAAInD,GAAGM,IAAIW,EAASX,IAAI,IAAIvB,EAAK,GAAMiB,EAAG,GAAMA,KACnGS,EAAO8Z,WAAW3X,IAAMwZ,EAASxU,UAIpC4U,EAAmB,SAACrE,GACzB,IAAMiE,EAAW,IAAIrd,EAAKoZ,EAAEkE,QAASlE,EAAEmE,SACvC,GAAiB,IAAbnE,EAAExd,OACL,GAAIyhB,EAASnZ,QAAQhC,EAAU+a,GAE9B,GADAlL,QAAQC,IAAItQ,EAAOuM,OACfvM,EAAOuM,MAAO,CACjB,IAAIrJ,EAAUyY,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GACxCyc,EAAW9P,EAAQtJ,IAAIM,EAAQ1E,GAAG0E,EAAQ3E,GAAGoF,MAAMoB,MACvD,IAAkB,IAAdiX,EACH,IAAK,IAAI7b,EAAI,EAAGA,EAAI+L,EAAQrH,QAAQ/F,OAAQqB,IACvC+L,EAAQrH,QAAQ1E,GAAG+C,QAAQ4B,MAAM5B,KAChCwU,EAAE+D,SAAWvP,EAAQrH,QAAQ1E,GAAGwD,MAAMoB,QAAUiX,KACnD9P,EAAQrH,QAAQ1E,GAAG8b,OAAO/P,EAAQtJ,IAAKsJ,EAAQrH,SAC/CqH,EAAQrH,QAAQqX,OAAO/b,IAAK,SAOhC,GAAIH,EAAO+Z,QAAS,CACnB/Z,EAAO8Z,WAAW3X,IAAMwZ,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GAAGmD,IAAInD,GAAGM,IAAIW,EAASX,IAAI,IAAIvB,EAAK,GAAMiB,EAAG,GAAMA,KAEzG,IAAI4c,EAAS,eAAQnc,GACjB0X,EAAE+D,UAAYD,EAAS9D,EAAG1X,EAAO8Z,cACpCqC,EAAUlC,QAAU,CAAEC,KAAM,yDAAaE,SAAU5U,KAAKC,QAEzD0W,EAAUpC,QAAUyB,EAAS9D,EAAG1X,EAAO8Z,YACnC9Z,EAAO8Z,WAAWzN,MAAMH,EAAQtJ,IAAKsJ,EAAQrH,SAChDqH,EAAQrH,QAAQlI,KAAKqD,EAAO8Z,YAE5BqC,EAAUlC,QAAU,CAAEC,KAAM,mGAAoBE,SAAU5U,KAAKC,OAEhE0W,EAAUrC,WAAc0B,EAAS9D,EAAG1X,EAAO8Z,YAAe9Z,EAAO8Z,WAAW3S,QAAU,KACtF6T,EAAUmB,OACJ,CAEN,IAAIA,EAAS,eAAQnc,GACjBkD,EAAUyY,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GACxCyc,EAAW9P,EAAQtJ,IAAIM,EAAQ1E,GAAG0E,EAAQ3E,GAAGoF,MAAMoB,MACvD,IAAkB,IAAdiX,GACH,IAAK,IAAI7b,EAAI,EAAGA,EAAI+L,EAAQrH,QAAQ/F,OAAQqB,IAC3C,GAAI+L,EAAQrH,QAAQ1E,GAAG+C,QAAQ4B,MAAM5B,IAAYgJ,EAAQrH,QAAQ1E,GAAGwD,MAAMoB,QAAUiX,EAAU,CAC7FG,EAAUpC,SAAU,EACpBoC,EAAUnC,MAAO,EACjBmC,EAAUlD,QAAS,EACnBkD,EAAUrB,WAAY,EAClBpD,EAAE+D,UAAYD,EAAS9D,EAAGxL,EAAQrH,QAAQ1E,MAC7Cgc,EAAUlC,QAAU,CAAEC,KAAM,yDAAaE,SAAU5U,KAAKC,QAEpD+V,EAAS9D,EAAGxL,EAAQrH,QAAQ1E,KAAK+L,EAAQrH,QAAQ1E,GAAG8b,OAAO/P,EAAQtJ,IAAKsJ,EAAQrH,SACrFsX,EAAUrC,WAAc0B,EAAS9D,EAAGxL,EAAQrH,QAAQ1E,IAAO+L,EAAQrH,QAAQ1E,GAAGgH,QAAU+E,EAAQrH,QAAQ1E,GACxGgc,EAAUrC,WAAW3X,IAAMwZ,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GAAGmD,IAAInD,GAAGM,IAAIW,EAASX,IAAI,IAAIvB,EAAK,GAAMiB,EAAG,GAAMA,KAC5G4c,EAAUpB,WAAa7O,EAAQrH,QAAQ1E,GAAGic,iBACrCZ,EAAS9D,EAAGxL,EAAQrH,QAAQ1E,KAAK+L,EAAQrH,QAAQqX,OAAO/b,EAAG,GAChE,YAIFgc,EAAUlD,QAAS,EACnBkD,EAAUrB,WAAY,EACtBqB,EAAU/C,WAAa,CAAClW,EAASA,GAElC8X,EAAUmB,OAGN,CAEN,IAAIA,EAAS,eAAQnc,GAQrB,GAPAmc,EAAUlD,QAAS,EACnBkD,EAAUrB,WAAY,EACtBqB,EAAUpC,SAAU,EACpBoC,EAAUnC,MAAO,EACjBmC,EAAUrC,WAAa,KACvBqC,EAAU5P,OAAQ,EAClByO,EAAUmB,GACNR,EAASnZ,QAAQ,IAAIlE,EAAK,GAAI,KAAM,IAAIA,EAAK,KAAM,MAAO,CAE7D,IAAI+d,MAAkB3E,EAAEkE,QAAU,IAAM,IACpCpV,EAAS,GACb,GAAoB,IAAhB6V,EAAmB7V,EAAS,kBAC3B,GAAoB,KAAhB6V,EAAoB7V,EAAS,YACjC,CACJ,IAAM+S,EAAa,GACnBA,EAAW5c,KAAK,kBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeC,WACjEiY,EAAW5c,KAAK,kBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeE,WACjEgY,EAAW5c,KAAK,kBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeG,WACjE+X,EAAW5c,KAAK,iBACG,IAAfqD,EAAOwZ,KAAWD,EAAW5c,KAAX,MAAA4c,EAAU,aAAShZ,EAASc,eAAeI,UACjE+E,EAAU+S,EAAW8C,EAAc,GAAM9C,EAAW8C,EAAc,GAAK,GAExE,IAAIvQ,EAAQ,EACZ,OAAQtF,GACP,IAAK,aACJ2V,EAAU5P,OAAQ,EAClB4P,EAAUzW,QAAUyW,EAAUzW,OAC1ByW,EAAUzW,SACbyW,EAAUlC,QAAU,CAAEC,KAAM,2EAAgBE,SAAU5U,KAAKC,MAAO5H,MAAO,UAE1Eod,IACA,MACD,IAAK,QACJkB,EAAU5P,OAAS4P,EAAU5P,MACzB4P,EAAU5P,QACb4P,EAAUlC,QAAU,CAAEC,KAAM,6FAAmBE,SAAU5U,KAAKC,MAAO5H,MAAO,SAC5Ese,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,CAAEnc,KAAM,WAAYwE,IAAK,IAAI7D,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACtEM,EAAUpB,WAAa,IAExB,MACD,IAAK,iBACJoB,EAAU3C,IAAsB,IAAfxZ,EAAOwZ,IAAa,EAAI,EACzC,MACD,IAAK,iBACJ2C,EAAU3C,IAAsB,IAAfxZ,EAAOwZ,IAAa,EAAI,EACzC,MACD,IAAK,iBACJ2C,EAAU3C,IAAsB,IAAfxZ,EAAOwZ,IAAa,EAAK,EAC1C,MACD,IAAK,gBACJ2C,EAAU3C,IAAsB,IAAfxZ,EAAOwZ,IAAa,EAAI,EACzC,MACD,IAAK,cACJ2C,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAuB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACxEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,WACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAoB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACrEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,MACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAe,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAChEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,iBACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAA0B,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAC3EM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,QACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAiB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAClEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,SACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAkB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACnEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,MACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAe,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAChEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,WACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAoB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACrEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,SACJxQ,EAAQ,EACR,IAAK,IAAI3L,EAAI,EAAGA,EAAI+L,EAAQrH,QAAQ/F,OAAQqB,IACX,WAA5B+L,EAAQrH,QAAQ1E,GAAGxC,MAAmBmO,IAEvCA,EAAQ,IACXqQ,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAkB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACnEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,KAEpCH,EAAUpC,SAAU,EACpBoC,EAAUlC,QAAU,CAAEC,KAAM,mEAAkBE,SAAU5U,KAAKC,QAE9D,MACD,IAAK,eACJ0W,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAwB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACzEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,cACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,EAAuB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACxEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,aACJxQ,EAAQ,EACR,IAAK,IAAI3L,EAAI,EAAGA,EAAI+L,EAAQrH,QAAQ/F,OAAQqB,IACX,eAA5B+L,EAAQrH,QAAQ1E,GAAGxC,MAAuBmO,IAE3CA,EAAQ,GACXqQ,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAsB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACvEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,KAEpCH,EAAUpC,SAAU,EACpBoC,EAAUlC,QAAU,CAAEC,KAAM,wEAAkBE,SAAU5U,KAAKC,QAE9D,MACD,IAAK,WACJqG,EAAQ,EACR,IAAK,IAAI3L,EAAI,EAAGA,EAAI+L,EAAQrH,QAAQ/F,OAAQqB,IACX,aAA5B+L,EAAQrH,QAAQ1E,GAAGxC,MAAqBmO,IAEzCA,EAAQ,GACXqQ,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAoB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACrEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,KAEpCH,EAAUpC,SAAU,EACpBoC,EAAUlC,QAAU,CAAEC,KAAM,4DAAgBE,SAAU5U,KAAKC,QAE5D,MACD,IAAK,QACJ0W,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAiB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAClEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,yBACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAkC,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACnFM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,sBACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAA+B,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAChFM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,YACJxQ,EAAQ,EACR,IAAK,IAAI3L,EAAI,EAAGA,EAAI+L,EAAQrH,QAAQ/F,OAAQqB,IACX,cAA5B+L,EAAQrH,QAAQ1E,GAAGxC,MAAsBmO,IAE1CA,EAAQ,IACXqQ,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAqB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACtEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,KAEpCH,EAAUpC,SAAU,EACpBoC,EAAUlC,QAAU,CAAEC,KAAM,6DAAiBE,SAAU5U,KAAKC,QAE7D,MACD,IAAK,SACJ0W,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAkB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACnEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,iBACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAA0B,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UAC3EM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GACpC,MACD,IAAK,aACJH,EAAUpC,SAAU,EACpBoC,EAAUrC,WAAa,IAAIJ,GAAsB,IAAIpb,EAAKoZ,EAAEkE,QAASlE,EAAEmE,UACvEM,EAAUpB,WAAaoB,EAAUrC,WAAWsC,iBAC5CD,EAAUrC,WAAWwC,gBAAe,GAKvB,UAAX9V,IAAoB2V,EAAU5P,OAAQ,GAC1CyO,EAAUmB,MAMRI,EAAiB,SAAC7E,GACvB,IAAMiE,EAAW,IAAIrd,EAAKoZ,EAAEkE,QAASlE,EAAEmE,SACvC,GAAiB,IAAbnE,EAAExd,QAAgB8F,EAAOiZ,QAAUjZ,EAAO8a,WAAaa,EAASnZ,QAAQhC,EAAU+a,GAAS,CAE9F,IAAIY,EAAS,eAAQnc,GACrBmc,EAAUrB,WAAY,EACtB,IAAIgB,EAAgBH,EAASvZ,IAAI5B,GAAU2C,OAAO5D,GAClD4c,EAAU/C,WAAW,GAAK0C,EAC1Bd,EAAUmB,OACJ,CAEN,IAAIA,EAAS,eAAQnc,GACrBmc,EAAUlD,QAAS,EACnBkD,EAAUrB,WAAY,EACtBE,EAAUmB,KAINK,EAAkB,SAAC9E,GACxBA,EAAE+E,kBAQH,OALAnB,EAAMoB,iBAAiB,YAAahB,GACpCJ,EAAMoB,iBAAiB,YAAaX,GACpCT,EAAMoB,iBAAiB,UAAWH,GAClCjB,EAAMoB,iBAAiB,cAAeF,GAE/B,WACNlB,EAAMqB,oBAAoB,YAAajB,GACvCJ,EAAMqB,oBAAoB,YAAaZ,GACvCT,EAAMqB,oBAAoB,UAAWJ,GACrCjB,EAAMqB,oBAAoB,cAAeH,IDrNhBI,CAAWpQ,EAAQxM,EAAQgb,EAAW9O,EAAS+O,GAgBlE,OAbe,SAAT4B,IAEE7c,EAAO0F,QE3IR,SAAgBb,EAASjC,GACpC,IAAK,IAAIzC,EAAI,EAAGA,EAAII,EAASD,SAAUH,IACnC,IAAK,IAAIuI,EAAI,EAAGA,EAAI7D,EAAQ/F,OAAQ4J,IAChC,GAAI7D,EAAQ6D,GAAGmU,OAAQ,CACnB,IAAMrW,EAAS3B,EAAQ6D,GAAGmU,OAAOhY,EAASjC,GAC1C,OAAQ4D,EAAO7I,MACX,IAAK,UACDkH,EAAQlI,KAAK6J,EAAOvB,QACpB,MACJ,IAAK,UACDJ,EAAQqX,OAAOxT,IAAK,KFiIboU,CAAO5Q,EAAQrH,QAASqH,EAAQtJ,KACnDkV,GAAO9T,EAAKkI,EAASlM,GAEO,KAAxBA,EAAOia,QAAQC,MAAe1U,KAAKC,MAAQzF,EAAOia,QAAQG,SAAW,MACrEpa,EAAOia,QAAQC,KAAO,IAG1BmB,EAAY0B,sBAAsBF,GAEtCA,GAEO,WACHzB,IACA4B,qBAAqB3B,MAE1B,CAACL,EAAWhb,EAAQkM,IAiDvB,OACI,mCACI,gCACI,sBAAM+Q,QAAQ,UACd,wBACIha,GAAG,iBACHyK,IAAKN,EACLjT,MAAK,SACLuQ,OAAM,QACNhN,MAAO,CAAE6N,UAAW,YAExB,qBACI7N,MAAO,CACHvD,MAAO,KACPuQ,OAAQ,GACRyD,gBAAiB,UACjBlU,OAAQ,YALhB,SAQI,sBAAKgJ,GAAG,qBAAqBvF,MAAO,CAAEyQ,gBAAiB,WAAvD,UACKnO,EAAOiZ,OACJ,qBAAKvb,MAAO,CAAE6N,UAAW,UAAzB,SA/BA,CACpB,CAAC,OAAQ,gBACT,CAAC,QAAS,gBACV,CAAC,QAAS,gBACV,CAAC,MAAO,gBACR,CAAC,OAAQ,gBACT,CAAC,MAAO,gBACR,CAAC,QAAS,iBAyB+B3I,KAAI,SAACsa,GAAD,OACjB,cAACtf,EAAA,EAAD,CACI6E,KAAK,QACL5E,MAAM,YACNhE,QAAQ,WACRkE,QAAS,YAzEb,SAACof,GAC7B,GAAKnd,EAAOiZ,OAAZ,CAKA,IAJA,IAAIC,EAAQ5a,EAAK6a,OAAOnZ,EAAOoZ,WAAW,GAAIpZ,EAAOoZ,WAAW,IAE5D5R,EADQlJ,EAAK+a,UAAUrZ,EAAOoZ,WAAW,GAAIpZ,EAAOoZ,WAAW,IACjDhX,IAAI8W,GAAOrZ,IAAI,IAAIvB,EAAK,EAAG,IAEpC6B,EAAI,EAAGA,EAAIqH,EAAMjJ,EAAG4B,IACzB,IAAK,IAAIuI,EAAI,EAAGA,EAAIlB,EAAMhJ,EAAGkK,IACzB,GAAIwD,EAAQtJ,IAAIsW,EAAM1a,EAAIkK,GAAGwQ,EAAM3a,EAAI4B,GAAGwD,MAAMtD,UAAUE,EAASa,eAAe+b,IAAW,OAIrG,IADA,IAAIC,EAAW,GACNjd,EAAI,EAAGA,EAAIqH,EAAMjJ,EAAG4B,IACzB,IAAK,IAAIuI,EAAI,EAAGA,EAAIlB,EAAMhJ,EAAGkK,IACzB0U,EAASzgB,KAAKuP,EAAQtJ,IAAIsW,EAAM1a,EAAIkK,GAAGwQ,EAAM3a,EAAI4B,GAAGxC,MACpDuO,EAAQtJ,IAAIsW,EAAM1a,EAAIkK,GAAGwQ,EAAM3a,EAAI4B,GAAGxC,KAAOwf,EAIrD,IADA,IAAIE,GAAW,EAAOC,GAAS,EACtBnd,EAAI,EAAGA,EAAII,EAASE,QAAQlC,EAAG4B,IACpC,IAAK,IAAIuI,EAAI,EAAGA,EAAInI,EAASE,QAAQjC,KAAO8e,IAAWD,GAAW3U,IAC/B,UAA3BwD,EAAQtJ,IAAI8F,GAAGvI,GAAGxC,KAAkB0f,GAAW,EACf,QAA3BnR,EAAQtJ,IAAI8F,GAAGvI,GAAGxC,OAAgB2f,GAAS,GAI5D,GADAjN,QAAQC,IAAI+M,IACPC,IAAWD,EAAU,CACtB,IAAK,IAAIld,EAAI,EAAGA,EAAIqH,EAAMjJ,EAAG4B,IACzB,IAAK,IAAIuI,EAAI,EAAGA,EAAIlB,EAAMhJ,EAAGkK,IACzBwD,EAAQtJ,IAAIsW,EAAM1a,EAAIkK,GAAGwQ,EAAM3a,EAAI4B,GAAGxC,KAAOyf,EAASG,QAG9Dvd,EAAOia,QAAU,CAAEC,KAAM,+GAAsBE,SAAU5U,KAAKC,SA0C9B+X,CAAwBN,EAAK,KAEjCpf,UAAWkC,EAAOiZ,OAPtB,SASKiE,EAAK,UAKd,wBAEPld,EAAO+Z,SAAW/Z,EAAOga,KACtB,qBAAKtc,MAAO,CAAEyQ,gBAAiB,UAAWE,YAAa,SAAvD,SACKoP,OAAOC,KAAK1d,EAAO+a,YAAYnY,KAAI,SAACC,GACjC,OAAQ7C,EAAO+a,WAAWlY,GAAGlF,MACzB,IAAK,OACD,OACI,qBACID,MAAO,CACHuR,QAAS,eACT0O,MAAO,OACPxP,gBAAiB,UACjBE,YAAa,SALrB,SAQI,cAAC9Q,EAAA,EAAD,CACIa,MAAOic,GAAIxX,GAAKwX,GAAIxX,GAAKA,EACzB3G,MAAO8D,EAAO8Z,WAAW1W,OAAOP,GAChCpF,SAAU,SAACia,GACP,IAAIyE,EAAS,eAAQnc,GACjB4d,EAAS,eAAQ5d,EAAO8Z,WAAW1W,QACvCwa,EAAU/a,GAAK6U,EAAEzb,OAAOC,MACxBigB,EAAUrC,WAAW1W,OAASwa,EAC9B5C,EAAUmB,QAK9B,IAAK,SACD,OACI,qBACIze,MAAO,CACHuR,QAAS,eACT0O,MAAO,OACPxP,gBAAiB,UACjBE,YAAa,SALrB,SAQI,eAACwP,GAAA,EAAD,CACIhkB,QAAQ,WACRqD,UAAW1C,EAAQigB,YAFvB,UAII,cAACqD,GAAA,EAAD,UAAazD,GAAIxX,GAAKwX,GAAIxX,GAAKA,IAC/B,cAACkb,GAAA,EAAD,CACI7hB,MAAO8D,EAAO8Z,WAAW1W,OAAOP,GAChCpF,SAAU,SAACia,GACP,IAAIyE,EAAS,eAAQnc,GACjB4d,EAAS,eAAQ5d,EAAO8Z,WAAW1W,QACvCwa,EAAU/a,GAAK6U,EAAEzb,OAAOC,MACxBigB,EAAUrC,WAAW1W,OAASwa,EAC9B5C,EAAUmB,IAEd/d,MAAOic,GAAIxX,GAAKwX,GAAIxX,GAAKA,EAT7B,SAWK7C,EAAO+a,WAAWlY,GAAG8C,QAAQ/C,KAAI,SAAC6W,GAAD,OAC9B,cAACuE,GAAA,EAAD,CAAU9hB,MAAOud,EAAjB,SAAqBY,GAAIZ,GAAKY,GAAIZ,GAAIA,cAM9D,IAAK,MACD,OACI,sBACI/b,MAAO,CACHuR,QAAS,eACT0O,MAAO,OACPxP,gBAAiB,UACjBE,YAAa,SALrB,UAQI,cAACgD,GAAA,EAAD,CAAYpO,GAAG,kBAAkB0O,cAAY,EAA7C,SACK0I,GAAIxX,GAAKwX,GAAIxX,GAAKA,IAEvB,cAACob,GAAA,EAAD,CACIvgB,MAAO,CAAEgd,SAAU,KACnBxe,MAAO8D,EAAO8Z,WAAW1W,OAAOP,GAChCuP,kBAAgB,kBAChB8L,kBAAkB,OAClBC,KAAM,EACNC,OAAK,EACL/e,IAAKW,EAAO+a,WAAWlY,GAAGxD,IAC1BC,IAAKU,EAAO+a,WAAWlY,GAAGvD,IAC1B7B,SAAU,SAACia,EAAG/C,GACV,IAAIwH,EAAS,eAAQnc,GACjB4d,EAAS,eAAQ5d,EAAO8Z,WAAW1W,QACvCwa,EAAU/a,GAAK8R,EACfwH,EAAUrC,WAAW1W,OAASwa,EAC9B5C,EAAUmB,SAK9B,IAAK,QACD,OACI,qBACIze,MAAO,CACHuR,QAAS,eACT0O,MAAO,OACPxP,gBAAiB,UACjBE,YAAa,SALrB,SAQI,cAACrQ,EAAA,EAAD,CACIC,QACI,cAACogB,GAAA,EAAD,CACIlgB,QAAS6B,EAAO8Z,WAAW1W,OAAOP,GAClCpF,SAAU,SAACia,GACP,IAAIyE,EAAS,eAAQnc,GACjB4d,EAAS,eACN5d,EAAO8Z,WAAW1W,QAEzBwa,EAAU/a,GAAK6U,EAAEzb,OAAOkC,QACxBge,EAAUrC,WAAW1W,OAASwa,EAC9B5C,EAAUmB,MAItB/d,MAAOic,GAAIxX,GAAKwX,GAAIxX,GAAKA,MAIzC,QACI,OAAO,8BAKnB,qBAAKnF,MAAO,CAAEyQ,gBAAiB,0B,wCGxV/D,SAASzU,GAAMC,GACb,OAAO,cAAC,IAAD,aAAUC,UAAW,EAAGC,QAAQ,UAAaF,IAGtD,IAAMG,GAAYC,aAAW,SAAC+T,GAAD,MAAY,CACvC7T,OAAQ,CACNA,OAAQ6T,EAAMQ,QAAQ,IAExBgQ,aAAc,CACZjQ,YAAaP,EAAMQ,QAAQ,QAG/B,SAASkF,GAAW7Z,GAClB,YAA6B+W,IAAzB/W,EAAM8Z,SAAS3W,SACTnD,EAAM8Z,SAAS3W,MAAMC,MAIjC,SAASwhB,GAAK5kB,GACZ,IAAMa,EAAUV,KACVQ,EAAUC,cAChB,EAAwBE,oBAAS,GAAjC,mBAAOW,EAAP,KAAaC,EAAb,KACA,EAA0BZ,mBAASd,EAAM4C,KAAK0V,OAA9C,mBAAOA,EAAP,KAAcuM,EAAd,KACA,EAAsC/jB,mBAASd,EAAM4C,KAAK2V,aAA1D,mBAAOA,EAAP,KAAoBuM,EAApB,KAEA,EAA8BhkB,oBAAS,GAAvC,mBAAOe,EAAP,KAAgBC,EAAhB,KACA,EAAgChB,mBAAS,IAAzC,mBAAOiB,EAAP,KAAiBC,EAAjB,KACA,EAAkClB,mBAAS,WAA3C,mBAAOmB,EAAP,KAAkBC,EAAlB,KACA,EAA8BpB,mBAASikB,IAAvC,mBAAOxS,EAAP,KAAgByS,EAAhB,KACA,EAAgClkB,oBAAS,GAAzC,mBAAOmkB,EAAP,KAAiBC,EAAjB,KACA,EAA8BpkB,oBAAS,GAAvC,mBAAO2Y,EAAP,KAAgB0L,EAAhB,KAEA,EAAsCrkB,oBAAS,GAA/C,mBAAOskB,EAAP,KAAoBC,GAApB,KAEA,GAAoBvkB,mBAASd,EAAM4C,KAAK0G,IAAxC,qBAAOA,GAAP,MAAWgc,GAAX,MACMC,GAAW7R,mBAEjB,GAA4B1T,EAAM4C,KAA5B7B,GAAN,GAAMA,KAAM+B,GAAZ,GAAYA,KAEN0iB,IAFN,GAAkBpiB,MAEA,uCAAG,wCAAAV,EAAA,6DACnBgU,QAAQC,IAAI,mBACR8O,EAAclT,EACdmT,EAAMpc,GAHS,SAMT3J,EAASgD,KAAK,cAAe,CACrCG,QACA2iB,cACAnN,QACAC,cACAxX,QACA0Y,UACAiM,QAbiB,oBAKjB9iB,KAAQC,EALS,EAKTA,QAAS0T,EALA,EAKAA,UAAWoP,EALX,EAKWA,MAUzB9iB,GAkBHb,EAAY,8BACZE,EAAa,WACbJ,GAAW,IAnBO,IAAdyU,GACFvU,EAAY,6CACZE,EAAa,QACbJ,GAAW,IAEY,IAAdyU,GAETvU,EAAY,oDACZE,EAAa,SACbJ,GAAW,KAGXE,EAAY,4BAAD,OAA6BuU,IACxCrU,EAAa,SACbJ,GAAW,IAQfwjB,GAAMK,GACNjP,QAAQC,IAAI,kBACZjV,GAAQ,GAxCW,4CAAH,sDA8DP,IAAP4H,KAAyB,IAAb2b,GAnBJ,uCAAG,oCAAAviB,EAAA,sEAGH/C,EAASgD,KAAK,cAAe,CACrC2G,QAJW,oBAEX1G,KAAQC,EAFG,EAEHA,QAAS0T,EAFN,EAEMA,UAAWtN,EAFjB,EAEiBA,IAIzBpG,GAKHb,EAAY,qBACZE,EAAa,WACbJ,GAAW,GACXkjB,EAAW/b,EAAG,SACdic,GAAY,KARZljB,EAAY,qBAAD,OAAsBuU,IACjCrU,EAAa,SACbJ,GAAW,IATA,2CAAH,oDAoBV8jB,GAEER,IACFI,KACAH,IAAe,IAWjB,OACE,sBAAKthB,MAAO,CAAE6N,UAAW,UAAzB,UACE,cAACpO,EAAA,EAAD,CACE/B,KAAMI,EACN4B,iBAAkB,IAClBC,QAAS,WACP5B,GAAW,IAJf,SAOE,cAAC,GAAD,CACE4B,QAAS,WACP5B,GAAW,IAEb6B,SAAU1B,EAJZ,SAMGF,MAGL,sBAAKgC,MAAO,CAAEkR,UAAW,OAAzB,UACE,cAAC0E,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,YACNE,QAASzD,EAAQue,OALnB,SAOE,cAAC,KAAD,MAGF,cAACvF,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,YACNC,SAA6C,IAAnC2f,OAAO+B,QAAQtT,GAASpN,OAClCf,QAAS,WACPmhB,GAAS3R,QAAQ4N,gBACjB9f,GAAQ,IARZ,SAWE,cAAC,KAAD,MAEF,cAACiY,GAAA,EAAD,CACE7Q,KAAK,QACL5I,QAAQ,YACRgE,MAAM,YACNE,QAAS,WACHmhB,GAAS3R,SACX2R,GAAS3R,QAAQ4N,gBAEdlJ,GAAUC,GAGb4M,GAAW,GACXE,IAAe,IAHf3jB,GAAQ,IATd,SAqBE,cAAC,KAAD,SAGJ,cAACgD,EAAA,EAAD,CACEjD,KAAMA,EACNiC,QAAS,WACPhC,GAAQ,IAHZ,SAME,qCACE,sBAAK6B,UAAU,SAAf,UACE,cAACK,EAAA,EAAD,CACEa,MAAM,QACNvE,QAAQ,SACR4lB,KAAM,EACNjiB,YAAY,QACZkiB,aAAa,GACbxjB,MAAO+V,EACPxU,SAAU,SAACzB,GAELA,EAAMC,OAAOC,MAAM4C,QAAU,IAC/B0f,EAASxiB,EAAMC,OAAOC,UAI5B,cAACqB,EAAA,EAAD,CACE0F,GAAG,kBACH7E,MAAM,cACNvE,QAAQ,SACR8lB,WAAS,EACTniB,YAAY,cACZkiB,aAAa,GACbxjB,MAAOgW,EACPzU,SAAU,SAACzB,GACLA,EAAMC,OAAOC,MAAM4C,QAAU,IAC/B2f,EAAeziB,EAAMC,OAAOC,UAIlC,cAACoX,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,YACRgE,MAAM,YACNE,QAASohB,GACTrhB,UAAWmU,IAAUC,EANvB,SAQE,cAAC,KAAD,SAGJ,qBAAKhV,UAAU,UAAf,SACE,cAACc,EAAA,EAAD,CACEC,QACE,cAACC,EAAA,EAAD,CACEC,QAASiV,EACT3V,SAAU,kBAAMqhB,GAAY1L,IAC5B1Y,KAAK,uBAGT0D,MAAM,+BAKD,IAAZ5C,EACC,cAAC8Q,GAAD,IAEA,cAAC,GAAD,CACEnS,MAAM,SACNuQ,OAAO,QACPgD,IAAKwR,GACLhT,QAASrI,GAAUqI,GACnBjI,KA/IK,SAACiI,GACZmE,QAAQC,IAAI,kBACZqO,EAAW7a,GAAUoI,UA2JV0T,OARf,SAAkBjmB,GAChB,OACE,mCACG6Z,GAAW7Z,GAAS,cAAC4kB,GAAD,CAAMhiB,KAAM5C,EAAM8Z,SAAS3W,QAAY,cAACyW,GAAD,OC/RrDsM,GAKI,OALJA,GAMK,MANLA,GAOD,CAACthB,GAAI,IAAIC,GAAG,KAPXqhB,GAQL,CAACtgB,EAAG,IAAIugB,EAAE,KARLD,GASH,GATGA,GAUJ,UAVIA,GAWF,YAXEA,GAYP,MAGOE,GAAM,CAClBC,MAAO,CAAC,uCAAU,kCAClBvZ,MAAO,CAAC,uCAAU,8BAClBgB,WAAY,CAAC,uCAAU,oDACvBkC,QAAS,CAAC,uCAAU,4DACpBqC,WAAY,CAAC,mDAAY,0DAEzBiU,KAAM,CAAC,uCAAU,+BACjBC,IAAK,CAAC,eAAM,6BAGAC,GACJ,yDC5BM,OAA0B,iCCA1B,OAA0B,iCCA1B,OAA0B,gCCA1B,OAA0B,iCCQnCC,GAAc,CAAC,WAAY,WAAY,WAGvCC,GAAe,CACnB,WAAYC,GACZ,WAAYC,GACZ,UAAWC,GACX,WAAYC,IAGRC,GAAS,GAETC,GAAkBC,QAAQC,IAXR,CAAC,WAAY,WAAY,UAAW,YAWRje,K,8FAGpD,WAA6BlI,GAA7B,yBAAA2B,EAAA,yDACQykB,EAAQ,IAAIC,QACdC,EAAWX,GAAa3lB,IACfumB,SAAS,QAHxB,iCAIuB1nB,IAAM2nB,IAAIb,GAAa3lB,IAJ9C,OAIUymB,EAJV,OAKUC,GAAM,IAAIC,WAAYC,gBAAgBH,EAAK5kB,KAAM,aACjDglB,EAAUH,EAAII,qBAAqB,OAAO,IACxCC,aAAa,QAAS,QAC9BF,EAAQE,aAAa,SAAU,QACzBC,EAASC,MAAK,IAAIC,eAAgBC,kBAAkBN,IAC1DP,EAAW,6BAA+BU,EAV9C,yBAYQ,IAAId,SAAQ,SAACkB,GACjBhB,EAAMiB,OAAS,kBAAMD,KACrBhB,EAAMkB,IAAMhB,KAdhB,QAgBEN,GAAOhmB,GAAQomB,EAhBjB,6C,sBAmBO,IAEMmB,GAAW,SAACC,GAAD,OAAexB,GAAOwB,ICW9C,SAASC,GAAYC,EAASC,EAAIriB,GACjC,GAAKA,EAAOsiB,aAAZ,CACA,IAAM/iB,EAAIgB,EAASG,UACf6hB,EAAU,EAAEhiB,EAASC,SAASjC,EAAIgC,EAASE,QAAQlC,EAAEgB,EAAE,EAAI8iB,EAAG9jB,EAC9DikB,EAAU,EAAEjiB,EAASC,SAAShC,EAAI+B,EAASE,QAAQjC,EAAEe,EAAE,EAAI8iB,EAAG7jB,EAClE4jB,EAAQle,UAAUqe,EAAQC,IAI3B,SAASC,GAAWL,EAASC,EAAIK,GAA4B,IAApBC,EAAmB,uDAAZ,WACvCpkB,EAAS8jB,EAAT9jB,EAAGC,EAAM6jB,EAAN7jB,EACD+B,EAASG,UAEnB0hB,EAAQne,OACRme,EAAQle,UAAU3F,EAAGC,GAGrB4jB,EAAQQ,UACPX,GAASU,IACR9C,IACAA,GACkB,EAAnBA,GACmB,EAAnBA,IAGDuC,EAAQxd,UAGMkT,OA3Ef,SAAgB9T,EAAKkI,EAASlM,GAC7B,IAAI4C,EAAMsJ,EAAQtJ,IACdiC,EAAUqH,EAAQrH,QAClBwd,EAAKriB,EAAOqiB,GAAGQ,qBACbtjB,EAAIgB,EAASG,UAGnB6L,GAAMvI,GAGNA,EAAIY,UACJZ,EAAIC,OAGJD,EAAIO,UAAYhE,EAASI,WACzBqD,EAAI8e,SAAS,GAAI,IAAKviB,EAASE,QAAQlC,EAAEgB,EAAE,EAAGgB,EAASE,QAAQjC,EAAEe,EAAE,GAE/DS,EAAOsiB,cACVte,EAAIiD,MAAM4Y,GAAetgB,EAAGsgB,GAAeC,GAC3C9b,EAAIE,UAAU2b,GAAmBthB,EAAGshB,GAAmBrhB,KAGvDwF,EAAIiD,MAAM,IAAK,KACfjD,EAAIE,WAAW,GAAI,KAIpBF,EAAIC,OACJD,EAAIE,UAAU3D,EAASC,SAASjC,EAAGgC,EAASC,SAAShC,GACrD2jB,GAAYne,EAAKqe,EAAIriB,GACrB0M,GAAQ1I,EAAKpB,EAhCE,MAiCfoB,EAAIY,UAGJZ,EAAIC,OACJke,GAAYne,EAAKqe,EAAIriB,GACrB,IAAK,IAAIG,EAAI,EAAGA,EAAII,EAASD,SAAUH,IAAK,CAEjC,IAANA,GAASsiB,GAAWze,EAAKqe,EAAIA,EAAIriB,EAAO2iB,MAC5C,IAAK,IAAIja,EAAI,EAAGA,EAAI7D,EAAQ/F,OAAQ4J,IAC/B7D,EAAQ6D,GAAG/E,MAAMoB,QAAU5E,GAAG0E,EAAQ6D,GAAG9B,KAAK5C,GAGpDA,EAAIY,WCrBL,SAASme,GAAOC,EAAQX,GAEpB,OAAKW,EAAOzkB,EAAI8jB,EAAGlgB,IAAI5D,EADS,KACQykB,EAAOzkB,EAAI8jB,EAAGlgB,IAAI5D,EAD1B,KAErBykB,EAAOxkB,EAAI6jB,EAAGlgB,IAAI3D,EAFQ,KAESwkB,EAAOxkB,EAAI6jB,EAAGlgB,IAAI3D,EAF3B,IC3BzC,IAAMe,GAAIgB,EAASG,UACfuiB,GAAY,GA2BT,SAASC,GAAYljB,EAAQkM,EAAS8O,GAC3C,IAAQpY,EAAQsJ,EAARtJ,IAEFugB,EAAK3d,KAAKC,MAAQzF,EAAOojB,gBAsBjC,SAAuBpjB,EAAQ4C,EAAKoY,GAClC,MAAehb,EAAOqiB,GAAGQ,qBAAnBtkB,EAAN,EAAMA,EAAGC,EAAT,EAASA,EAEH6kB,GADKrjB,EAAOqiB,GAAbA,GACa9hB,EAASC,SAASjC,EAAIshB,IAClCyD,EAAa/iB,EAASC,SAASjC,EAAIgC,EAASE,QAAQlC,EAAIgB,GAAIsgB,GAC5D0D,EAAahjB,EAASC,SAAShC,EAAIqhB,GACnC2D,EAAajjB,EAASC,SAAShC,EAAI+B,EAASE,QAAQjC,EAAIe,GAAIsgB,IAG9DthB,EAAI8kB,GAAa9kB,EAAI+kB,GAAc9kB,EAAI+kB,GAAc/kB,EAAIglB,KAC3DxjB,EAAOqiB,GAAGoB,gBACNllB,EAAI8kB,EACNrjB,EAAOqiB,GAAGqB,QAAQ,IAAIplB,EAAK+kB,EAAY9jB,GAAGf,IACnCD,EAAI+kB,EACXtjB,EAAOqiB,GAAGqB,QAAQ,IAAIplB,EAAKglB,EAAa/jB,GAAGf,IACpCA,EAAI+kB,EACXvjB,EAAOqiB,GAAGqB,QAAQ,IAAIplB,EAAKC,EAAGglB,EAAahkB,KACpCf,EAAIglB,GACXxjB,EAAOqiB,GAAGqB,QAAQ,IAAIplB,EAAKC,EAAG,QAIlC0kB,GAAUU,MAAK,SAAArZ,GACb,GAAI/L,EAAIshB,GAAmBtf,EAASC,SAASjC,EAAK+L,EAAM/L,EAAKgB,IACxDhB,EAAIshB,GAAmBtf,EAASC,SAASjC,GAAK+L,EAAM/L,EAAI,GAAKgB,IAC7Df,EAAIqhB,GAAmBtf,EAASC,SAAShC,EAAK8L,EAAM9L,EAAKe,IACzDf,EAAIqhB,GAAmBtf,EAASC,SAAShC,GAAK8L,EAAM9L,EAAI,GAAKe,GAGhE,OAFAS,EAAOqiB,GAAGoB,gBACVzjB,EAAOqiB,GAAGuB,cAAc,IAAItlB,EAAKiC,EAASC,SAASjC,GAAK+L,EAAM/L,EAAI,IAAOgB,GAAGgB,EAASC,SAAShC,GAAK8L,EAAM9L,EAAI,IAAOe,MAC7G,KAKX,IAAIskB,EAAOjlB,KAAKyZ,OAAO9Z,EAAIgC,EAASC,SAASjC,GAAKgB,IAC9CukB,EAAOllB,KAAKyZ,OAAO7Z,EAAI+B,EAASC,SAAShC,GAAKe,IAElD,GAAMskB,EAAO,GAAKA,EAAOtjB,EAASE,QAAQlC,GAAOulB,EAAO,GAAKA,EAAOvjB,EAASE,QAAQjC,EAAK,OAC1F,IAAMulB,EAAYnhB,EAAIkhB,GAAMD,GAAMlmB,KAClCqC,EAAOqiB,GAAG2B,gBACNhkB,EAAOqiB,GAAG4B,aACZjkB,EAAOqiB,GAAG6B,YAAY,GACbH,EAAUhX,SAAS,SAAWgX,EAAUhX,SAAS,UAAYgX,EAAUhX,SAAS,OACzF/M,EAAOqiB,GAAG6B,YAAY,GACfH,EAAUhX,SAAS,SAC1B/M,EAAOqiB,GAAG6B,YAAY,GACfH,EAAUhX,SAAS,OAC1B/M,EAAOqiB,GAAG6B,YAAY,IACfH,EAAUhX,SAAS,SAC1BiO,GAAW,8BAAC,eAAUhb,GAAX,IAAmBmkB,UAAWtE,GAAkB5iB,IAAK8iB,GAAG,KAAUqE,QAAS5e,KAAKC,MAAOsL,SAASvL,KAAKC,MAAMzF,EAAOqkB,eAE3HN,EAAUhX,SAAS,QACrBiO,GAAW,8BAAC,eAAUhb,GAAX,IAAmBmkB,UAAWtE,GAAc5iB,IAAK8iB,GAAG,IAASqE,QAAS5e,KAAKC,MAAOsL,SAASvL,KAAKC,MAAMzF,EAAOqkB,eAE1HrkB,EAAOqiB,GAAGiC,gBA1EVC,CAAcvkB,EAAQ4C,EAAKoY,GA+E7B,SAAwBhb,EAAQkM,EAAS8O,GASvC,IARA,IAGIwJ,EAAYC,EAHX5f,EAAgBqH,EAAhBrH,QAASjC,EAAOsJ,EAAPtJ,IACRyf,EAAOriB,EAAPqiB,GACF4B,GAAa,EAEbS,EAAmB9lB,KAAK+lB,iBACxBC,GAAY,EACZC,EAAgB,EAEX1kB,EAAI,EAAGA,EAAI0E,EAAQ/F,OAAQqB,IAAK,CACvC,GAAI0E,EAAQ1E,GAAG2G,UAAW,2BACxB,IAAMN,EAAS3B,EAAQ1E,GAAG2G,UAAU,CAAEnJ,KAAM,SAAUwE,IAAKkgB,EAAGyC,IAAKziB,EAAGwd,KACtE,GAAIrZ,EAAOuG,SAAS,QAAS,iBAC7BsV,EAAG2B,gBAEc,UAAXxd,GAAiC,eAAXA,GAAsC,WAAXA,GACzC,gBAAXA,GAAuC,cAAXA,GAA4Boe,EAOvC,aAAXpe,GAAoC,mBAAXA,GAA0C,mBAAXA,GACpD6b,EAAGyC,IAAIhmB,OAAQ+F,EAAQ1E,GAAGgC,KAAOuiB,GAC7B,mBAAXle,GAA6B3B,EAAQ1E,GAAGgL,QAC5C8Y,GAAa,EACbS,EAAoBrC,EAAGyC,IAAIhmB,OAAQ+F,EAAQ1E,GAAGgC,KAC9CqiB,EAAarkB,EACbskB,EAAc5f,EAAQ1E,GAAGgC,IACzBnC,EAAOqiB,GAAG6B,YAAY,IACF,aAAX1d,EAAuB3B,EAAQ1E,GAAG4kB,OAAOlgB,GAChC,WAAX2B,EAAqB6b,EAAGhe,OAAOQ,EAAQ1E,GAAG4G,SAASlC,IACxC,aAAX2B,GAAyBqe,EAAgB,KAChDxC,EAAG2C,YAAYngB,EAAQ1E,GAAGiD,OAAOgC,UAAW,IAC5Cyf,KACoB,eAAXre,EAAyB3B,EAAQ1E,GAAG8kB,KAAK5C,GAChC,SAAX7b,EAAmB6b,EAAG6C,kBACX,kBAAX1e,EAET6b,EAAGyC,IAAMzC,EAAGyC,IAAIjlB,IAAIgF,EAAQ1E,GAAG6G,mBACV,UAAXR,GAAiC,UAAXA,GAAkC,eAAXA,GAAsC,YAAXA,GAAmC,eAAXA,GACxGwU,GAAW,8BAAC,eAAUhb,GAAX,IAAmBmkB,UAAWtE,GAAmB5iB,IAAK8iB,GAAIvZ,GAAQ4d,QAAS5e,KAAKC,MAAOsL,SAASvL,KAAKC,MAAMzF,EAAOqkB,gBAzB9G,cAAX7d,GAAwB3B,EAAQ1E,GAAGxD,KAAKkI,EAASjC,EAAKyf,EAAGlgB,KAC7DyiB,GAAY,EACZvC,EAAGoB,gBACHpB,EAAGuB,cAAc/e,EAAQ1E,GAAGgC,MA0Bf,UAAXqE,EACFxG,EAAOqiB,GAAG6B,YAAY,IACJ,QAAX1d,GACPxG,EAAOqiB,GAAG6B,YAAY,IAvCA,GAEK,SAyC7BD,IAAeW,GACjBvC,EAAG8C,eAAeX,EAAaC,GAC3BR,GACJ5B,EAAG+C,gBAtILC,CAAerlB,EAAQkM,EAAS8O,GAChChb,EAAOojB,eAAiB5d,KAAKC,MAO/B,SAAczF,GACZ,IAAMslB,EAA8CtlB,EAA9CslB,UAAWC,EAAmCvlB,EAAnCulB,WAAYC,EAAuBxlB,EAAvBwlB,UAAWC,EAAYzlB,EAAZylB,QACnCC,EAAiB,EAAVC,EAAa,EACrBL,IAAWK,GAAS,GACpBF,IAASE,GAAS,GAClBJ,IAAYG,GAAS,GACrBF,IAAWE,GAAS,GACxB1lB,EAAOqiB,GAAG1lB,KAAK,IAAI2B,EAAKonB,EAAOC,IAb/BhpB,CAAKqD,GAELA,EAAOqiB,GAAGxF,OAAOsG,GCxCnB,IAIqByC,G,WACnB,WAAY3iB,EAAI4iB,EAAUtnB,EAAGC,GAAI,oBAC/BC,KAAKwE,GAAKA,EACVxE,KAAKqmB,IAAM,IAAIxmB,EAAKC,EAAGC,GACvBC,KAAKqnB,SAAW,IAAIxnB,EAAK,EAAG,GAC5BG,KAAKonB,SAAWA,EAChBpnB,KAAKsnB,MAAQ,EACbtnB,KAAK0D,IAAM,IAAI7D,EAAK,EAAG,GAEvBG,KAAKunB,SAZQ,IAabvnB,KAAKwnB,aAAe,EACpBxnB,KAAKynB,EAAI,EACTznB,KAAK0nB,MAAQ,IAAI7nB,EAAK,EAAG,GACzBG,KAAK2nB,aAAe,IAAI9nB,EAAK,EAAG,GAChCG,KAAK4nB,QAAU,IAAI/nB,EAAKC,EAAGC,GAC3BC,KAAK6nB,eAAiB,KACtB7nB,KAAK8nB,gBAAkB,IAAIjoB,EAAK,EAAG,G,0CAIrC,SAAO6kB,GAKL,OAHAA,GAAU,IACV1kB,KAAK+nB,UAAUrD,GACf1kB,KAAK0D,IAAM1D,KAAKqmB,IACT,O,uBAGT,SAAU3B,GAER,IAAM/jB,EAAKX,KAAKqnB,SAAShmB,OAAO4C,IAAK9D,KAAKmJ,IAAItJ,KAAKqnB,SAAShnB,SAAS,IACrEL,KAAK2nB,aAAe3nB,KAAK0nB,MAAM/jB,IAAIhD,EAAGsD,IAAIjE,KAAKunB,WAAWjnB,IAAIN,KAAKynB,GAGnEznB,KAAKqnB,SAAWrnB,KAAKqnB,SAASjmB,IAAIpB,KAAK2nB,aAAa1jB,IAAIygB,IAExD1kB,KAAKgoB,gBAGLhoB,KAAKqmB,IAAMrmB,KAAKqmB,IAAIjlB,IAAKpB,KAAKqnB,SAASpjB,IAAIygB,IAC3C1kB,KAAK0nB,MAAQ,IAAI7nB,EAAK,EAAG,K,2BAG3B,WACMG,KAAKqnB,SAAShnB,SA9CD,MA+CjBL,KAAKqnB,SAAWrnB,KAAKqnB,SAAShmB,OAAO4C,IA/CpB,Q,oBAkDnB,SAAOnE,EAAGC,GACR,GAAKA,EAGEC,KAAKqmB,IAAM,IAAIxmB,EAAKC,EAAGC,OAHvB,CACL,IAAMkoB,EAASnoB,EACfE,KAAKqmB,IAAM4B,K,yBAIf,SAAYlnB,EAAKmnB,GACf,OAAQnnB,GACN,IAAK,OACHf,KAAKqnB,SAAWrnB,KAAKqnB,SAASjmB,IAAI,IAAIvB,EAAK,EAAGqoB,IAC9C,MACF,IAAK,QACHloB,KAAKqnB,SAAWrnB,KAAKqnB,SAASjmB,IAAI,IAAIvB,EAAKqoB,EAAK,IAChD,MACF,IAAK,OACHloB,KAAKqnB,SAAWrnB,KAAKqnB,SAASjmB,IAAI,IAAIvB,GAAMqoB,EAAK,IACjD,MACF,IAAK,KACHloB,KAAKqnB,SAAWrnB,KAAKqnB,SAASjmB,IAAI,IAAIvB,EAAK,GAAIqoB,O,4BAKrD,SAAe1jB,EAAIwhB,GACjBxhB,EAAKA,EAAG2jB,WAEmB,OAAxBnoB,KAAK6nB,gBAA2B7nB,KAAK6nB,iBAAmBrjB,IACzDxE,KAAK6nB,eAAiBrjB,EACtBxE,KAAK8nB,gBAAkB9B,GAEtBhmB,KAAK6nB,iBAAmBrjB,IACzBxE,KAAKqmB,IAAMrmB,KAAKqmB,IAAIjlB,IAAK4kB,EAAYriB,IAAI3D,KAAK8nB,kBAC9C9nB,KAAK8nB,gBAAkB9B,K,2BAI3B,WACEhmB,KAAK6nB,eAAiB,O,wBAGxB,WACE,MAA4B,OAAxB7nB,KAAK6nB,iB,2BAKX,SAAcrqB,GACZ,IAAM4qB,EAAU,IAAIvoB,EAAKG,KAAKqmB,IAAIvmB,EAAItC,EAAOsC,EAAGE,KAAKqmB,IAAItmB,EAAIvC,EAAOuC,GAC9DsoB,EAAQloB,KAAKmoB,MAAMF,EAAOroB,EAAGqoB,EAAOtoB,IAErC,EAAI,EAAIK,KAAKK,GAAK6nB,GAASA,GAAS,EAAI,EAAIloB,KAAKK,GACpDR,KAAKilB,QAAQ,IAAIplB,EAAKG,KAAKqmB,IAAIvmB,EAAG,QAC1B,EAAI,EAAIK,KAAKK,GAAK6nB,GAASA,EAAQ,EAAI,EAAIloB,KAAKK,GACxDR,KAAKilB,QAAQ,IAAIplB,EAAK,EAAGG,KAAKqmB,IAAItmB,IAC3B,EAAI,EAAII,KAAKK,GAAK6nB,GAASA,EAAQ,EAAI,EAAIloB,KAAKK,GACvDR,KAAKilB,QAAQ,IAAIplB,EAAKG,KAAKqmB,IAAIvmB,EAAG,IAC3B,EAAI,EAAIK,KAAKK,GAAK6nB,IAAW,EAAI,EAAIloB,KAAKK,GAAK6nB,GAASA,EAAQ,EACvEroB,KAAKilB,QAAQ,IAAIplB,EAAK,KAAMG,KAAKqmB,IAAItmB,IAErC6R,QAAQC,IAAI,mB,qBAahB,SAAQrU,GACN,IAAMqK,EAAS,IAAIhI,EAAKG,KAAKqmB,IAAIvmB,EAAItC,EAAOsC,EAAGE,KAAKqmB,IAAItmB,EAAIvC,EAAOuC,GAC7DwoB,EAAmBpoB,KAAKmoB,MAAMzgB,EAAO9H,EAAG8H,EAAO/H,GAAK,GAAMK,KAAKK,GAC/DgoB,EAAM3gB,EAAO5D,KAAK,GAAG5C,OACrBonB,EAAetoB,KAAKuoB,IAAI,EAAIH,GAAoBC,EAAI1oB,EAAIK,KAAKwoB,IAAI,EAAIJ,GAAoBC,EAAIzoB,EAC7F6oB,EAAezoB,KAAKwoB,IAAI,EAAIJ,GAAoBC,EAAI1oB,EAAIK,KAAKuoB,IAAI,EAAIH,GAAoBC,EAAIzoB,EACnGC,KAAKqnB,SAAW,IAAIxnB,EAAK4oB,EAAcG,GAAc3kB,IAAI,IACzDjE,KAAKgoB,kB,2BAGP,SAActD,GACZ1kB,KAAKqmB,IAAMrmB,KAAK4nB,U,yBAGlB,SAAYiB,GACV7oB,KAAKwnB,aAAexnB,KAAKunB,SACzBvnB,KAAKunB,SAAWvnB,KAAKunB,SAAWsB,I,6BAElC,WACE7oB,KAAKunB,SAAWvnB,KAAKwnB,e,2BAEvB,WACExnB,KAAKwnB,aAAexnB,KAAKunB,SACzBvnB,KAAKunB,SAnJQ,M,2BAsJf,WACEvnB,KAAK4nB,QAAU5nB,KAAKqmB,M,kBAGtB,SAAKmC,GACHxoB,KAAK0nB,MAAQc,EAAIvkB,IA5JF,O,gCAoKjB,WACE,MAAO,CACLO,GAAIxE,KAAKwE,GACT6hB,IAAKrmB,KAAKqmB,IACVvmB,EAAGE,KAAKqmB,IAAIvmB,EACZC,EAAGC,KAAKqmB,IAAItmB,EACZsnB,SAAUrnB,KAAKqnB,c,KCSNyB,I,OAtKQ,SAAC5tB,GAEpB,MAA8Bc,mBAASd,EAAMuS,SAA7C,mBAAOA,EAAP,KAAgByS,EAAhB,KACA,EAA8BlkB,oBAAS,GAAvC,mBAAO+sB,EAAP,KAAgBC,EAAhB,KACAna,oBAAS,sBAAE,sBAAAjR,EAAA,sDLuBqBskB,GKtBX3nB,KAAMyuB,GAAW,IAD3B,4CAIX,IAAIra,EAAYC,mBAEVqa,EAAe,CACjBrF,GAAI,IAAIuD,GAAO,EAAG,OAAQ,EAAG,GAC7BvB,UAAW7e,KAAKC,MAChB2e,QAAS5e,KAAKC,MACdsL,SAAU,EACVoT,UAAW,QACXxB,KAAM,WACN1lB,IAAK,CAAC,SACNqlB,cAAc,EACdgD,WAAW,EACXC,YAAY,EACZC,WAAW,EACXC,SAAS,GAGb,EAA4BhrB,mBAASitB,GAArC,mBAAO1nB,EAAP,KAAegb,EAAf,KAoBA,SAAS2M,EAAUC,GACfC,SAASC,eAAeF,GAAMlqB,MAAMuR,QAAU,OAK9C+L,GAAU,8BAAC,eAAW0M,GAAZ,IAA0B/E,KAAM3iB,EAAO2iB,KAAOwB,UAAWtE,GAAkByC,cAAc,OAGvG,SAASyF,EAASH,GACdC,SAASC,eAAeF,GAAMlqB,MAAMuR,QAAU,QA3BlD3B,qBAAU,WAEFtN,EAAOmkB,YAActE,IACrB7f,EAAOmkB,YAActE,KAGrBlmB,EAAMquB,UACFhoB,EAAOokB,QAAUpkB,EAAOqkB,UACxBrkB,EAAOmkB,YAActE,IAGzBkI,EAAS,YACTpJ,GAAY,kBAAK9a,GAAUC,GAAUoI,UAE1C,CAAClM,IAgBJsN,qBAAU,WACN,GAAKka,EAAL,CAEA,IAGIpM,EACAC,EAKA4M,EAAwBxiB,EAAKzM,EAAMkvB,EATjC1b,EAASY,EAAUG,QACnBvJ,EAAMwI,EAAOgB,WAAW,MAyC9B,OArCA4N,EC/EO,SAAoBE,EAAOtb,EAAQgb,EAAW9O,GAE5D,IAAMic,EAAU,CAACC,GAAG,OAAQC,GAAG,KAAMC,GAAG,QAASC,GAAG,QAEpD,SAASC,EAAU9Q,GAClB,OAAQyQ,EAAQzQ,EAAE+Q,UACjB,IAAK,OACJzoB,EAAOslB,WAAY,EACnB,MACD,IAAK,QACJtlB,EAAOulB,YAAa,EACpB,MACD,IAAK,OACJvlB,EAAOwlB,WAAY,EACnB,MACD,IAAK,KACJxlB,EAAOylB,SAAU,GAKpB,SAASiD,EAAQhR,GAChB,OAAQyQ,EAAQzQ,EAAE+Q,UACjB,IAAK,OACJzoB,EAAOslB,WAAY,EACnB,MACD,IAAK,QACJtlB,EAAOulB,YAAa,EACpB,MACD,IAAK,OACJvlB,EAAOwlB,WAAY,EACnB,MACD,IAAK,KACJxlB,EAAOylB,SAAU,GAQpB,OAHAkD,OAAOjM,iBAAiB,UAAW8L,GACnCG,OAAOjM,iBAAiB,QAASgM,GAE1B,WACNC,OAAOhM,oBAAoB,UAAW6L,GACtCG,OAAOhM,oBAAoB,QAAS+L,IDoCX9L,CAAWpQ,EAAQxM,GF1EvC,SAAmBA,EAAQkM,GAChC,IAAQtJ,EAAiBsJ,EAAjBtJ,IAAKiC,EAAYqH,EAAZrH,QAGP+jB,EAAY,GAClBhmB,EAAI2R,SAAQ,SAACsU,EAAMrqB,GAAP,OAAcqqB,EAAKtU,SAAQ,SAACuU,EAAQvqB,GAC1CuqB,EAAOnrB,KAAKoP,SAAS,UAAU6b,EAAUjsB,KAAK,CAAE4B,IAAGC,YAEzD,MAAiBoqB,EAAUhqB,KAAKyZ,MAAMzZ,KAAKmL,SAAW6e,EAAU9pB,SAAxDP,EAAR,EAAQA,EAAGC,EAAX,EAAWA,EACXwB,EAAOqiB,GAAGhe,OAAO9D,EAASC,SAASjC,GAAKA,EAAI,IAAOgB,GAAGgB,EAASC,SAAShC,GAAKA,EAAI,IAAOe,IAExF0jB,GAAY,GACZrgB,EAAI2R,SAAQ,SAACsU,EAAMrqB,GAAP,OAAcqqB,EAAKtU,SAAQ,SAACuU,EAAQvqB,GAC1CuqB,EAAOnrB,KAAKoP,SAAS,UAAUkW,GAAUtmB,KAAK,CAAE4B,IAAGC,YAIzD,IAAK,IAAI2B,EAAI,EAAGA,EAAI0E,EAAQ/F,OAAQqB,IAC9B0E,EAAQ1E,GAAGmc,gBAAgBzX,EAAQ1E,GAAGmc,gBAAe,GAG3Dtc,EAAOqkB,UAAY7e,KAAKC,MACxBzF,EAAOojB,eAAiB5d,KAAKC,MEsDvBsjB,CAAU/oB,EAAQkM,GAkBd+b,EAAc,IAKH,GAJXjvB,EAAOwM,KAAKC,MACAzM,EACZ6jB,IAKA7c,EAAOmkB,YAActE,IAA0C,UAArB7f,EAAOmkB,WACjD/I,IAEqB,UAArBpb,EAAOmkB,WACP4D,EAAS,aAEe,UAArB/nB,EAAOmkB,WAAyBnkB,EAAOmkB,YAActE,IACxD7C,qBAAqB3B,GAElB,WACHD,IACA4B,qBAAqB3B,IAjCzB,SAASwB,IACLxB,EAAY0B,sBAAsBF,GAClCqG,GAAYljB,EAAQkM,EAAS8O,GAE7BvV,EAAMD,KAAKC,OACXyiB,EAAUziB,EAAMzM,GACFivB,IACVjvB,EAAOyM,EAAOyiB,EAAUD,EH3FzB,SAAgBpjB,EAASjC,EAAK5C,GAKzC,IAJA,IAAOqiB,EAAMriB,EAANqiB,GACD2G,EAAY,CAAC,iBAAiB,yBAA0B,sBAClD,MAAO,QAAS,UAAW,cAAe,SAAS,aAAc,YAAa,QAAS,UAE1F7oB,EAAI,EAAGA,EAAII,EAASD,SAAUH,IACnC,IAAK,IAAIuI,EAAI,EAAGA,EAAI7D,EAAQ/F,OAAQ4J,IAChC,IAAK1I,EAAOmkB,YAActE,IAClBkD,GAAOle,EAAQ6D,GAAGvG,IAAKkgB,IACvB2G,EAAUjc,SAASlI,EAAQ6D,GAAG/K,QAClCkH,EAAQ6D,GAAGmU,OAAQ,CACnB,IAAMrW,EAAS3B,EAAQ6D,GAAGmU,OAAOhY,EAASjC,GAC1C,OAAQ4D,EAAO7I,MACX,IAAK,UACDkH,EAAQlI,KAAK6J,EAAOvB,QACpB,MACJ,IAAK,UACDJ,EAAQqX,OAAOxT,IAAK,KG2E5BoU,CAAO5Q,EAAQrH,QAASqH,EAAQtJ,IAAK5C,GACrCipB,GAAQjlB,EAAKkI,EAASlM,OA0B/B,CAACgb,EAAWhb,EAAQkM,EAASsb,IAUhC,IARuB0B,EAefC,EACJ,8BAAK,yBAAQjsB,UAAU,eAAea,QAAS,WAAQ4qB,OAAOvtB,KAAK+kB,GAAa,WAA3E,UACD,qBAAK6B,IAAKC,GAAS,YAAYD,MAD9B,aAIT,OACI,qCACI,8BACI,wBAAQtU,IAAKN,EAAWnK,GAAG,iBACvB9I,MAAO0lB,GACPnV,OAAQmV,OAIhB,sBAAK3iB,UAAU,aAAa+F,GAAG,WAA/B,UACI,+BAAOjD,EAAOmkB,YACbnkB,EAAO/C,IAAI2F,KAAK,SAACsjB,GAAD,OAAO,4BAAIA,OAC5B,gCAhCWgD,EAgCUlpB,EAAO+Q,SA/B9B,GAAN,OAAUnS,KAAKyZ,MAAM6Q,EAAK,IAAO,IAC5BtC,WACAwC,SAAS,EAAG,KAFjB,cAE2BxqB,KAAKyZ,MAAO6Q,EAAK,IAAQ,IAC3CtC,WACAwC,SAAS,EAAG,SA4Bb,wBAAQlsB,UAAU,aAAaa,QAAS,WAAQ4pB,EAAU,aAA1D,uBACCwB,KAGL,sBAAKjsB,UAAU,aAAa+F,GAAG,YAA/B,UACI,mDACA,qBAAKxF,SAAW,SAACia,GAAM1X,EAAO2iB,KAAOjL,EAAEzb,OAAOC,OAA9C,SACOsrB,ELtHYpH,GKuHCxd,KAAI,SAACsf,GAAD,OAChB,kCACI,uBAAOvkB,KAAK,QAAQjD,KAAK,OAAOwB,MAAOgmB,IACvC,qBAAKF,IAAKC,GAASC,GAAWF,YAEjC,+BAET,wBAAQ9kB,UAAU,aAAaa,QAAU,WAAO4pB,EAAU,cAA1D,mBACCwB,U,0CEzJjB,SAASzvB,GAAMC,GACb,OAAO,cAAC,IAAD,aAAUC,UAAW,EAAGC,QAAQ,UAAaF,IAEtD,SAAS6Z,GAAW7Z,GAClB,YAA6B+W,IAAzB/W,EAAM8Z,SAAS3W,SACTnD,EAAM8Z,SAAS3W,MAAMC,MAIjC,IAAMjD,GAAYC,aAAW,SAAC+T,GAAD,MAAY,CACvC7T,OAAQ,CACNA,OAAQ6T,EAAMQ,QAAQ,IAExBgQ,aAAc,CACZjQ,YAAaP,EAAMQ,QAAQ,QAIzB+a,GAAO,SAAC1vB,GACZ,IAAMW,EAAUC,cACVC,EAAUV,KAChB,EAAwBW,oBAAS,GAAjC,mBAEA,GAFA,UAE8BA,oBAAS,IAAvC,mBAAOe,EAAP,KAAgBC,EAAhB,KACA,EAAgChB,mBAAS,IAAzC,mBAAOiB,EAAP,KAAiBC,EAAjB,KACA,EAAkClB,mBAAS,WAA3C,mBAAOmB,EAAP,KAAkBC,EAAlB,KACA,EAAgCpB,oBAAS,GAAzC,mBAAiBokB,GAAjB,WACA,EAA8BpkB,mBAAS,IAAvC,mBAAOyR,EAAP,KAAgByS,EAAhB,KACA,EAAwBlkB,mBAAS,IAAjC,mBAAO6uB,EAAP,KAAaC,EAAb,KAEA,EAA0B9uB,oBAAS,GAAnC,mBAAeuV,GAAf,WAEA,EAAwCrW,EAAM4C,KAAtC7B,EAAR,EAAQA,KAAmBuI,GAA3B,EAAcxG,KAAd,EAAoBM,MAApB,EAA2BkG,IAAIkQ,EAA/B,EAA+BA,KAEzBoM,EAAM,uCAAG,oCAAAljB,EAAA,sEAGH/C,EAASgD,KAAK,cAAe,CACrC2G,OAJW,oBAEX1G,KAAQC,EAFG,EAEHA,QAAS0T,EAFN,EAEMA,UAAWtN,EAFjB,EAEiBA,IAIzBpG,GAKHb,EAAY,qBACZE,EAAa,WACbJ,GAAW,GACXkjB,EAAW/b,EAAG,SACd2mB,EAAQ3mB,GACRic,GAAY,KATZljB,EAAY,qBAAD,OAAsBuU,IACjCrU,EAAa,SACbJ,GAAW,IATA,2CAAH,qDAwBN+tB,EAAgB,uCAAG,WAAOC,GAAP,mBAAAptB,EAAA,sEAGb/C,EAASgD,KAAK,wBAAyB,CAC/CmtB,aAJqB,oBAErBltB,KAAQC,EAFa,EAEbA,QAFa,EAEJ0T,UAInBG,QAAQC,IAAR,qBAA0B9T,IANH,2CAAH,sDAyCtB,OANA8Q,qBAAU,WAER0C,GAAQ,GACRuP,MACC,IAGD,sBAAK7hB,MAAO,CAAE6N,UAAW,UAAzB,UACE,cAACpO,EAAA,EAAD,CACE/B,KAAMI,EACN4B,iBAAkB,IAClBC,QAAS,WACP5B,GAAW,IAJf,SAOE,cAAC,GAAD,CACE4B,QAAS,WACP5B,GAAW,IAEb6B,SAAU1B,EAJZ,SAMGF,MAGL,sBAAKgC,MAAO,CAAEkR,UAAW,OAAzB,UACE,cAAC0E,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,YACNE,QAASzD,EAAQue,OALnB,SAOE,cAAC,KAAD,MAEF,eAACvF,GAAA,EAAD,CACEpW,UAAW1C,EAAQP,OACnBwI,KAAK,QACL5I,QAAQ,WACRgE,MAAM,YAJR,UAMY,cAATsV,EAAuB,cAAC,KAAD,IAAe,cAAC,KAAD,IAC7B,cAATA,EAAuB,iBAAmB,uBAGlC,KAAZjH,IAA8B,IAAZ1Q,EACjB,cAAC8Q,GAAD,IAEA,cAAC,GAAD,CACEnS,MAAM,SACNuQ,OAAO,QACPwB,QAASrI,GAAUqI,GACnB8b,UA1EU,SAAC0B,EAAMC,GACvB,GAAa,cAATxW,EAAJ,CAIA9C,QAAQC,IAAR,4BAAiCoZ,IACjC,IAAID,EAAQ,eAAQH,GACpBG,EAAS9Y,UAAUI,UAAY,EAE3B4Y,IACFF,EAAS9Y,UAAUG,UAAY,EAC1B2Y,EAASG,WAAW7c,SAASrS,IAChC+uB,EAASG,WAAWjtB,KAAKjC,IAIzB+uB,EAAS9Y,UAAUC,YAAc8Y,EAAO,KAAUC,IACpDF,EAAS9Y,UAAUC,YAAc8Y,EAAO,IACxCD,EAAS9Y,UAAUE,WAAanW,GAElC8uB,EAAiBC,QAlBfpZ,QAAQC,IAAR,6BAqFSuZ,OAPf,SAAkBlwB,GAChB,OACE,mCACG6Z,GAAW7Z,GAAS,cAAC,GAAD,CAAM4C,KAAM5C,EAAM8Z,SAAS3W,QAAY,cAACyW,GAAD,OC3JlEuW,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,IAAD,CAAeC,SAAUC,4BAAzB,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,IAAI3Y,UAAW4Y,IACjC,cAAC,IAAD,CAAOF,OAAK,EAACC,KAAK,oBAAoB3Y,UAAW6Y,KACjD,cAAC,IAAD,CAAOH,OAAK,EAACC,KAAK,cAAc3Y,UAAWyF,KAC3C,cAAC,IAAD,CAAOiT,OAAK,EAACC,KAAK,YAAY3Y,UAAW8Y,KACzC,cAAC,IAAD,CAAOJ,OAAK,EAACC,KAAK,YAAY3Y,UAAW+Y,YAI/C3C,SAASC,eAAe,SAM1BjvB,M","file":"static/js/main.dfc3140f.chunk.js","sourcesContent":["const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import axios from \"axios\";\nconst instance = axios.create({\n  //   baseURL: `http://localhost:4000/`,\n  baseURL: \"https://p4000.140-112-18-200.nip.io/\",\n});\nexport default instance;\n","import { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport instance from \"./Api\";\n\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { makeStyles } from \"@material-ui/core\";\nimport Modal from \"@material-ui/core/Modal\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Switch from \"@material-ui/core/Switch\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport { url } from \"./url\";\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\nconst useStyles = makeStyles({\n  input: {\n    margin: \"0 0.2em\",\n  },\n  button: {\n    width: \"100px\",\n    marginLeft: \"0.6em\",\n  },\n});\n\nconst Body = () => {\n  const history = useHistory();\n  const classes = useStyles();\n  const [name, setName] = useState(\"\");\n  const [pwd, setPwd] = useState(\"\");\n  // for SignUp\n  const [name_, setName_] = useState(\"\");\n  const [pwd_, setPwd_] = useState(\"\");\n  const [pwd_repeat, setPwd_repeat] = useState(\"\");\n\n  const [open, setOpen] = useState(false);\n  const [show, setShow] = useState(false);\n  // for Snackbar Alert\n  const [msgOpen, setMsgOpen] = useState(false);\n  const [alertMsg, setAlertMsg] = useState(\"\");\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\n\n  const handleChange = (func) => (event) => {\n    func(event.target.value.trim());\n  };\n\n  const handleLogin = async () => {\n    const {\n      data: { success, uuid, mapIDs },\n    } = await instance.post(\"/api/login\", {\n      name,\n      pwd,\n    });\n    if (!success) {\n      // alert(`Wrong password or the user doesn't exist.`);\n      setAlertMsg(`Wrong password or the user doesn't exist.`);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n    } else {\n      // console.log(`${name} ${uuid}`);\n      history.push({\n        pathname: `/users/selectPage`,\n        search: \"\",\n        state: { uuid: uuid, name: name, login: true, mapIDs: mapIDs },\n      });\n    }\n  };\n\n  const handleSignUp = async () => {\n    const {\n      data: { success, msg },\n    } = await instance.post(\"/api/signup\", {\n      name_,\n      pwd_,\n    });\n    if (!success) {\n      setAlertMsg(msg);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n      // alert(msg);\n    } else {\n      // alert(`Success :` + msg);\n      setAlertMsg(\"This is a success message!\");\n      setAlertType(\"success\");\n      setMsgOpen(true);\n    }\n    setOpen(false);\n  };\n\n  const handleDel = async () => {\n    const {\n      data: { success },\n    } = await instance.post(\"/api/clear\", {});\n    if (success) {\n      setAlertMsg(\"This is a success message!\");\n      setAlertType(\"success\");\n      setMsgOpen(true);\n    } else {\n      setAlertMsg(`Delete Fail`);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n    }\n  };\n\n  const handleDelMap = async () => {\n    const {\n      data: { success },\n    } = await instance.post(\"/api/deleteMap\", {});\n    if (success) {\n      setAlertMsg(\"This is a success message!\");\n      setAlertType(\"success\");\n      setMsgOpen(true);\n    } else {\n      setAlertMsg(`Delete Fail`);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n    }\n  };\n\n  return (\n    <section className=\"Wrapper\">\n      <Snackbar\n        open={msgOpen}\n        autoHideDuration={3000}\n        onClose={() => {\n          setMsgOpen(false);\n        }}\n      >\n        <Alert\n          onClose={() => {\n            setMsgOpen(false);\n          }}\n          severity={alertType}\n        >\n          {alertMsg}\n        </Alert>\n      </Snackbar>\n      <div className=\"Row\">\n        {/* Could use a form & a library for handling form data here such as Formik, but I don't really see the point... */}\n        <TextField\n          className={classes.input}\n          placeholder=\"Name\"\n          value={name}\n          onChange={handleChange(setName)}\n        />\n        <TextField\n          className={classes.input}\n          placeholder=\"Password\"\n          style={{ width: 240 }}\n          value={pwd}\n          type={show ? \"text\" : \"password\"}\n          onChange={handleChange(setPwd)}\n        />\n        <Button\n          className={classes.button}\n          variant=\"contained\"\n          color=\"primary\"\n          disabled={!name || !pwd}\n          onClick={handleLogin}\n        >\n          登入\n        </Button>\n        <Button\n          className={classes.button}\n          variant=\"outlined\"\n          color=\"secondary\"\n          onClick={() => {\n            setOpen(true);\n          }}\n        >\n          註冊\n        </Button>\n      </div>\n\n      <div className=\"Row1\">\n        <FormControlLabel\n          control={\n            <Switch\n              checked={show}\n              onChange={() => setShow(!show)}\n              name=\"planttext password\"\n            />\n          }\n          label=\"顯示密碼\"\n        />\n      </div>\n      <Modal\n        open={open}\n        onClose={() => {\n          setOpen(false);\n        }}\n      >\n        <div className=\"SignUP\">\n          <TextField\n            className={classes.input}\n            placeholder=\"Name\"\n            value={name_}\n            onChange={handleChange(setName_)}\n          />\n          <TextField\n            className={classes.input}\n            placeholder=\"Password\"\n            style={{ width: 240 }}\n            value={pwd_}\n            type={show ? \"text\" : \"password\"}\n            onChange={handleChange(setPwd_)}\n          />\n          <TextField\n            className={classes.input}\n            placeholder=\"Retype Your Password\"\n            style={{ width: 240 }}\n            value={pwd_repeat}\n            type={show ? \"text\" : \"password\"}\n            onChange={handleChange(setPwd_repeat)}\n          />\n          <Button\n            className={classes.button}\n            variant=\"contained\"\n            color=\"secondary\"\n            disabled={!name_ || !pwd_ || pwd_ !== pwd_repeat}\n            onClick={handleSignUp}\n          >\n            註冊\n          </Button>\n          <div className=\"Row1\">\n            <FormControlLabel\n              control={\n                <Switch\n                  checked={show}\n                  onChange={() => setShow(!show)}\n                  name=\"planttext password\"\n                />\n              }\n              label=\"顯示密碼\"\n            />\n          </div>\n        </div>\n      </Modal>\n      {/* <div\n        style={\n          name === \"admin\" && pwd === \"deletemode\"\n            ? { display: \"block\" }\n            : { display: \"none\" }\n        }\n      >\n        <Button\n          className={classes.button}\n          variant=\"outlined\"\n          color=\"secondary\"\n          disabled={false}\n          onClick={handleDel}\n        >\n          Delete User\n        </Button>\n        <Button\n          className={classes.button}\n          variant=\"outlined\"\n          color=\"secondary\"\n          disabled={false}\n          onClick={handleDelMap}\n        >\n          Delete Map\n        </Button>\n      </div> */}\n    </section>\n  );\n};\n\nexport default Body;\n","/* 二維向量 class 定義 */\nexport default class Vec2 {\n    constructor(x = 0, y = 0) {\n        this.x = x;\n        this.y = y;\n    }\n    init() {\n        this.x = 0;\n        this.y = 0;\n    }\n    set(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    clone() {\n        return new Vec2(this.x, this.y);\n    }\n    equal(v) {\n        return (this.x === v.x && this.y === v.y);\n    }\n    add(v) {\n        return new Vec2(this.x + v.x, this.y + v.y);\n    }\n    sub(v) {\n        return new Vec2(this.x - v.x, this.y - v.y);\n    }\n    mul(c) {\n        return new Vec2(this.x * c, this.y * c);\n    }\n    div(c) {\n        return new Vec2(this.x / c, this.y / c);\n    }\n    length() { \n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    }\n    unit() { // 回傳單位向量\n        if (this.length() === 0) return this;\n        return this.div(this.length());\n    }\n    dot(v) { // 計算內積\n        return this.x * v.x + this.y * v.y;\n    }\n    cross(v) { // 計算外積\n        return this.x * v.y - this.y * v.x;\n    }\n    ortho(v) { // 獲得此向量在 v 上的正射影比值\n        if (v.length() === 0) return 0;\n        return this.dot(v) / v.length() / v.length();\n    }\n    radian() { // 回傳弧度角\n        if (this.x === 0) return (this.y > 0) ? 0.5 * Math.PI : 1.5 * Math.PI;\n        if (this.x > 0) return (this.y > 0) ? Math.atan(this.y / this.x) : 2 * Math.PI + Math.atan(this.y / this.x);\n        return Math.PI + Math.atan(this.y / this.x);\n    }\n    between(v1, v2) { // 在兩點圍出的矩形空間內\n        return this.x >= Math.min(v1.x, v2.x) && this.x <= Math.max(v1.x, v2.x) && this.y >= Math.min(v1.y, v2.y) && this.y <= Math.max(v1.y, v2.y);\n    }\n    toGrid(w) { // 回傳將座標以 w 為寬度單位轉成網格座標\n        return new Vec2(~~(this.x / w), ~~(this.y / w));\n    }\n    static up() {\n        return new Vec2(0, -1);\n    }\n    static down() {\n        return new Vec2(0, 1);\n    }\n    static left() {\n        return new Vec2(-1, 0);\n    }\n    static right() {\n        return new Vec2(1, 0);\n    }\n    static direction(dir) {\n        return (dir === 'up') ? Vec2.up() : (dir === 'down') ? Vec2.down() : (dir === 'left') ? Vec2.left() : (dir === 'right') ? Vec2.right() :\n               (dir === 'right-up') ? Vec2.up().add(Vec2.right()).unit() : (dir === 'right-down') ? Vec2.down().add(Vec2.right()).unit() :\n               (dir === 'left-up') ? Vec2.up().add(Vec2.left()).unit() : (dir === 'left-down') ? Vec2.down().add(Vec2.left()).unit() : new Vec2(0, 0);\n    }\n    static leftUp(v1, v2) { // 回傳兩點圍成的矩形的左上座標\n        return new Vec2(Math.min(v1.x, v2.x), Math.min(v1.y, v2.y));\n    }\n    static rightDown(v1, v2) { // 回傳兩點圍成的矩形的右下座標\n        return new Vec2(Math.max(v1.x, v2.x), Math.max(v1.y, v2.y));\n    }\n}\n","const maxLayer = 5;\n\nexport default class Layer {\n    constructor(...status) { // new Layer(0, 1, 3) 創造佔據層數 0, 1, 3 的物件\n        this.status = [false, false, false, false, false];\n        if (status.length !== 0) this.fill(...status);\n    }\n    fill(...targets) { // fill(2, 4) 把層數 2, 4 佔據 (預設為全部填滿) * 屬強制覆蓋\n        if (targets.length !== 0) {\n            for (let i = 0; i < targets.length; i++) {\n                if (targets[i] < maxLayer && targets[i] >= 0) {\n                    this.status[targets[i]] = true;\n                }\n            }\n        } else this.status = [true, true, true, true, true];\n    }\n    clear(...targets) { // claer(0, 1, 3) 把層數 0, 1, 3 解除佔據 (預設為全部清空) * 屬強制清空\n        if (targets.length !== 0) {\n            for (let i = 0; i < targets.length; i++) {\n                if (targets[i] < maxLayer && targets[i] >= 0) {\n                    this.status[targets[i]] = false;\n                }\n            }\n        } else this.status = [false, false, false, false, false];\n    }\n    isOverlap(that) { // 確認是否兩個層數物件是否重疊\n        for (let i = 0; i < maxLayer; i++) {\n            if (this.status[i] && that.status[i]) return true;\n        }\n        return false;\n    }\n    add(that) { // 將物件的層數疊加 * 必須屬於非重疊物件才可以疊加\n        if (this.isOverlap(that)) return false;\n        for (let i = 0; i < maxLayer; i++) {\n            if (that.status[i]) this.status[i] = true;\n        }\n        return true;\n    }\n    sub(that) { // 將物件的層數消除\n        for (let i = 0; i < maxLayer; i++) {\n            if (that.status[i]) this.status[i] = false;\n        }\n    } \n    clone() { \n        let status = [];\n        for (let i = 0; i < maxLayer; i++) {\n            if (this.status[i]) status.push(i);\n        }\n        return new Layer(...status);\n    }\n    top() { // 回傳被佔據最高層所在層數\n        for (let i = 0; i < maxLayer; i++) {\n            if (this.status[maxLayer - 1 - i]) return maxLayer - 1 - i;\n        }\n        return -1;\n    }\n    bottom() { // 回傳被佔據最底層所在層數\n        for (let i = 0; i < maxLayer; i++) {\n            if (this.status[i]) return i;\n        }\n        return -1;\n    }\n}\n","import Vec2 from './Class/Vec2';\nimport Layer from './Class/Layer';\n\nconst constant = {\n\tmapStart: new Vec2(88, 0), // 地圖的起始點位子(左上座標)\n\tmapSize: new Vec2(32, 16), // 地圖的網格格局\n\tgridWidth: 32, // 地圖的每格寬度\n\tblockColor: '#E0E0E0', // 場外格子底色\n\tstartColor: '#DFFFDF', // 起點格子底色\n\tendColor: '#FFD2D2', // 終點格子底色\n\tnoneColor: '#FFFFFF', // 空地格子底色\n\tdeadColor: '#EBD3E8', // 毒面格子底色\n\ticeColor: '#D9FFFF', // 冰面格子底色\n\tmuddyColor: \"#D6D6AD\", // 泥面格子底色\n\tboundaryColor: '#0080FF', // 邊界格線顏色\n\tauxiliaryColor: '#D2E9FF', // 輔助格線顏色\n\ttypeLayerPairs: { // 各類格子佔據的層數\n\t\t'none': new Layer(),\n\t\t'block': new Layer(),\n\t\t'start': new Layer(0, 1, 2, 3),\n\t\t'end': new Layer(0, 1, 2, 3),\n\t\t'dead': new Layer(),\n\t\t'ice': new Layer(),\n\t\t'muddy': new Layer()\n\t},\n\tmaxLayer: 5, // 最大佔據層數\n\teditObjectList: {\n\t\tplatform: ['platform', 'movingPlatform', 'movingPlatform_oblique', 'movingPlatform_rect', 'trapPlatform', 'brokenPlatform'],\n\t\tcovering: ['mucus', 'ice', 'conveyor', 'deathTotem'],\n\t\tobstacle: ['block', 'spikedBlock', 'woodenBox', 'bow', 'cymbal', 'missileBase'],\n\t\tspecial: ['portal', 'lockedWall', 'unlocker', 'magnet'],\n\t},\n\teditFrame: {\n\t\tdefault: { fColor: '#F0F0F0', sColor: '#BEBEBE' },\n\t\tplatform: { fColor: '#ECECFF', sColor: '#CECEFF' },\n\t\tcovering: { fColor: '#E8FFF5', sColor: '#96FED1' },\n\t\tobstacle: { fColor: '#FFECEC', sColor: '#FFB5B5' },\n\t\tspecial: { fColor: '#FFFFDF', sColor: '#FFFF37' },\n    }\n};\n\nexport default constant;","import Vec2 from './Vec2';\nimport constant from '../constant';\nimport Layer from './Layer';\n\nconst uuidv4 = require(\"uuid/v4\");\nconst w = constant.gridWidth;\nconst isCollision = (obj1, obj2) => {\n    if (obj1.type === 'sphere' && obj2.type === 'sphere') {\n        return obj1.pos.sub(obj2.pos).length() <= (obj1.r + obj2.r);\n    }\n    if ((obj1.type === 'sphere' && obj2.type === 'cube') || (obj2.type === 'sphere' && obj1.type === 'cube')) {\n        const sObj = (obj1.type === 'sphere') ? obj1 : obj2;\n        const cObj = (obj1.type === 'cube') ? obj1 : obj2;\n        if (sObj.pos.between(cObj.pos.sub(cObj.size.mul(0.5)).sub(new Vec2(sObj.r, 0)), cObj.pos.add(cObj.size.mul(0.5)).add(new Vec2(sObj.r, 0)))) return true;\n        if (sObj.pos.between(cObj.pos.sub(cObj.size.mul(0.5)).sub(new Vec2(0, sObj.r)), cObj.pos.add(cObj.size.mul(0.5)).add(new Vec2(0, sObj.r)))) return true;\n        const pointList = ([[-0.5, -0.5], [0.5, -0.5], [0.5, 0.5], [-0.5, 0.5]]).map(p => cObj.pos.add(new Vec2(p[0] * cObj.size.x, p[1] * cObj.size.y)));\n        return Math.min(pointList.map(p => p.sub(sObj.pos))) <= sObj.r;\n    }\n    if (obj1.type === 'cube' && obj2.type === 'cube') {\n        return (Math.abs(obj1.pos.x - obj2.pos.x) <= (obj1.size.x / 2 + obj2.size.x / 2)) && (Math.abs(obj1.pos.y - obj2.pos.y) <= (obj1.size.y / 2 + obj2.size.y / 2));\n    }\n    return false;\n};\nconst colorList = ['#FF0000', '#FFA042', '#F9F900', '#02DF82', '#6A6AFF', '#D0D0D0', '#E800E8', '#984B4B'];\n\n/* 尖刺方塊 */\nexport class spikedBlock {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'spikedBlock';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '尖刺方塊',\n            upSpike: true,\n            downSpike: true,\n            leftSpike: true,\n            rightSpike: true,\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new spikedBlock();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            upSpike: { type: 'check' },\n            downSpike: { type: 'check' },\n            leftSpike: { type: 'check' },\n            rightSpike: { type: 'check' },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            upSpike: this.detail.upSpike,\n            downSpike: this.detail.downSpike,\n            leftSpike: this.detail.leftSpike,\n            rightSpike: this.detail.rightSpike,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.upSpike = objectSetting.upSpike;\n        this.detail.downSpike = objectSetting.downSpike;\n        this.detail.leftSpike = objectSetting.leftSpike;\n        this.detail.rightSpike = objectSetting.rightSpike;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(w, w) }, target)) return 'block';\n        if ((this.detail.leftSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(-0.625 * w, 0)), size: new Vec2(0.25 * w, 0.75 * w) }, target)) ||\n            (this.detail.rightSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(0.625 * w, 0)), size: new Vec2(0.25 * w, 0.75 * w) }, target)) ||\n            (this.detail.upSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(0, -0.625 * w)), size: new Vec2(0.25 * w, 0.75 * w) }, target)) ||\n            (this.detail.downSpike && isCollision({ type: 'cube', pos: this.pos.add(new Vec2(0, 0.625 * w)), size: new Vec2(0.25 * w, 0.75 * w) }, target)))\n            return 'spike';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.4 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(-0.5 * w, -0.5 * w);\n        if (this.detail.upSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((-0.5 + 0.125 * i) * w, (-0.5 - 0.25 * (i % 2)) * w);\n        ctx.lineTo(0.5 * w, -0.5 * w);\n        if (this.detail.rightSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((0.5 + 0.25 * (i % 2)) * w, (-0.5 + 0.125 * i) * w);\n        ctx.lineTo(0.5 * w, 0.5 * w);\n        if (this.detail.downSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((0.5 - 0.125 * i) * w, (0.5 + 0.25 * (i % 2)) * w);\n        ctx.lineTo(-0.5 * w, 0.5 * w);\n        if (this.detail.leftSpike) for (let i = 1; i <= 8; i++) ctx.lineTo((-0.5 - 0.25 * (i % 2)) * w, (0.5 - 0.125 * i) * w);\n        ctx.lineTo(-0.5 * w, -0.5 * w);\n        ctx.fillStyle = '#7B7B7B';\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.5 * w, -0.5 * w, w, w);\n        ctx.fillStyle = '#9D9D9D';\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if ((constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) ||\n            (this.detail.leftSpike && gridPos.x - 1 >= 0 && constant.typeLayerPairs[map[gridPos.y][gridPos.x - 1].type].isOverlap(this.layer)) ||\n            (this.detail.upSpike && gridPos.y - 1 >= 0 && constant.typeLayerPairs[map[gridPos.y - 1][gridPos.x].type].isOverlap(this.layer)) ||\n            (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x && constant.typeLayerPairs[map[gridPos.y][gridPos.x + 1].type].isOverlap(this.layer)) ||\n            (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y && constant.typeLayerPairs[map[gridPos.y + 1][gridPos.x].type].isOverlap(this.layer))) {\n            return false;\n        }\n        if ((map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) ||\n            (this.detail.leftSpike && gridPos.x - 1 >= 0 && map[gridPos.y][gridPos.x - 1].layer.isOverlap(this.layer)) ||\n            (this.detail.upSpike && gridPos.y - 1 >= 0 && map[gridPos.y - 1][gridPos.x].layer.isOverlap(this.layer)) ||\n            (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x && map[gridPos.y][gridPos.x + 1].layer.isOverlap(this.layer)) ||\n            (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y && map[gridPos.y + 1][gridPos.x].layer.isOverlap(this.layer))) {\n            return false;\n        }\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (this.detail.leftSpike && gridPos.x - 1 >= 0) map[gridPos.y][gridPos.x - 1].layer.add(this.layer);\n        if (this.detail.upSpike && gridPos.y - 1 >= 0) map[gridPos.y - 1][gridPos.x].layer.add(this.layer);\n        if (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x) map[gridPos.y][gridPos.x + 1].layer.add(this.layer);\n        if (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y) map[gridPos.y + 1][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (this.detail.leftSpike && gridPos.x - 1 >= 0) map[gridPos.y][gridPos.x - 1].layer.sub(this.layer);\n        if (this.detail.upSpike && gridPos.y - 1 >= 0) map[gridPos.y - 1][gridPos.x].layer.sub(this.layer);\n        if (this.detail.rightSpike && gridPos.x + 1 < constant.mapSize.x) map[gridPos.y][gridPos.x + 1].layer.sub(this.layer);\n        if (this.detail.downSpike && gridPos.y + 1 < constant.mapSize.y) map[gridPos.y + 1][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 平台 */\nexport class platform {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'platform';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '平台'\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.layer = new Layer(1);\n    }\n    clone() {\n        const cloneObject = new platform();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.99 * w, 0.99 * w) }, target)) return 'platform';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.45) * w);\n        ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\n        ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\n        ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\n        ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.45) * w);\n        ctx.fillStyle = '#ead48b';\n        ctx.fill();\n        ctx.strokeStyle = '#cb934d';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.35) * w);\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.35) * w);\n        ctx.strokeStyle = '#f4f788';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 移動平台 */\nexport class movingPlatform {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'movingPlatform';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '移動平台(直行)',\n            direction: 'up',\n            distance: 1,\n            speed: 'normal',\n        };\n\n        this.loadable = true;\n        this.loadObject = null;\n\n        this.lastRecord = Date.now();\n        this.active = false;\n        this.perspective = false;\n\n        this.layer = new Layer(0, 1);\n    }\n    clone() {\n        const cloneObject = new movingPlatform();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            distance: { type: 'int', min: 1, max: 15 },\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\n            speed: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n            distance: this.detail.distance,\n            speed: this.detail.speed,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n        this.detail.distance = objectSetting.distance;\n        this.detail.speed = objectSetting.speed;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        const parameters = {\n            'super slow': 4000, 'slow': 2000, 'normal': 1000, 'fast': 500, 'super fast': 200,\n        };\n        const dirVec = Vec2.direction(this.detail.direction).mul(this.detail.distance * w);\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n        if (~~((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 2 === 0) {\n            this.pos = originPos.add(dirVec.mul(((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\n        } else {\n            this.pos = originPos.add(dirVec.mul(1 - ((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\n        }\n        if (this.loadObject) this.loadObject.object.pos = this.pos;\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'movingPlatform';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n        if (this.active) ctx.translate(originPos.x, originPos.y);\n        else ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        if (layer === -1 || layer === 0) {\n            ctx.save();\n            let dir = this.detail.direction;\n            ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\n\n            ctx.beginPath();\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(0, - this.detail.distance * w);\n            ctx.strokeStyle = '#4F4F4F';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.save();\n            ctx.translate(0, - this.detail.distance * w);\n            ctx.beginPath();\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n            ctx.restore();\n\n            ctx.restore();\n        }\n\n        if (layer === -1 || layer === 1) {\n            if (this.active) {\n                const relativePos = this.pos.sub(originPos);\n                ctx.translate(relativePos.x, relativePos.y);\n            }\n\n            ctx.beginPath();\n            ctx.moveTo(0, (-0.45) * w);\n            ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\n            ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\n            ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\n            ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\n            ctx.lineTo(0, (-0.45) * w);\n            ctx.fillStyle = '#ead48b';\n            ctx.fill();\n            ctx.strokeStyle = '#cb934d';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0, (-0.35) * w);\n            ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n            ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n            ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n            ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n            ctx.lineTo(0, (-0.35) * w);\n            ctx.strokeStyle = '#f4f788';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.active = true;\n        this.lastRecord = Date.now();\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    this.loadObject = {\n                        id: objects[i].id,\n                        object: objects[i],\n                    };\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 弓 */\nexport class bow {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'bow';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '弓箭座',\n            direction: 'up',\n            RoF: 'normal'\n        };\n\n        this.loadable = false;\n\n        this.lastFire = Date.now();\n        this.lifeCycle = 0;\n        this.active = false;\n        this.perspective = false;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new bow();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\n            RoF: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n            RoF: this.detail.RoF,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n        this.detail.RoF = objectSetting.RoF;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        const parameters = {\n            'super slow': 8000, slow: 5000, normal: 3000, fast: 1000, 'super fast': 500\n        }\n        this.lifeCycle = (this.active) ? (Date.now() - this.lastFire) / parameters[this.detail.RoF] : 0;\n        this.lifeCycle = (this.lifeCycle > 0.5) ? (this.lifeCycle - 0.5) / 0.5 : 0;\n        if (Date.now() > this.lastFire + parameters[this.detail.RoF]) {\n            this.lastFire = Date.now();\n            let dirVec = Vec2.direction(this.detail.direction).mul(0.5 * w);\n            const result = {\n                type: 'produce',\n                object: new arrow(this.pos.add(dirVec)),\n            };\n            result.object.detail.direction = this.detail.direction;\n            return result;\n        } else return { type: 'none' };\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n        let dir = this.detail.direction;\n        ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\n\n        const drawPoint = (new Vec2(0, 0.05)).add((new Vec2(0, 0.35)).mul(this.lifeCycle));\n\n        if (this.lifeCycle > 0) {\n            let tempArrow = new arrow(drawPoint.mul(w).sub(new Vec2(0, 0.9 * w)));\n            tempArrow.draw(ctx);\n        }\n\n        ctx.beginPath();\n        ctx.moveTo(-0.45 * w, 0.05 * w);\n        ctx.lineTo(drawPoint.x * w, drawPoint.y * w);\n        ctx.lineTo(0.45 * w, 0.05 * w);\n        ctx.strokeStyle = '#9D9D9D';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.arc(0, 0.2 * w, 0.45 * w, -0.95 * Math.PI, -0.05 * Math.PI);\n        ctx.arc(0, 0.2 * w, 0.55 * w, -0.05 * Math.PI, -0.95 * Math.PI, true);\n        ctx.arc(0, 0.2 * w, 0.45 * w, -0.95 * Math.PI, -0.95 * Math.PI);\n        ctx.fillStyle = '#D26900';\n        ctx.fill();\n        ctx.strokeStyle = '#272727';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.active = true;\n        this.lastFire = Date.now();\n        this.lifeCycle = 0;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 箭 */\nexport class arrow {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'arrow';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = new Vec2(-1, -1);\n\n        this.detail = {\n            name: '箭',\n            direction: 'up',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.speed = 3;\n        this.lastRecord = Date.now();\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new arrow();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    update(objects, map) {\n        if (!this.pos.between(constant.mapStart, constant.mapStart.add(constant.mapSize.mul(w)))) return { type: 'destory' };\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].type !== 'ice' && objects[i].type !== 'portal' && objects[i].type !== 'woodenBox' && objects[i].type !== 'magnet' && objects[i].type !== 'block' && objects[i].type !== 'lockedWall') continue;\n            if (objects[i].id !== this.id && objects[i].collision) {\n                let result = objects[i].collision({ type: 'sphere', pos: this.pos, r: 0.1 });\n                // console.log(result);\n                if (result === 'ice') this.speed *= 1.03;\n                // else if (result === 'conveyor') this.detail.direction = objects[i].detail.direction;\n                else if (result === 'portal') this.pos = objects[i].teleport(objects);\n                // else if (result === 'missileRay') objects[i].fire(this);\n                else if (result === 'woodenBox') {\n                    //objects[i].push(objects, map, this.pos);\n                    return { type: 'destory' };\n                }\n                else if (result === 'magneticField') this.pos = this.pos.add(objects[i].getDisplacement());\n                // else if (result === 'unlocker') objects[i].unlock(objects);\n                else if (result === 'block' || result === 'lockedWall') return { type: 'destory' };\n            }\n        }\n        let dirVec = Vec2.direction(this.detail.direction).mul(this.speed * w);\n        this.pos = this.pos.add(dirVec.mul((Date.now() - this.lastRecord) / 1000));\n        this.lastRecord = Date.now();\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.1 }, target)) return 'arrow';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.9 : 1;\n        let dir = this.detail.direction;\n        ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\n\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.lineTo(0.12 * w, 0.2 * w);\n        ctx.lineTo(-0.12 * w, 0.2 * w);\n        ctx.lineTo(0, 0);\n        ctx.fillStyle = '#FCFCFC';\n        ctx.fill();\n        ctx.strokeStyle = '#9D9D9D';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.moveTo(0, 0.2 * w);\n        ctx.lineTo(0, 0.8 * w);\n        ctx.strokeStyle = '#AD5A5A';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.translate(0, 0.8 * w);\n        for (let i = 0; i < 2; i++) {\n            if (i === 1) ctx.scale(-1, 1);\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(0.12 * w, 0.06 * w);\n            ctx.lineTo(0.12 * w, 0.18 * w);\n            ctx.lineTo(0, 0.12 * w);\n            ctx.lineTo(0, 0);\n            ctx.fillStyle = '#00DB00';\n            ctx.fill();\n            ctx.strokeStyle = '#9D9D9D';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.restore();\n    }\n}\n\n/* 黏液 */\nexport class mucus {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'mucus';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '黏液'\n        };\n\n        this.loadable = true;\n        this.loadObject = null;\n\n        this.perspective = false;\n\n        this.layer = new Layer(2);\n    }\n    clone() {\n        const cloneObject = new mucus();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        if (this.loadObject) this.loadObject.object.pos = this.pos.clone();\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'mucus';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.35) * w);\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.35) * w);\n        let grd = ctx.createLinearGradient(-0.4 * w, -0.4 * w, 0.4 * w, 0.4 * w);\n        grd.addColorStop(0, '#B7FF4A');\n        grd.addColorStop(0.4, '#FFDC35');\n        grd.addColorStop(0.6, '#FFDC35');\n        grd.addColorStop(1, '#B7FF4A');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.strokeStyle = '#E1E100';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        if (map[gridPos.y][gridPos.x].layer.status[3]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 3) {\n                    this.loadObject = {\n                        id: objects[i].id,\n                        object: objects[i],\n                    };\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n        if (this.loadObject) this.loadObject = null;\n    }\n}\n\n/* 音鈸 */\nexport class cymbal {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'cymbal';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '音鈸',\n            RoF: 'normal',\n            range: 'normal',\n        };\n\n        this.loadable = false;\n\n        this.lastFire = Date.now();\n        this.lifeCycle = 0;\n        this.active = false;\n        this.perspective = false;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new cymbal();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            RoF: { type: 'select', options: ['slow', 'normal', 'fast'] },\n            range: { type: 'select', options: ['small', 'normal', 'large'] },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n            RoF: this.detail.RoF,\n            range: this.detail.range,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n        this.detail.RoF = objectSetting.RoF;\n        this.detail.range = objectSetting.range;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        const parameters = {\n            slow: 12000, normal: 8000, fast: 4000\n        }\n        this.lifeCycle = (this.active) ? (Date.now() - this.lastFire) / parameters[this.detail.RoF] : 0;\n        this.lifeCycle = Math.min(1, this.lifeCycle);\n        if (Date.now() > this.lastFire + parameters[this.detail.RoF]) {\n            this.lastFire = Date.now();\n            const result = {\n                type: 'produce',\n                object: new cymbalWave(this.pos),\n            };\n            result.object.r = 0.4 * w;\n            result.object.detail.range = this.detail.range;\n            return result;\n        } else return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.48 * w }, target)) return 'cymbal';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        const parameters = {\n            slow: 12000, normal: 8000, fast: 4000\n        }\n        let pivot = 0.96 + parameters[this.detail.RoF] * 0.0000025;\n        let r = (this.lifeCycle < pivot) ? 0.05 + 0.4 * this.lifeCycle / pivot : 0.05 + 0.4 * (1 - this.lifeCycle) / (1 - pivot);\n\n        ctx.save();\n        ctx.rotate(this.lifeCycle * 8 * Math.PI);\n        ctx.beginPath();\n        ctx.arc(0, 0, 0.48 * w, 0, 2 * Math.PI);\n        var grd = ctx.createRadialGradient(-0.13 * w, -0.13 * w, 0, 0, 0, 0.48 * w);\n        grd.addColorStop(0, 'white');\n        grd.addColorStop(1, '#D6D6AD');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.strokeStyle = '#B9B973';\n        ctx.stroke();\n        ctx.closePath();\n        ctx.restore();\n\n        ctx.save();\n\n        ctx.globalAlpha *= 0.5;\n        ctx.beginPath();\n        ctx.arc(0, 0, 0.4 * w, 0 * Math.PI, 2 * Math.PI);\n        ctx.strokeStyle = '#CDCD9A';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n\n        ctx.beginPath();\n        ctx.globalAlpha *= 0.5;\n        ctx.arc(0, 0, r * w, 0, 2 * Math.PI);\n        ctx.lineWidth = 1.3;\n        ctx.strokeStyle = 'white';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.arc(0, 0, 0.06 * w, 0, 2 * Math.PI);\n        ctx.fillStyle = '#EAC100';\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.active = true;\n        this.lastFire = Date.now();\n        this.lifeCycle = 0;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 音波 */\nexport class cymbalWave {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'cymbalWave';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = new Vec2(-1, -1);\n\n        this.detail = {\n            name: '音波',\n            range: 'normal',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.r = 0;\n        this.lastRecord = Date.now();\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new arrow();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    update(objects, map) {\n        const parameters = {\n            small: 1.5, normal: 2.5, large: 3.5\n        }\n        if (this.r > w * parameters[this.detail.range]) return { type: 'destory' };\n        this.r = 0.4 * w + 0.5 * w * (Date.now() - this.lastRecord) / 1000;\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'sphere', pos: this.pos, r: this.r }, target)) return 'cymbalWave';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n\n        const parameters = {\n            small: 1.5, normal: 2.5, large: 3.5\n        }\n        ctx.globalAlpha = 0.3 * Math.max((1.1 - Math.pow(this.r / (w * parameters[this.detail.range]), 16)), 0);\n\n        ctx.beginPath();\n        ctx.arc(0, 0, this.r, 0, 2 * Math.PI);\n        var grd = ctx.createRadialGradient(0, 0, 0, 0, 0, this.r);\n        grd.addColorStop(0, 'white');\n        grd.addColorStop(0.4, 'white');\n        grd.addColorStop(0.95, '#FFFF37');\n        grd.addColorStop(1, '#E1E100');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n}\n\n/* 冰面 */\nexport class ice {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'ice';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '冰層'\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.layer = new Layer(2);\n    }\n    clone() {\n        const cloneObject = new ice();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'ice';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.35) * w);\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.35) * w);\n        let grd = ctx.createLinearGradient(-0.4 * w, -0.4 * w, 0.4 * w, 0.4 * w);\n        grd.addColorStop(0, '#CAFFFF');\n        grd.addColorStop(0.12, 'white');\n        grd.addColorStop(0.15, 'white');\n        grd.addColorStop(0.4, '#CAFFFF');\n        grd.addColorStop(0.6, '#CAFFFF');\n        grd.addColorStop(0.85, 'white');\n        grd.addColorStop(0.88, 'white');\n        grd.addColorStop(1, '#CAFFFF');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.strokeStyle = '#ACD6FF';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 傳輸帶 */\nexport class conveyor {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'conveyor';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '傳輸帶',\n            direction: 'right',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.layer = new Layer(2);\n    }\n    clone() {\n        const cloneObject = new conveyor();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'conveyor';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.35) * w);\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.35) * w);\n        ctx.fillStyle = '#BE77FF';\n        ctx.fill();\n        ctx.strokeStyle = '#9F35FF';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.rect((-0.34) * w, (-0.34) * w, 0.68 * w, 0.68 * w);\n        ctx.clip();\n\n        let dir = this.detail.direction;\n        ctx.rotate((dir === 'right') ? 0 : (dir === 'left') ? Math.PI : (dir === 'up') ? 1.5 * Math.PI : 0.5 * Math.PI);\n\n        ctx.beginPath();\n        ctx.moveTo(-0.4 * w, -0.15 * w);\n        ctx.lineTo(-0.05 * w, -0.15 * w);\n        ctx.lineTo(-0.05 * w, -0.4 * w);\n        ctx.lineTo(0.4 * w, 0);\n        ctx.lineTo(-0.05 * w, 0.4 * w);\n        ctx.lineTo(-0.05 * w, 0.15 * w);\n        ctx.lineTo(-0.4 * w, 0.15 * w);\n        ctx.lineTo(-0.4 * w, -0.15 * w);\n        ctx.fillStyle = '#FFA6FF';\n        ctx.fill();\n        ctx.strokeStyle = '#D3A4FF';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 傳送門 */\nexport class portal {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'portal';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '傳送門'\n        };\n\n        this.loadable = false;\n\n        this.open = false;\n        this.index = -1;\n\n        this.cooldown = false;\n        this.lastClose = 0;\n        this.cooldownTime = 2989;\n        this.cooldownCycle = 0;\n\n        this.perspective = false;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new portal();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n\n            index: this.index,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.index = objectSetting.index;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        if (this.cooldown) {\n            if (Date.now() > this.lastClose + this.cooldownTime) {\n                this.cooldown = false;\n                this.open = true;\n            } else this.cooldownCycle = (Date.now() - this.lastClose) / this.cooldownTime;\n        }\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (this.open && isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.6 * w, 0.6 * w) }, target)) return 'portal';\n        return 'none';\n    }\n    teleport(objects) {\n        this.open = false;\n        this.cooldown = true;\n        this.lastClose = Date.now();\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].type === 'portal' && objects[i].index === this.index && objects[i].id !== this.id) {\n                objects[i].open = false;\n                objects[i].cooldown = true;\n                objects[i].lastClose = Date.now();\n                return objects[i].pos.clone();\n            }\n        }\n        return this.pos.clone();\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.rect(-0.36 * w, -0.36 * w, 0.72 * w, 0.72 * w);\n        ctx.lineWidth = 5;\n        ctx.strokeStyle = '#4B0091';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.4 * w, -0.4 * w, 0.8 * w, 0.8 * w);\n        ctx.lineWidth = 0.2;\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.32 * w, -0.32 * w, 0.64 * w, 0.64 * w);\n        ctx.lineWidth = 0.2;\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.rect(-0.3 * w, -0.3 * w, 0.6 * w, 0.6 * w);\n        ctx.clip();\n        ctx.globalAlpha = (this.open) ? 0.95 :\n            (!this.cooldown) ? 0.2 :\n                (this.cooldownCycle < 0.1) ? 0.2 + 0.75 * (1 - this.cooldownCycle * 10) :\n                    (this.cooldownCycle > 0.9) ? 0.2 + 0.75 * (1 - (1 - this.cooldownCycle) * 10) : 0.2;\n\n        ctx.beginPath();\n        ctx.rect(-0.32 * w, -0.32 * w, 0.64 * w, 0.64 * w);\n        let color = ((this.open || this.cooldown) && (this.index >= 0)) ? colorList[this.index] : 'white';\n        let grd = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.4 * w);\n        grd.addColorStop(0, color);\n        grd.addColorStop(0.15, '#3C3C3C');\n        grd.addColorStop(0.3, color);\n        grd.addColorStop(0.45, '#3C3C3C');\n        grd.addColorStop(0.6, color);\n        grd.addColorStop(0.75, '#3C3C3C');\n        grd.addColorStop(0.9, color);\n        grd.addColorStop(1, '#3C3C3C');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.closePath();\n\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.cooldown = false;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        if (this.index === -1) {\n            let usedIndex = [0, 0, 0, 0, 0, 0, 0, 0];\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].type === 'portal') {\n                    usedIndex[objects[i].index] += 1;\n                }\n            }\n            for (let i = 0; i < usedIndex.length; i++) {\n                if (usedIndex[i] === 1) {\n                    this.index = i;\n                    this.open = true;\n                    for (let j = 0; j < objects.length; j++) {\n                        if (objects[j].type === 'portal' && objects[j].index === i) {\n                            objects[j].open = true;\n                        }\n                    }\n                    break;\n                }\n            }\n            if (this.index === -1) {\n                for (let i = 0; i < usedIndex.length; i++) {\n                    if (usedIndex[i] === 0) {\n                        this.index = i;\n                        this.open = false;\n                        break;\n                    }\n                }\n            }\n        } else {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].type === 'portal' && objects[i].index === this.index && objects[i].id != this.id) {\n                    objects[i].open = true;\n                    this.open = true;\n                }\n            }\n        }\n        if (this.index === -1) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].type === 'portal' && objects[i].index === this.index && objects[i].id != this.id) {\n                objects[i].cooldown = false;\n                objects[i].open = false;\n                break;\n            }\n        }\n        this.index = -1;\n        this.open = false;\n        this.cooldown = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 陷阱平台 */\nexport class trapPlatform {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'trapPlatform';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '陷阱平台',\n            duration: 'normal',\n        };\n\n        this.loadable = false;\n\n        this.open = false;\n        this.lastChange = Date.now();\n        this.openCycle = 0;\n\n        this.perspective = false;\n\n        this.layer = new Layer(1, 2);\n    }\n    clone() {\n        const cloneObject = new trapPlatform();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            duration: { type: 'select', options: ['short', 'normal', 'long'] },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            duration: this.detail.duration,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.duration = objectSetting.duration;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        const parameters = {\n            short: 3000, normal: 6000, long: 9000\n        }\n        if (this.open) {\n            this.openCycle = (Date.now() - this.lastChange) / parameters[this.detail.duration];\n            this.openCycle = (this.openCycle < 0.1 * 6000 / parameters[this.detail.duration]) ? this.openCycle / (0.1 * 6000 / parameters[this.detail.duration]) :\n                (this.openCycle > 1 - (0.1 * 6000 / parameters[this.detail.duration])) ? (1 - this.openCycle) / (0.1 * 6000 / parameters[this.detail.duration]) : 1;\n            if (Date.now() > this.lastChange + parameters[this.detail.duration]) {\n                this.open = false;\n                this.lastChange = Date.now();\n            }\n        } else {\n            this.openCycle = 0;\n            if (Date.now() > this.lastChange + parameters[this.detail.duration]) {\n                this.open = true;\n                this.lastChange = Date.now();\n            }\n        }\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (this.open && isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.6 * w * this.openCycle, 0.7 * w) }, target)) return 'trap';\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'platform';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.6 : 1;\n\n        ctx.beginPath();\n        ctx.rect(-0.39 * w, -0.39 * w, 0.78 * w, 0.78 * w);\n        ctx.strokeStyle = '#ADADAD';\n        ctx.stroke();\n        ctx.closePath();\n\n        for (let i = 0; i < 2; i++) {\n            ctx.save();\n\n            if (this.open) {\n                let p = (i === 0) ? -1 : 1;\n                ctx.beginPath();\n                ctx.moveTo(-0.05 * w + p * (0.3 * w) * this.openCycle, -0.35 * w);\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, -0.25 * w);\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, -0.15 * w);\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, -0.05 * w);\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, 0.05 * w);\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, 0.15 * w);\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, 0.25 * w);\n                ctx.lineTo(0.05 * w + p * (0.3 * w) * this.openCycle, 0.35 * w);\n                ctx.lineTo(0.35 * w * p, 0.35 * w);\n                ctx.lineTo(0.35 * w * p, -0.35 * w);\n                ctx.lineTo(-0.05 * w + p * (0.3 * w) * this.openCycle, -0.35 * w);\n                ctx.clip();\n                ctx.closePath();\n            }\n            ctx.beginPath();\n            ctx.rect(-0.35 * w, -0.35 * w, 0.7 * w, 0.7 * w);\n            ctx.fillStyle = '#E0E0E0';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.restore();\n        }\n\n        ctx.beginPath();\n        ctx.rect(-0.43 * w, -0.43 * w, 0.86 * w, 0.86 * w);\n        ctx.strokeStyle = '#3C3C3C';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.35 * w, -0.35 * w, 0.7 * w, 0.7 * w);\n        ctx.strokeStyle = '#3C3C3C';\n        ctx.stroke();\n        ctx.closePath();\n\n        for (let i = 0; i < 2; i++) {\n            ctx.save();\n            if (this.open) {\n                if (i === 0) ctx.translate((-0.3 * w) * this.openCycle, 0);\n                else ctx.translate((0.3 * w) * this.openCycle, 0);\n            }\n            ctx.beginPath();\n            ctx.moveTo(-0.05 * w, -0.35 * w);\n            ctx.lineTo(0.05 * w, -0.25 * w);\n            ctx.lineTo(-0.05 * w, -0.15 * w);\n            ctx.lineTo(0.05 * w, -0.05 * w);\n            ctx.lineTo(-0.05 * w, 0.05 * w);\n            ctx.lineTo(0.05 * w, 0.15 * w);\n            ctx.lineTo(-0.05 * w, 0.25 * w);\n            ctx.lineTo(0.05 * w, 0.35 * w);\n            ctx.strokeStyle = '#6C6C6C';\n            ctx.stroke();\n            ctx.closePath();\n            ctx.restore();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 追蹤導彈座 */\nexport class missileBase {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'missileBase';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '追蹤導彈發射台',\n            direction: 'up',\n            rotate: true,\n        };\n\n        this.loadable = false;\n\n        this.active = false;\n\n        this.r = 2.5;\n        this.range = 0.125;\n        this.lastFire = Date.now();\n        this.unfoldTime = 500;\n        this.unfoldCycle = 0;\n        this.rotateSpeed = 0.2; // 1秒幾圈\n        this.rotateCycle = 0;\n        this.find = false;\n        this.findTarget = null;\n        this.lastFind = 0;\n        this.findCycle = 0;\n        this.findTime = 2500;\n\n        this.perspective = false;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new missileBase();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\n            rotate: { type: 'check' },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n            rotate: this.detail.rotate,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n        this.detail.rotate = objectSetting.rotate;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        this.unfoldCycle = (Date.now() - this.lastFire) / this.unfoldTime;\n        this.unfoldCycle = (this.unfoldCycle > 1) ? 1 : this.unfoldCycle;\n        this.rotateCycle = (this.unfoldCycle === 1 && this.detail.rotate) ? (Date.now() - this.lastFire - this.unfoldTime) / 1000 * this.rotateSpeed : 0;\n        if (this.find) this.findCycle = (Date.now() - this.lastFind) / this.findTime;\n        if (this.findCycle >= 1) {\n            this.find = false;\n            this.findCycle = 0;\n            this.lastFire = Date.now();\n            const result = {\n                type: 'produce',\n                object: new missile(this.pos),\n            };\n            result.object.target = this.findTarget;\n            return result;\n        }\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.35 * w }, target)) return 'missileBase';\n        if (!this.find && isCollision({ type: 'sphere', pos: this.pos, r: 2.5 * w }, target)) {\n            const parameters = {\n                up: 1.5, down: 0.5, left: 1, right: 0,\n            }\n            let radian = target.pos.sub(this.pos).radian();\n            let minRadian = ((parameters[this.detail.direction] + 2 * this.rotateCycle - this.range * this.unfoldCycle) * Math.PI) % (2 * Math.PI);\n            let maxRadian = ((parameters[this.detail.direction] + 2 * this.rotateCycle + this.range * this.unfoldCycle) * Math.PI) % (2 * Math.PI);\n            if (maxRadian < minRadian) {\n                maxRadian += 2 * Math.PI;\n                if (radian < Math.PI) radian += 2 * Math.PI;\n            }\n            if (radian >= minRadian && radian <= maxRadian) return 'missileRay';\n        }\n        return 'none';\n    }\n    fire(target) {\n        this.find = true;\n        this.findTarget = target;\n        this.lastFind = Date.now();\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        let unit = 0.7 * w / (1 + Math.sqrt(2));\n        ctx.moveTo(-0.5 * unit, -(0.5 + Math.sqrt(0.5)) * unit);\n        ctx.lineTo(0.5 * unit, -(0.5 + Math.sqrt(0.5)) * unit);\n        ctx.lineTo((0.5 + Math.sqrt(0.5)) * unit, -0.5 * unit);\n        ctx.lineTo((0.5 + Math.sqrt(0.5)) * unit, 0.5 * unit);\n        ctx.lineTo(0.5 * unit, (0.5 + Math.sqrt(0.5)) * unit);\n        ctx.lineTo(-0.5 * unit, (0.5 + Math.sqrt(0.5)) * unit);\n        ctx.lineTo(-(0.5 + Math.sqrt(0.5)) * unit, 0.5 * unit);\n        ctx.lineTo(-(0.5 + Math.sqrt(0.5)) * unit, -0.5 * unit);\n        ctx.lineTo(-0.5 * unit, -(0.5 + Math.sqrt(0.5)) * unit);\n        let grd = ctx.createRadialGradient(-0.1 * w, -0.1 * w, 1, 0, 0, 0.35 * w);\n        grd.addColorStop(0, 'white');\n        grd.addColorStop(1, '#AAAAFF');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.strokeStyle = '#7D7DFF';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.globalAlpha *= 0.6;\n        ctx.beginPath();\n        ctx.arc(0, 0, 0.1 * w, 0, 2 * Math.PI);\n        grd = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.1 * w);\n        grd.addColorStop(0, 'white');\n        grd.addColorStop(0.4, '#FF2D2D');\n        grd.addColorStop(1, '#FF2D2D');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.strokeStyle = '#FF2D2D';\n        ctx.stroke();\n        ctx.closePath();\n\n        if (this.active) {\n            grd = ctx.createRadialGradient(0, 0, 0, 0, 0, this.r * w);\n            grd.addColorStop(0, 'white');\n            grd.addColorStop(0.6, '#FF5151');\n            grd.addColorStop(1, '#FF0000');\n            if (!this.find) {\n                ctx.beginPath();\n                const parameters = {\n                    up: 1.5, down: 0.5, left: 1, right: 0,\n                }\n                ctx.arc(0, 0, this.r * w, (parameters[this.detail.direction] + 2 * this.rotateCycle - this.range * this.unfoldCycle) * Math.PI,\n                    (parameters[this.detail.direction] + 2 * this.rotateCycle + this.range * this.unfoldCycle) * Math.PI);\n                ctx.lineTo(0, 0);\n                ctx.fillStyle = grd;\n                ctx.fill();\n                ctx.closePath();\n            } else {\n                ctx.globalAlpha *= 0.4 * ((this.findCycle * 6) % 1);\n                ctx.beginPath();\n                ctx.arc(0, 0, this.r * w, 0, 2 * Math.PI);\n                ctx.fillStyle = grd;\n                ctx.fill();\n                ctx.closePath();\n            }\n        }\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.active = true;\n        this.lastFire = Date.now();\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 追蹤導彈 */\nexport class missile {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'missile';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = new Vec2(-1, -1);\n\n        this.detail = {\n            name: '追蹤導彈',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.target = null;\n        this.dirVec = new Vec2(0, 0);\n        this.speed = 2;\n        this.lastRecord = Date.now();\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new missile();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    update(objects, map) {\n        if (!this.pos.between(constant.mapStart, constant.mapStart.add(constant.mapSize.mul(w)))) return { type: 'destory' };\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].id !== this.id && objects[i].collision) {\n                let result = objects[i].collision({ type: 'sphere', pos: this.pos, r: 0.1 });\n                if (result === 'ice') this.speed *= 1.01;\n                else if (result === 'portal') this.pos = objects[i].teleport(objects);\n                else if (result === 'arrow') return { type: 'destory' };\n                else if (result === 'cymbalWave') return { type: 'destory' };\n                else if (result === 'missile') return { type: 'destory' };\n                else if (result === 'block') return { type: 'destory' };\n                else if (result === 'lockedWall') return { type: 'destory' };\n                else if (result === 'woodenBox') {\n                    objects[i].push(objects, map, this.pos);\n                    return { type: 'destory' };\n                }\n                else if (result === 'magneticField') this.pos = this.pos.add(objects[i].getDisplacement());\n            }\n        }\n        this.dirVec = this.target.pos.sub(this.pos).unit();\n        this.pos = this.pos.add(this.dirVec.mul(this.speed * w * (Date.now() - this.lastRecord) / 1000));\n        this.lastRecord = Date.now();\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'sphere', pos: this.pos, r: 0.2 * w }, target)) return 'missile';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.9 : 1;\n        ctx.rotate(this.dirVec.radian() + 0.5 * Math.PI);\n\n        for (let i = 0; i < 2; i++) {\n            let p = (i === 0) ? -1 : 1;\n            ctx.beginPath();\n            ctx.moveTo(0.164 * w * p, 0.2 * w);\n            ctx.lineTo(0.3 * w * p, 0.3 * w);\n            ctx.lineTo(0.3 * w * p, 0.45 * w);\n            ctx.lineTo(0.128 * w * p, 0.4 * w);\n            ctx.fillStyle = '#F0F0F0';\n            ctx.fill();\n            ctx.strokeStyle = '#C0C0C0';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.beginPath();\n        ctx.moveTo(-0.1 * w, 0.5 * w);\n        ctx.lineTo(-0.14 * w, 0.64 * w + 0.06 * w * Math.random());\n        ctx.lineTo(-0.03 * w, 0.56 * w);\n        ctx.lineTo(0 * w, 0.6 * w + 0.06 * w * Math.random());\n        ctx.lineTo(0.03 * w, 0.56 * w);\n        ctx.lineTo(0.14 * w, 0.64 * w + 0.06 * w * Math.random());\n        ctx.lineTo(0.1 * w, 0.5 * w);\n        ctx.fillStyle = '#FF9224';\n        ctx.fill();\n        ctx.lineWidth = 0.3;\n        ctx.strokeStyle = '#FF0000';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.lineWidth = 1;\n        ctx.beginPath();\n        ctx.arc(0, 0, 0.2 * w, 0, Math.PI, true);\n        ctx.lineTo(-0.11 * w, 0.5 * w);\n        ctx.lineTo(0.11 * w, 0.5 * w);\n        ctx.lineTo(0.2 * w, 0);\n        ctx.fillStyle = '#F0F0F0';\n        ctx.fill();\n        ctx.strokeStyle = '#C0C0C0';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.moveTo(-0.195 * w, 0);\n        ctx.lineTo(0.195 * w, 0);\n        ctx.strokeStyle = 'red';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.moveTo(-0.186 * w, 0.05 * w);\n        ctx.lineTo(0.186 * w, 0.05 * w);\n        ctx.strokeStyle = 'red';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n}\n\n/* 鎖牆 */\nexport class lockedWall {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'lockedWall';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '上鎖的牆',\n            direction: 'horizontal',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.locked = true;\n        this.index = -1;\n\n        this.layer = new Layer(2, 3);\n    }\n    clone() {\n        const cloneObject = new lockedWall();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            direction: { type: 'select', options: ['horizontal', 'vertical'] },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n\n            index: this.index,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n\n        this.index = objectSetting.index;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        const parameters = {\n            horizontal: new Vec2(w, 0.4 * w), vertical: new Vec2(0.4 * w, w),\n        };\n        if (this.locked && isCollision({ type: 'cube', pos: this.pos, size: parameters[this.detail.direction] }, target)) return 'lockedWall';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        if (!this.locked) return;\n\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.6 : 1;\n        if (this.detail.direction === 'vertical') ctx.rotate(0.5 * Math.PI);\n\n        ctx.beginPath();\n        ctx.rect(-0.5 * w, -0.1 * w, w, 0.2 * w);\n        ctx.fillStyle = '#9D9D9D';\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.globalAlpha = 1;\n        ctx.beginPath();\n        ctx.arc(0, 0, 0.2 * w, 0, 2 * Math.PI);\n        ctx.fillStyle = (this.index >= 0) ? colorList[this.index] : 'white';\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.arc(0, -0.06 * w, 0.08 * w, 0.375 * Math.PI, 0.625 * Math.PI, true);\n        ctx.lineTo(-0.04 * w, 0.13 * w);\n        ctx.lineTo(0.04 * w, 0.13 * w);\n        ctx.fillStyle = 'black';\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        if (this.index === -1) {\n            let usedIndex = [0, 0, 0, 0, 0, 0, 0, 0];\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].type === 'unlocker') usedIndex[objects[i].index] = Math.max(1, usedIndex[objects[i].index]);\n                if (objects[i].type === 'lockedWall') usedIndex[objects[i].index] = 2;\n            }\n            for (let i = 0; i < usedIndex.length; i++) {\n                if (usedIndex[i] === 1) {\n                    this.index = i;\n                    break;\n                }\n            }\n            if (this.index === -1) {\n                for (let i = 0; i < usedIndex.length; i++) {\n                    if (usedIndex[i] === 0) {\n                        this.index = i;\n                        break;\n                    }\n                }\n            }\n        }\n        if (this.index === -1) return false;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 鑰匙 */\nexport class unlocker {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'unlocker';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '鑰匙'\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.used = false;\n        this.index = -1;\n\n        this.layer = new Layer(4);\n    }\n    clone() {\n        const cloneObject = new unlocker();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n\n            index: this.index,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.index = objectSetting.index;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (!this.used && isCollision({ type: 'sphere', pos: this.pos, r: 0.35 * w }, target)) return 'unlocker';\n        return 'none';\n    }\n    unlock(objects) {\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].type === 'lockedWall' && objects[i].index === this.index) {\n                objects[i].locked = false;\n                this.used = true;\n            }\n        }\n    }\n    draw(ctx, layer = -1) {\n        if (this.used) return;\n\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n        ctx.rotate(0.25 * Math.PI);\n\n        ctx.beginPath();\n        ctx.arc(0, -0.25 * w, 0.2 * w, 0.4 * Math.PI, 0.6 * Math.PI, true);\n        ctx.lineTo(-0.06 * w, 0.4 * w);\n        ctx.lineTo(0.06 * w, 0.45 * w);\n        ctx.lineTo(0.06 * w, 0.38 * w);\n        ctx.lineTo(0.15 * w, 0.38 * w);\n        ctx.lineTo(0.15 * w, 0.34 * w);\n        ctx.lineTo(0.06 * w, 0.34 * w);\n        ctx.lineTo(0.06 * w, 0.3 * w);\n        ctx.lineTo(0.18 * w, 0.3 * w);\n        ctx.lineTo(0.18 * w, 0.24 * w);\n        ctx.lineTo(0.06 * w, 0.24 * w);\n        let grd = ctx.createRadialGradient(0, -0.35 * w, 0, 0, 0, 0.5 * w);\n        grd.addColorStop(0, 'white');\n        grd.addColorStop(0.3, (this.index >= 0) ? colorList[this.index] : 'black');\n        grd.addColorStop(1, (this.index >= 0) ? colorList[this.index] : 'black');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        if (this.index === -1) {\n            let usedIndex = [0, 0, 0, 0, 0, 0, 0, 0];\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].type === 'lockedWall') usedIndex[objects[i].index] = Math.max(1, usedIndex[objects[i].index]);\n                if (objects[i].type === 'unlocker') usedIndex[objects[i].index] = 2;\n            }\n            for (let i = 0; i < usedIndex.length; i++) {\n                if (usedIndex[i] === 1) {\n                    this.index = i;\n                    break;\n                }\n            }\n            if (this.index === -1) {\n                for (let i = 0; i < usedIndex.length; i++) {\n                    if (usedIndex[i] === 0) {\n                        this.index = i;\n                        break;\n                    }\n                }\n            }\n        }\n        if (this.index === -1) return false;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        return true;\n    }\n    remove(map, objects) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 方塊 */\nexport class block {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'block';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '方塊',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new block();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(w, w) }, target)) return 'block';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.4 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(-0.5 * w, -0.5 * w);\n        ctx.lineTo(0.5 * w, -0.5 * w);\n        ctx.lineTo(0.5 * w, 0.5 * w);\n        ctx.lineTo(-0.5 * w, 0.5 * w);\n        ctx.lineTo(-0.5 * w, -0.5 * w);\n        ctx.fillStyle = '#7B7B7B';\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.5 * w, -0.5 * w, w, w);\n        ctx.fillStyle = '#9D9D9D';\n        ctx.fill();\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 移動平台-斜向 */\nexport class movingPlatform_oblique {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'movingPlatform_oblique';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '移動平台(斜向)',\n            direction: 'right-up',\n            distance: 1,\n            speed: 'normal',\n        };\n\n        this.loadable = true;\n        this.loadObject = null;\n\n        this.lastRecord = Date.now();\n        this.active = false;\n        this.perspective = false;\n\n        this.layer = new Layer(0, 1);\n    }\n    clone() {\n        const cloneObject = new movingPlatform_oblique();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            distance: { type: 'int', min: 1, max: 15 },\n            direction: { type: 'select', options: ['right-up', 'right-down', 'left-up', 'left-down'] },\n            speed: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n            distance: this.detail.distance,\n            speed: this.detail.speed,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n        this.detail.distance = objectSetting.distance;\n        this.detail.speed = objectSetting.speed;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        const parameters = {\n            'super slow': 5600, 'slow': 2800, 'normal': 1400, 'fast': 700, 'super fast': 280,\n        };\n        const dirVec = Vec2.direction(this.detail.direction).mul(this.detail.distance * w * Math.sqrt(2));\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n        if (~~((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 2 === 0) {\n            this.pos = originPos.add(dirVec.mul(((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\n        } else {\n            this.pos = originPos.add(dirVec.mul(1 - ((Date.now() - this.lastRecord) / parameters[this.detail.speed] / this.detail.distance) % 1));\n        }\n        if (this.loadObject) this.loadObject.object.pos = this.pos;\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'movingPlatform';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n        if (this.active) ctx.translate(originPos.x, originPos.y);\n        else ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        if (layer === -1 || layer === 0) {\n            ctx.save();\n            const dirVec = Vec2.direction(this.detail.direction).mul(this.detail.distance * w * Math.sqrt(2));\n\n            ctx.beginPath();\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(dirVec.x, dirVec.y);\n            ctx.strokeStyle = '#4F4F4F';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.save();\n            ctx.translate(dirVec.x, dirVec.y);\n            ctx.beginPath();\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n            ctx.restore();\n\n            ctx.restore();\n        }\n\n        if (layer === -1 || layer === 1) {\n            if (this.active) {\n                const relativePos = this.pos.sub(originPos);\n                ctx.translate(relativePos.x, relativePos.y);\n            }\n\n            ctx.beginPath();\n            ctx.moveTo(0, (-0.45) * w);\n            ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\n            ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\n            ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\n            ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\n            ctx.lineTo(0, (-0.45) * w);\n            ctx.fillStyle = '#ead48b';\n            ctx.fill();\n            ctx.strokeStyle = '#cb934d';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0, (-0.35) * w);\n            ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n            ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n            ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n            ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n            ctx.lineTo(0, (-0.35) * w);\n            ctx.strokeStyle = '#f4f788';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.active = true;\n        this.lastRecord = Date.now();\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    this.loadObject = {\n                        id: objects[i].id,\n                        object: objects[i],\n                    };\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 移動平台-矩形 */\nexport class movingPlatform_rect {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'movingPlatform_rect';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '移動平台(矩形)',\n            clock: 'clockwise',\n            width: 1,\n            height: 1,\n            speed: 'normal',\n        };\n\n        this.loadable = true;\n        this.loadObject = null;\n\n        this.lastRecord = Date.now();\n        this.active = false;\n        this.perspective = false;\n\n        this.layer = new Layer(0, 1);\n    }\n    clone() {\n        const cloneObject = new movingPlatform_rect();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            clock: { type: 'select', options: ['clockwise', 'counterclockwise'] },\n            width: { type: 'int', min: 1, max: 15 },\n            height: { type: 'int', min: 1, max: 15 },\n            speed: { type: 'select', options: ['super slow', 'slow', 'normal', 'fast', 'super fast'] }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            clock: this.detail.clock,\n            width: this.detail.width,\n            height: this.detail.height,\n            speed: this.detail.speed,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.start = objectSetting.start;\n        this.detail.width = objectSetting.width;\n        this.detail.height = objectSetting.height;\n        this.detail.speed = objectSetting.speed;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        const parameters = {\n            'super slow': 4000, 'slow': 2000, 'normal': 1000, 'fast': 500, 'super fast': 200,\n        };\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n        let totalDist = this.detail.width * 2 + this.detail.height * 2;\n        let cycleList = (this.detail.clockwise === 'clockwise') ?\n            [0, this.detail.height / totalDist, (this.detail.height + this.detail.width) / totalDist, (2 * this.detail.height + this.detail.width) / totalDist] :\n            [0, this.detail.width / totalDist, (this.detail.height + this.detail.width) / totalDist, (this.detail.height + 2 * this.detail.width) / totalDist];\n        let pointList = (this.detail.clockwise === 'clockwise') ?\n            [originPos, originPos.add(new Vec2(0, - this.detail.height * w)), originPos.add(new Vec2(this.detail.width * w, - this.detail.height * w)), originPos.add(new Vec2(this.detail.width * w, 0))] :\n            [originPos, originPos.add(new Vec2(this.detail.width * w, 0)), originPos.add(new Vec2(this.detail.width * w, - this.detail.height * w)), originPos.add(new Vec2(0, - this.detail.height * w))]  ;\n        let moveCycle = ((Date.now() - this.lastRecord) / parameters[this.detail.speed] / totalDist) % 1;\n        if (moveCycle >= cycleList[0] && moveCycle < cycleList[1]) {\n            this.pos = pointList[0].add(pointList[1].sub(pointList[0]).mul((moveCycle - cycleList[0]) / (cycleList[1] - cycleList[0])));\n        } else if (moveCycle >= cycleList[1] && moveCycle < cycleList[2]) {\n            this.pos = pointList[1].add(pointList[2].sub(pointList[1]).mul((moveCycle - cycleList[1]) / (cycleList[2] - cycleList[1])));\n        } else if (moveCycle >= cycleList[2] && moveCycle < cycleList[3]) {\n            this.pos = pointList[2].add(pointList[3].sub(pointList[2]).mul((moveCycle - cycleList[2]) / (cycleList[3] - cycleList[2])));\n        } else {\n            this.pos = pointList[3].add(pointList[0].sub(pointList[3]).mul((moveCycle - cycleList[3]) / (1 - cycleList[3])));\n        }\n        if (this.loadObject) this.loadObject.object.pos = this.pos;\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.9 * w, 0.9 * w) }, target)) return 'movingPlatform';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        const originPos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n        if (this.active) ctx.translate(originPos.x, originPos.y);\n        else ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        if (layer === -1 || layer === 0) {\n            ctx.save();\n\n            ctx.beginPath();\n            ctx.rect(0, - this.detail.height * w, this.detail.width * w, this.detail.height * w);\n            ctx.lineWidth = 1;\n            ctx.strokeStyle = '#4F4F4F';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.rect(-0.1 * w, -0.1 * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.rect(-0.1 * w, -0.1 * w - this.detail.height * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.rect(-0.1 * w + this.detail.width * w, -0.1 * w - this.detail.height * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.rect(-0.1 * w + this.detail.width * w, -0.1 * w, 0.2 * w, 0.2 * w);\n            ctx.fillStyle = '#4F4F4F';\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.restore();\n        }\n\n        if (layer === -1 || layer === 1) {\n            if (this.active) {\n                const relativePos = this.pos.sub(originPos);\n                ctx.translate(relativePos.x, relativePos.y);\n            }\n\n            ctx.beginPath();\n            ctx.moveTo(0, (-0.45) * w);\n            ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\n            ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\n            ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\n            ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\n            ctx.lineTo(0, (-0.45) * w);\n            ctx.fillStyle = '#ead48b';\n            ctx.fill();\n            ctx.strokeStyle = '#cb934d';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0, (-0.35) * w);\n            ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n            ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n            ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n            ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n            ctx.lineTo(0, (-0.35) * w);\n            ctx.strokeStyle = '#f4f788';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.active = true;\n        this.lastRecord = Date.now();\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    this.loadObject = {\n                        id: objects[i].id,\n                        object: objects[i],\n                    };\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 木箱 */\nexport class woodenBox {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'woodenBox';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '木箱',\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.moveTo = 'none';\n        this.moveTime = 500;\n        this.moveCycle = 0;\n        this.lastRecord = 0;\n\n        this.layer = new Layer(3);\n    }\n    clone() {\n        const cloneObject = new woodenBox();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        if (this.moveTo !== 'none') {\n            let moveRate = (Date.now() - this.lastRecord) / this.moveTime;\n            this.moveCycle += moveRate;\n            this.lastRecord = Date.now();\n            this.pos = this.pos.add(Vec2.direction(this.moveTo).mul(w * moveRate));\n            if (this.moveCycle >= 1) {\n                this.moveTo = 'none';\n                this.pos = this.pos.sub(constant.mapStart).toGrid(w).mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n            }\n        } else {\n            let gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].type !== 'brokenPlatform' && objects[i].type !== 'magnet' && objects[i].type !== 'conveyor' && objects[i].type !== 'mucus') continue;\n                if (objects[i].id !== this.id && objects[i].collision) {\n                    let result = objects[i].collision({ type: 'sphere', pos: this.pos, r: 0.1 });\n                    if (result === 'brokenPlatform') objects[i].break();\n                    if (result === 'conveyor') {\n                        this.pos = objects[i].pos.clone();\n                        this.push(objects, map, this.pos.sub(Vec2.direction(objects[i].detail.direction)));\n                        break;\n                    } else if (result === 'magneticField') {\n                        this.push(objects, map, this.pos.sub(objects[i].getDisplacement()));\n                        break;\n                    } else if (result === 'mucus' && !objects[i].loadObject) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                        map[this.gridPos.y][this.gridPos.x].layer.status[3] = false;\n                    }\n                    \n                }\n            }\n        }\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(w, w) }, target)) return 'woodenBox';\n        return 'none';\n    }\n    push(objects, map, targetPos) {\n        if (this.moveTo !== 'none') return;\n        let gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let radian = targetPos.sub(this.pos).radian();\n        if (radian >= 0.25 * Math.PI && radian < 0.75 * Math.PI) { // 上\n            if (gridPos.y === 0 || map[gridPos.y - 1][gridPos.x].type === 'block') return;\n            for (let i = 0; i < objects.length; i++) {\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\n                if (searchGridPos.equal(new Vec2(gridPos.x, gridPos.y - 1)) && objects[i].layer.status[3]) return;\n            }\n            this.moveTo = 'up';\n        } else if (radian >= 1.75 * Math.PI || radian < 0.25 * Math.PI) { // 左\n            if (gridPos.x === 0 || map[gridPos.y][gridPos.x - 1].type === 'block') return;\n            for (let i = 0; i < objects.length; i++) {\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\n                if (searchGridPos.equal(new Vec2(gridPos.x - 1, gridPos.y)) && objects[i].layer.status[3]) return;\n            }\n            this.moveTo = 'left';\n        } else if (radian >= 1.25 * Math.PI && radian < 1.75 * Math.PI) { // 下\n            if (gridPos.y === constant.mapSize.y - 1 || map[gridPos.y + 1][gridPos.x].type === 'block') return;\n            for (let i = 0; i < objects.length; i++) {\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\n                if (searchGridPos.equal(new Vec2(gridPos.x, gridPos.y + 1)) && objects[i].layer.status[3]) return;\n            }\n            this.moveTo = 'down';\n        } else { // 右\n            if (gridPos.x === constant.mapSize.x - 1 || map[gridPos.y][gridPos.x + 1].type === 'block') return;\n            for (let i = 0; i < objects.length; i++) {\n                let searchGridPos = objects[i].pos.sub(constant.mapStart).toGrid(w);\n                if (searchGridPos.equal(new Vec2(gridPos.x + 1, gridPos.y)) && objects[i].layer.status[3]) return;\n            }\n            this.moveTo = 'right';\n        }\n        map[this.gridPos.y][this.gridPos.x].layer.status[3] = false;\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].type === 'mucus') {\n                if (objects[i].loadObject && objects[i].loadObject.id === this.id) {\n                    objects[i].loadObject = null;\n                    this.pos = this.pos.sub(constant.mapStart).toGrid(w).mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n                }\n            }\n        }\n        this.moveCycle = 0;\n        this.lastRecord = Date.now();\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.7 : 1;\n        ctx.lineWidth = 1;\n\n        ctx.beginPath();\n        ctx.rect(-0.45 * w, -0.4 * w, 0.9 * w, 0.8 * w);\n        ctx.fillStyle = '#e4b95e';\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.5 * w, -0.5 * w, w, 0.1 * w);\n        ctx.fillStyle = '#dab25d';\n        ctx.fill();\n        ctx.strokeStyle = '#806938';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.5 * w, 0.4 * w, w, 0.1 * w);\n        ctx.fillStyle = '#dab25d';\n        ctx.fill();\n        ctx.strokeStyle = '#806938';\n        ctx.stroke();\n        ctx.closePath();\n\n        for (let i = 0; i < 7; i++) {\n            ctx.beginPath();\n            ctx.moveTo((-0.45 + i * 0.15) * w, -0.4 * w);\n            ctx.lineTo((-0.45 + i * 0.15) * w, 0.4 * w);\n            ctx.strokeStyle = '#806938';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[2]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 2) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        for (let i = 0; i < objects.length; i++) {\n            if (objects[i].layer.top() === 2) {\n                if (objects[i].loadObject && objects[i].loadObject.id === this.id) {\n                    objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}\n\n/* 磁鐵 */\nexport class magnet {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'magnet';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '磁鐵',\n            direction: 'up',\n            magneticField: 'attraction',\n            distance: 3,\n        };\n\n        this.loadable = false;\n\n        this.active = false;\n        this.perspective = false;\n\n        this.lastRecord = 0;\n        this.moveCycle = -1;\n\n        this.layer = new Layer(4);\n    }\n    clone() {\n        const cloneObject = new magnet();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' },\n            direction: { type: 'select', options: ['up', 'down', 'left', 'right'] },\n            magneticField: { type: 'select', options: ['attraction', 'repulsion'] },\n            distance: { type: 'int', min: 1, max: 15 },\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n            direction: this.detail.direction,\n            magneticField: this.detail.magneticField,\n            distance: this.detail.distance,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n        this.detail.direction = objectSetting.direction;\n        this.detail.magneticField = objectSetting.magneticField;\n        this.detail.distance = objectSetting.distance;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        if (Date.now() - this.lastRecord > 1000) this.lastRecord = Date.now();\n        this.moveCycle = (Date.now() - this.lastRecord) / 1000;\n        return { type: 'none' };\n    }\n    collision(target) {\n        let dirVec = Vec2.direction(this.detail.direction).mul(w * this.detail.distance / 2);\n        let size = (this.detail.direction === 'up' || this.detail.direction === 'down') ? new Vec2(w, this.detail.distance * w + 0.5 * w) : new Vec2(this.detail.distance * w + 0.5 * w, w) ;\n        if (isCollision({ type: 'cube', pos: this.pos.add(dirVec), size: size }, target)) return 'magneticField';\n        return 'none';\n    }\n    getDisplacement() {\n        return Vec2.direction(this.detail.direction).mul((this.detail.magneticField === 'attraction')? -1: 1).mul(w * 0.01);\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n        let dir = this.detail.direction;\n        ctx.rotate((dir === 'up') ? 0 : (dir === 'down') ? Math.PI : (dir === 'left') ? 1.5 * Math.PI : 0.5 * Math.PI);\n\n        ctx.beginPath();\n        ctx.moveTo(0.4 * w, -0.4 * w);\n        ctx.arc(0, 0, 0.4 * w, 0, Math.PI);\n        ctx.lineTo(-0.4 * w, -0.4 * w);\n        ctx.lineTo(-0.2 * w, -0.4 * w);\n        ctx.lineTo(-0.2 * w, 0);\n        ctx.arc(0, 0, 0.2 * w, Math.PI, 0, true);\n        ctx.lineTo(0.2 * w, -0.4 * w);\n        ctx.lineTo(0.4 * w, -0.4 * w);\n        ctx.fillStyle = '#43315e';\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.rect(-0.38 * w, -0.4 * w, 0.16 * w, 0.3 * w);\n        ctx.fillStyle = 'red';\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = 'middle';\n        ctx.font = \"5px italic\";\n        ctx.fillStyle = 'white';\n        ctx.fillText(\"N\", -0.3 * w, -0.25 * w);\n\n        ctx.beginPath();\n        ctx.rect(0.22 * w, -0.4 * w, 0.16 * w, 0.3 * w);\n        ctx.fillStyle = 'blue';\n        ctx.fill();\n        ctx.closePath();\n\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = 'middle';\n        ctx.font = \"6px italic\";\n        ctx.fillStyle = 'white';\n        ctx.fillText(\"S\", 0.3 * w, -0.25 * w);\n\n        ctx.beginPath();\n        ctx.moveTo(0.4 * w, -0.4 * w);\n        ctx.arc(0, 0, 0.4 * w, 0, Math.PI);\n        ctx.lineTo(-0.4 * w, -0.4 * w);\n        ctx.lineTo(-0.2 * w, -0.4 * w);\n        ctx.lineTo(-0.2 * w, 0);\n        ctx.arc(0, 0, 0.2 * w, Math.PI, 0, true);\n        ctx.lineTo(0.2 * w, -0.4 * w);\n        ctx.lineTo(0.4 * w, -0.4 * w);\n        ctx.strokeStyle = 'black';\n        ctx.stroke();\n        ctx.closePath();\n\n        if (this.active && this.moveCycle >= 0) {\n            ctx.beginPath();\n            ctx.rect(-0.5 * w, -0.5 * w - w * this.detail.distance, w, w * this.detail.distance);\n            ctx.clip();\n            ctx.closePath();\n\n            ctx.globalAlpha = 0.3;\n            ctx.translate(0, w * this.moveCycle * ((this.detail.magneticField == 'repulsion') ? -1 : 1));\n\n            ctx.beginPath();\n            ctx.moveTo(-0.3 * w, 0.5 * w);\n            ctx.lineTo(-0.3 * w, 0.5 * w - w * this.detail.distance - 2 * w);\n            ctx.setLineDash([0.5, 0, 5]);\n            ctx.strokeStyle = 'gray';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0, 0.5 * w);\n            ctx.lineTo(0, 0.5 * w - w * this.detail.distance - 2 * w);\n            ctx.setLineDash([0.5, 0, 5]);\n            ctx.strokeStyle = 'gray';\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0.3 * w, 0.5 * w);\n            ctx.lineTo(0.3 * w, 0.5 * w - w * this.detail.distance - 2 * w);\n            ctx.setLineDash([0.5, 0, 5]);\n            ctx.strokeStyle = 'gray';\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.active = true;\n        this.moveCycle = -1;\n        this.lastRecord = Date.now();\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        this.lastRecord = Date.now();\n        return true;\n    }\n    remove(map, objects = null) {\n        this.active = false;\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 破碎平台 */\nexport class brokenPlatform {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'brokenPlatform';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '破碎平台'\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.lastRecord = 0;\n        this.stage = 0;\n        this.count = 0;\n        this.stageCount = 64;\n\n        this.layer = new Layer(1, 2);\n    }\n    clone() {\n        const cloneObject = new brokenPlatform();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    update(objects, map) {\n        if (this.count >= this.stageCount && this.stage < 4) {\n            this.count = 0;\n            this.stage += 1;\n        }\n        return { type: 'none' };\n    }\n    collision(target) {\n        if (this.stage < 4 && isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.99 * w, 0.99 * w) }, target)) return 'brokenPlatform';\n        return 'none';\n    }\n    break() {\n        this.count += 1;\n    }\n    draw(ctx, layer = -1) {\n        if (this.stage === 4) return;\n\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.45) * w);\n        ctx.arcTo(0.45 * w, (-0.45) * w, 0.45 * w, 0.45 * w, 0.1 * w);\n        ctx.arcTo(0.45 * w, 0.45 * w, (-0.45) * w, 0.45 * w, 0.1 * w);\n        ctx.arcTo((-0.45) * w, 0.45 * w, (-0.45) * w, (-0.45) * w, 0.1 * w);\n        ctx.arcTo((-0.45) * w, (-0.45) * w, 0.45 * w, (-0.45) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.45) * w);\n        ctx.fillStyle = '#D0D0D0';\n        ctx.fill();\n        ctx.strokeStyle = '#ADADAD';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.35) * w);\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.35) * w);\n        ctx.strokeStyle = '#F0F0F0';\n        ctx.stroke();\n        ctx.closePath();\n\n        if (this.stage >= 0) {\n            ctx.save();\n            ctx.strokeStyle = '#ADADAD';\n            ctx.globalAlpha *= (this.stage > 0) ? 1: (this.count) / this.stageCount;\n\n            ctx.beginPath();\n            ctx.moveTo(0.1 * w, -0.45 * w);\n            ctx.lineTo(0.05 * w, -0.35 * w);\n            ctx.lineTo(0.15 * w, -0.25 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(-0.45 * w, 0.15 * w);\n            ctx.lineTo(-0.35 * w, -0.05 * w);\n            ctx.lineTo(-0.25 * w, 0.05 * w);\n            ctx.lineTo(-0.15 * w, -0.15 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0.15 * w, 0.45 * w);\n            ctx.lineTo(0.25 * w, 0.4 * w);\n            ctx.lineTo(0.2 * w, 0.3 * w);\n            ctx.lineTo(0.35 * w, 0.1 * w);\n            ctx.stroke();\n            ctx.closePath();\n            ctx.restore();\n        }\n\n        if (this.stage >= 1) {\n            ctx.save();\n            ctx.strokeStyle = '#ADADAD';\n            ctx.globalAlpha *= (this.stage > 1) ? 1 : (this.count) / this.stageCount;\n\n            ctx.beginPath();\n            ctx.moveTo(-0.15 * w, 0.45 * w);\n            ctx.lineTo(0 * w, 0.35 * w);\n            ctx.lineTo(-0.1 * w, 0.25 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0.45 * w, -0.3 * w);\n            ctx.lineTo(0.35 * w, -0.2 * w);\n            ctx.lineTo(0.3 * w, -0.05 * w);\n            ctx.lineTo(0.1 * w, -0.15 * w);\n            ctx.lineTo(-0.1 * w, 0.05 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(-0.35 * w, -0.45 * w);\n            ctx.lineTo(-0.2 * w, -0.3 * w);\n            ctx.stroke();\n            ctx.closePath();\n            ctx.restore();\n        }\n\n        if (this.stage >= 2) {\n            ctx.save();\n            ctx.strokeStyle = '#ADADAD';\n            ctx.globalAlpha *= (this.stage > 2) ? 1 : (this.count) / this.stageCount;\n\n            ctx.beginPath();\n            ctx.moveTo(-0.45 * w, 0.37 * w);\n            ctx.lineTo(-0.36 * w, 0.3 * w);\n            ctx.lineTo(-0.23 * w, 0.35 * w);\n            ctx.lineTo(-0.01 * w, 0.09 * w);\n            ctx.lineTo(0.23 * w, 0.21 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(-0.45 * w, 0.21 * w);\n            ctx.lineTo(-0.2 * w, 0.16 * w);\n            ctx.lineTo(-0.02 * w, -0.02 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(-0.05 * w, -0.45 * w);\n            ctx.lineTo(-0.18 * w, -0.36 * w);\n            ctx.lineTo(0.03 * w, -0.28 * w);\n            ctx.lineTo(-0.28 * w, -0.16 * w);\n            ctx.lineTo(-0.38 * w, -0.25 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0.34 * w, -0.45 * w);\n            ctx.lineTo(0.27 * w, -0.32 * w);\n            ctx.lineTo(0.3 * w, -0.09 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0.45 * w, 0.31 * w);\n            ctx.lineTo(0.4 * w, 0.14 * w);\n            ctx.lineTo(0.3 * w, 0.22 * w);\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(0.45 * w, 0.01 * w);\n            ctx.lineTo(0.2 * w, 0.03 * w);\n            ctx.stroke();\n            ctx.closePath();\n            ctx.restore();\n        }\n\n        ctx.restore();\n    }\n    place(map, objects = null) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        return true;\n    }\n    remove(map, objects = null) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n    }\n}\n\n/* 死亡圖騰 */\nexport class deathTotem {\n    constructor(pos = new Vec2(0, 0)) {\n        this.type = 'deathTotem';\n        this.id = uuidv4();\n        this.pos = pos;\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n\n        this.detail = {\n            name: '死亡圖騰'\n        };\n\n        this.loadable = false;\n\n        this.perspective = false;\n\n        this.layer = new Layer(2);\n    }\n    clone() {\n        const cloneObject = new deathTotem();\n        cloneObject.unpackage(this.enpackage());\n        return cloneObject;\n    }\n    setPerspective(perspective) {\n        this.perspective = perspective;\n    }\n    detailFunction() {\n        return {\n            name: { type: 'text' }\n        };\n    }\n    enpackage() {\n        return {\n            type: this.type,\n            id: this.id,\n            gridPos: { x: this.gridPos.x, y: this.gridPos.y },\n\n            name: this.detail.name,\n        };\n    }\n    unpackage(objectSetting) {\n        this.type = objectSetting.type;\n        this.id = objectSetting.id;\n        this.gridPos = new Vec2(objectSetting.gridPos.x, objectSetting.gridPos.y);\n        this.pos = this.gridPos.mul(w).add(constant.mapStart).add(new Vec2(0.5 * w, 0.5 * w));\n\n        this.detail.name = objectSetting.name;\n\n        this.perspective = true;\n    }\n    collision(target) {\n        if (isCollision({ type: 'cube', pos: this.pos, size: new Vec2(0.7 * w, 0.7 * w) }, target)) return 'deathTotem';\n        return 'none';\n    }\n    draw(ctx, layer = -1) {\n        ctx.save();\n        ctx.translate(this.pos.x, this.pos.y);\n        ctx.globalAlpha = (this.perspective) ? 0.8 : 1;\n\n        ctx.beginPath();\n        ctx.moveTo(0, (-0.35) * w);\n        ctx.arcTo(0.35 * w, (-0.35) * w, 0.35 * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo(0.35 * w, 0.35 * w, (-0.35) * w, 0.35 * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, 0.35 * w, (-0.35) * w, (-0.35) * w, 0.1 * w);\n        ctx.arcTo((-0.35) * w, (-0.35) * w, 0.35 * w, (-0.35) * w, 0.1 * w);\n        ctx.lineTo(0, (-0.35) * w);\n        let grd = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.45 * w);\n        grd.addColorStop(0, '#E800E8');\n        grd.addColorStop(1, '#5E005E');\n        ctx.fillStyle = grd;\n        ctx.fill();\n        ctx.strokeStyle = '#460046';\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.globalAlpha = 1;\n        ctx.scale(0.8, 0.8);\n        \n        ctx.beginPath();\n        ctx.arc(0, 0, 0.25 * w, 0.25 * Math.PI, 0.75 * Math.PI, true);\n        ctx.lineTo(-0.1 * w, 0.3 * w);\n        ctx.lineTo(0.1 * w, 0.3 * w);\n        let grd2 = ctx.createRadialGradient(0, 0, 0, 0, 0, 0.2 * w);\n        grd2.addColorStop(0, 'white');\n        grd2.addColorStop(1, '#E0E0E0');\n        ctx.fillStyle = grd2;\n        ctx.fill();\n        ctx.closePath();\n\n        for (let i = 0; i < 3; i++) {\n            ctx.beginPath();\n            ctx.moveTo(-0.08 * w + 0.08 * i * w, 0.31 * w);\n            ctx.lineTo(-0.08 * w + 0.08 * i * w, 0.24 * w);\n            ctx.strokeStyle = grd;\n            ctx.stroke();\n            ctx.closePath();\n        }\n\n        for (let i = 0; i < 2; i++) {\n            ctx.beginPath();\n            ctx.arc(-0.1 * w, -0.01 * w, 0.08 * w, 0.16 * Math.PI, 1.16 * Math.PI);\n            ctx.fillStyle = grd;\n            ctx.fill();\n            ctx.closePath();\n\n            ctx.beginPath();\n            ctx.moveTo(-0.02 * w, 0.1 * w);\n            ctx.lineTo(-0.045 * w, 0.16 * w);\n            ctx.strokeStyle = grd;\n            ctx.stroke();\n            ctx.closePath();\n\n            ctx.scale(-1, 1);\n        }\n\n        ctx.restore();\n    }\n    place(map, objects) {\n        this.gridPos = this.pos.sub(constant.mapStart).toGrid(w);\n        let gridPos = this.gridPos;\n        if (constant.typeLayerPairs[map[gridPos.y][gridPos.x].type].isOverlap(this.layer)) return false;\n        if (map[gridPos.y][gridPos.x].layer.isOverlap(this.layer)) return false;\n        map[gridPos.y][gridPos.x].layer.add(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) {\n                        objects[i].loadObject = {\n                            id: this.id,\n                            object: this,\n                        };\n                    }\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n    remove(map, objects) {\n        let gridPos = this.gridPos;\n        map[gridPos.y][gridPos.x].layer.sub(this.layer);\n        if (map[gridPos.y][gridPos.x].layer.status[1]) {\n            for (let i = 0; i < objects.length; i++) {\n                if (objects[i].gridPos.equal(gridPos) && objects[i].layer.top() === 1) {\n                    if (objects[i].loadable) objects[i].loadObject = null;\n                    break;\n                }\n            }\n        }\n    }\n}","import constant from './constant';\nimport Layer from './Class/Layer';\nimport { spikedBlock, platform, bow, movingPlatform, mucus, cymbal, ice, conveyor, portal, trapPlatform, missileBase, lockedWall, unlocker, block, movingPlatform_oblique, movingPlatform_rect, woodenBox, magnet, brokenPlatform, deathTotem } from './Class/GameObject';\n\nexport function enpackage(setting) {\n    const levelSetting = {\n        map: [],\n        objects: [],\n    };\n    /* 地圖打包 */\n    for (let i = 0; i < constant.mapSize.y; i++) {\n        let types = [];\n        for (let j = 0; j < constant.mapSize.x; j++) {\n            types[j] = { type: setting.map[i][j].type }; \n        }\n        levelSetting.map[i] = types;\n    } \n    /* 物件打包 */\n    let count = 0;\n    for (let i = 0; i < setting.objects.length; i++) {\n        if (setting.objects[i].enpackage) levelSetting.objects[count++] = setting.objects[i].enpackage();\n    }\n    return levelSetting;\n}\n\nexport function unpackage(levelSetting) {\n    const setting = {\n        map: [],\n        objects: [],\n    } \n    /* 地圖拆包 */\n    for (let i = 0; i < constant.mapSize.y; i++) {\n        let types = [];\n        for (let j = 0; j < constant.mapSize.x; j++) {\n            types[j] = { type: levelSetting.map[i][j].type, layer: new Layer() };\n        }\n        setting.map[i] = types;\n    }\n    /* 物件拆包 */\n    for (let i = 0; i < levelSetting.objects.length; i++) {\n        switch (levelSetting.objects[i].type) {\n            case 'spikedBlock':\n                setting.objects[i] = new spikedBlock();\n                break;\n            case 'platform':\n                setting.objects[i] = new platform();\n                break;\n            case 'movingPlatform':\n                setting.objects[i] = new movingPlatform();\n                break;\n            case 'bow':\n                setting.objects[i] = new bow();\n                break;\n            case 'mucus':\n                setting.objects[i] = new mucus();\n                break;\n            case 'cymbal':\n                setting.objects[i] = new cymbal();\n                break;\n            case 'ice':\n                setting.objects[i] = new ice();\n                break;\n            case 'conveyor':\n                setting.objects[i] = new conveyor();\n                break;\n            case 'portal':\n                setting.objects[i] = new portal();\n                break;\n            case 'trapPlatform':\n                setting.objects[i] = new trapPlatform();\n                break;\n            case 'missileBase':\n                setting.objects[i] = new missileBase();\n                break;\n            case 'lockedWall':\n                setting.objects[i] = new lockedWall();\n                break;\n            case 'unlocker':\n                setting.objects[i] = new unlocker();\n                break;\n            case 'block':\n                setting.objects[i] = new block();\n                break;\n            case 'movingPlatform_oblique':\n                setting.objects[i] = new movingPlatform_oblique();\n                break;\n            case 'movingPlatform_rect':\n                setting.objects[i] = new movingPlatform_rect();\n                break;\n            case 'woodenBox':\n                setting.objects[i] = new woodenBox();\n                break\n            case 'magnet':\n                setting.objects[i] = new magnet();\n                break;\n            case 'brokenPlatform':\n                setting.objects[i] = new brokenPlatform();\n                break;\n            case 'deathTotem':\n                setting.objects[i] = new deathTotem();\n                break;\n            default:\n                break;\n        }\n        setting.objects[i].unpackage(levelSetting.objects[i]);\n        setting.objects[i].place(setting.map, setting.objects);\n    }\n    return setting;\n}\n\nexport function show(levelSetting) {\n    const util = require('util');\n\n    console.log(util.inspect(levelSetting, { showHidden: false, depth: null }));\n}","export default function LoadingPage(props) {\n  return (\n    <>\n      <h1>Loading</h1>\n    </>\n  );\n}\n","import Vec2 from './Class/Vec2';\nimport constant from './constant';\n\nexport function clear(ctx, pos = { x: 0, y: 0 }, size = { x: ctx.canvas.width, y: ctx.canvas.height }) {\n\tctx.clearRect(pos.x, pos.y, size.x, size.y);\n}\n\nexport function drawMap(ctx, map, playMode = false) {\n\tconst mapSize = constant.mapSize;\n\tconst w = constant.gridWidth; \n\tconst blockColor = constant.blockColor;\n\tconst startColor = constant.startColor;\n\tconst endColor = constant.endColor;\n\tconst noneColor = constant.noneColor;\n\tconst deadColor = constant.deadColor;\n\tconst iceColor = constant.iceColor;\n\tconst muddyColor = constant.muddyColor;\n\tconst boundaryColor = constant.boundaryColor;\n\tconst auxiliaryColor = constant.auxiliaryColor; \n\tconst relation = (pos1, pos2) => {\n\t\tif (map[pos1.y][pos1.x].type.includes('block') && map[pos2.y][pos2.x].type.includes('block')) return 'b_b';\n\t\tif (map[pos1.y][pos1.x].type.includes('block') || map[pos2.y][pos2.x].type.includes('block')) return 'n_b';\n\t\treturn 'n_n';\n\t};\n\n\tfor (let y = 0; y < mapSize.y; y++) {\n\t\tfor (let x = 0; x < mapSize.x; x++) {\n\t\t\tif (map[y][x].type === 'block') continue;\n\t\t\tctx.save();\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x * w, y * w, w, w);\n\t\t\tctx.fillStyle = (map[y][x].type.includes('start')) ? startColor :\n\t\t\t\t\t\t\t(map[y][x].type.includes('end')) ? endColor :\n\t\t\t\t\t\t\t(map[y][x].type.includes('dead')) ? deadColor :\n\t\t\t\t\t\t\t(map[y][x].type.includes('ice')) ? iceColor :\n\t\t\t\t\t\t\t(map[y][x].type.includes('muddy')) ? muddyColor : noneColor;\n\t\t\tctx.fill();\n\t\t\tctx.closePath();\n\n\t\t\tctx.restore();\n\t\t}\n\t}\n\tif (!playMode) {\n\t\tfor (let y = 1; y < mapSize.y; y++) {\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(0, y * w);\n\t\t\tctx.lineTo(mapSize.x * w, y * w);\n\t\t\tctx.strokeStyle = auxiliaryColor;\n\t\t\tctx.stroke();\n\t\t\tctx.closePath();\n\t\t}\n\t\tfor (let x = 0; x < mapSize.x; x++) {\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(x * w, 0);\n\t\t\tctx.lineTo(x * w, mapSize.y * w);\n\t\t\tctx.strokeStyle = auxiliaryColor;\n\t\t\tctx.stroke();\n\t\t\tctx.closePath();\n\t\t}\n\t}\n\tfor (let y = 0; y <= mapSize.y; y++) {\n\t\tfor (let x = 0; x <= mapSize.x; x++) {\n\t\t\tctx.save();\n\t\t\tif (x >= 0 && x < mapSize.x && y >= 0 && y < mapSize.y) {\n\t\t\t\tif (map[y][x].type === 'block') {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.rect(x * w, y * w, w, w);\n\t\t\t\t\tctx.fillStyle = blockColor;\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t}\n\n\t\t/* 繪製橫向格線 */\n\t\t\tif (x !== mapSize.x) {\n\t\t\t\tif (y > 0 && y < mapSize.y) {\n\t\t\t\t\tlet r = relation(new Vec2(x, y - 1), new Vec2(x, y));\n\t\t\t\t\tif (r === 'n_b') {\n\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tctx.moveTo(x * w, y * w);\n\t\t\t\t\t\tctx.lineTo((x + 1) * w, y * w);\n\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\tctx.closePath();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (y === 0) {\n\t\t\t\t\t\tif (map[y][x].type !== 'block') {\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\n\t\t\t\t\t\t\tctx.lineTo((x + 1) * w, y * w);\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\n\t\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\t\tctx.closePath();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (y === mapSize.y) {\n\t\t\t\t\t\tif (map[y - 1][x].type !== 'block') {\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\n\t\t\t\t\t\t\tctx.lineTo((x + 1) * w, y * w);\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\n\t\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\t\tctx.closePath();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t/* 繪製縱向格線 */\n\t\t\tif (y !== mapSize.y) {\n\t\t\t\tif (x > 0 && x < mapSize.x) {\n\t\t\t\t\tlet r = relation(new Vec2(x - 1, y), new Vec2(x, y));\n\t\t\t\t\tif (r === 'n_b') {\n\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tctx.moveTo(x * w, y * w);\n\t\t\t\t\t\tctx.lineTo(x * w, (y + 1) * w);\n\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\tctx.closePath();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (x === 0) {\n\t\t\t\t\t\tif (map[y][x].type !== 'block') {\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\n\t\t\t\t\t\t\tctx.lineTo(x * w, (y + 1) * w);\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\n\t\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\t\tctx.closePath();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (x === mapSize.x) {\n\t\t\t\t\t\tif (map[y][x - 1].type !== 'block') {\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\t\tctx.moveTo(x * w, y * w);\n\t\t\t\t\t\t\tctx.lineTo(x * w, (y + 1) * w);\n\t\t\t\t\t\t\tctx.strokeStyle = boundaryColor;\n\t\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\t\tctx.closePath();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.restore();\n\n\t\t}\n\t}\n}\n\nexport function drawPlayKey(ctx, size = 1) {\n\tctx.save();\n\tctx.scale(size, size);\n\n\tctx.beginPath();\n\tctx.moveTo(-0.3, 0);\n\tctx.arcTo(-0.3, -0.5, 0.5, 0, 0.1);\n\tctx.arcTo(0.5, 0, -0.3, 0.5, 0.1);\n\tctx.arcTo(-0.3, 0.5, -0.3, 0, 0.1);\n\tctx.lineTo(-0.3, 0);\n\tctx.fillStyle = 'green';\n\tctx.fill();\n\tctx.closePath();\n\n\tctx.restore();\n}\n\nexport function drawStopKey(ctx, size = 1) {\n\tctx.save();\n\tctx.scale(size, size);\n\tctx.fillStyle = 'red';\n\n\tctx.beginPath();\n\tctx.moveTo(-0.35, 0);\n\tctx.arcTo(-0.35, -0.5, -0.15, -0.5, 0.1);\n\tctx.arcTo(-0.15, -0.5, -0.15, 0.5, 0.1);\n\tctx.arcTo(-0.15, 0.5, -0.35, 0.5, 0.1);\n\tctx.arcTo(-0.35, 0.5, -0.35, 0, 0.1);\n\tctx.lineTo(-0.35, 0);\n\tctx.fill();\n\tctx.closePath();\n\n\tctx.beginPath();\n\tctx.moveTo(0.35, 0);\n\tctx.arcTo(0.35, -0.5, 0.15, -0.5, 0.1);\n\tctx.arcTo(0.15, -0.5, 0.15, 0.5, 0.1);\n\tctx.arcTo(0.15, 0.5, 0.35, 0.5, 0.1);\n\tctx.arcTo(0.35, 0.5, 0.35, 0, 0.1);\n\tctx.lineTo(0.35, 0);\n\tctx.fill();\n\tctx.closePath();\n\n\tctx.restore();\n}\n\nexport function drawTrashCan(ctx, size = 1) {\n\tctx.save();\n\tctx.scale(size, size);\n\tctx.lineWidth = 0.06;\n\tctx.strokeStyle = 'gray';\n\n\tfor (let i = 0; i < 3; i++) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(-0.2 + 0.2 * i, 0);\n\t\tctx.lineTo(-0.2 + 0.2 * i, 0.4);\n\t\tctx.stroke();\n\t\tctx.closePath();\n\t}\n\n\tctx.beginPath();\n\tctx.moveTo(-0.4, -0.2);\n\tctx.arcTo(-0.4, 0.6, 0.4, 0.6, 0.1);\n\tctx.arcTo(0.4, 0.6, 0.4, -0.2, 0.1);\n\tctx.lineTo(0.4, -0.2);\n\tctx.stroke();\n\tctx.closePath();\n\n\tctx.beginPath();\n\tctx.moveTo(-0.5, -0.4);\n\tctx.lineTo(0.5, -0.4);\n\tctx.lineTo(0.5, -0.2);\n\tctx.lineTo(-0.5, -0.2);\n\tctx.lineTo(-0.5, -0.4);\n\tctx.stroke();\n\tctx.closePath();\n\n\tctx.beginPath();\n\tctx.moveTo(-0.2, -0.4);\n\tctx.lineTo(-0.2, -0.6);\n\tctx.lineTo(0.2, -0.6);\n\tctx.lineTo(0.2, -0.4);\n\tctx.stroke();\n\tctx.closePath();\n\n\tctx.restore();\n}","import * as api from './Drawer';\nimport constant from './constant';\nimport { useRef, useEffect } from 'react';\n\nconst Preview = (props) => {\n    const canvasRef = useRef();\n    let setting = props.setting;\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext(\"2d\");\n\n        ctx.save();\n        ctx.scale(0.1, 0.1);\n        api.drawMap(ctx, setting.map);\n        ctx.restore();\n\n        ctx.save();\n        ctx.scale(0.1, 0.1);\n        ctx.translate(-constant.mapStart.x, -constant.mapStart.y);\n        for (let i = 0; i < constant.maxLayer; i++) {\n            for (let j = 0; j < setting.objects.length; j++) {\n                if (setting.objects[j].layer.status[i]) setting.objects[j].draw(ctx, i);\n            }\n        }\n        ctx.restore();\n    });\n\n    return (<canvas ref={canvasRef} width={`102.4px`} height={`51.2px`}></canvas>);\n}\n\nexport default Preview;","const example_0 = {\n    map:\n        [[{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'start' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'end' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'none' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }],\n        [{ type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' },\n        { type: 'block' }]],\n    objects: []\n};\n\nexport default example_0;","// from https://github.com/mui-org/material-ui/edit/master/docs/src/pages/getting-started/templates/album/Album.js\nimport React from \"react\";\nimport { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { enpackage, unpackage, show } from \"../GameContainer/DataPackager\";\nimport LoadingPage from \"./LoadingPage\";\nimport instance from \"./Api\";\n\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Button from \"@material-ui/core/Button\";\nimport CameraIcon from \"@material-ui/icons/PhotoCamera\";\nimport SportsEsportsIcon from \"@material-ui/icons/SportsEsports\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport Card from \"@material-ui/core/Card\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Container from \"@material-ui/core/Container\";\nimport Link from \"@material-ui/core/Link\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Switch from \"@material-ui/core/Switch\";\nimport { withStyles, makeStyles } from \"@material-ui/core/styles\";\nimport { green, purple, pink } from \"@material-ui/core/colors\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport Preview from \"../GameContainer/Preview\";\nimport initSetting from \"../GameContainer/Setting/example_0\";\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nconst ColorButton = withStyles((theme) => ({\n  root: {\n    color: theme.palette.getContrastText(pink[100]),\n    backgroundColor: pink[100],\n    \"&:hover\": {\n      backgroundColor: pink[100],\n    },\n  },\n}))(Button);\n\nfunction Copyright() {\n  return (\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\n      {\"Copyright © \"}\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\n        material-ui\n      </Link>{\" \"}\n      {new Date().getFullYear()}\n      {\".\"}\n    </Typography>\n  );\n}\n\nconst useStyles = makeStyles((theme) => ({\n  icon: {\n    marginRight: theme.spacing(2),\n  },\n  heroContent: {\n    backgroundColor: theme.palette.background.paper,\n    padding: theme.spacing(8, 0, 6),\n  },\n  heroButtons: {\n    marginTop: theme.spacing(4),\n  },\n  cardGrid: {\n    paddingTop: theme.spacing(8),\n    paddingBottom: theme.spacing(8),\n  },\n  card: {\n    height: \"100%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  cardMedia: {\n    paddingTop: \"56.25%\", // 16:9\n  },\n  cardContent: {\n    flexGrow: 1,\n  },\n  footer: {\n    backgroundColor: theme.palette.background.paper,\n    padding: theme.spacing(6),\n  },\n}));\n\nexport default function Album(props) {\n  const classes = useStyles();\n  const history = useHistory();\n  const { uuid, name } = props.data;\n  const [mapIDs, setMapIDs] = useState(props.data.mapIDs);\n  // const [mapData, setMapData] = useState({});\n  // for Snackbar Alert\n  const [msgOpen, setMsgOpen] = useState(false);\n  const [alertMsg, setAlertMsg] = useState(\"\");\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\n  const [allMaps, setAllMaps] = useState([]);\n  // delete dialog\n  const [deleteID, setDeleteID] = useState(\"\");\n  const [openDialog, setOpenDialog] = useState(false);\n  // get data before render\n  const [isBusy, setBusy] = useState(true);\n\n  const DeleteSingleMap = async (id) => {\n    const {\n      data: { success, errorCode },\n    } = await instance.post(\"/api/deleteSingleMap\", {\n      id,\n      uuid,\n    });\n    if (!success) {\n      setAlertMsg(`Delete Fail`);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n    } else {\n      setAlertMsg(`Delete success`);\n      setAlertType(\"success\");\n      setMsgOpen(true);\n      getMapIDs();\n    }\n  };\n  const handlerDeleteSingleMap1 = () => {\n    DeleteSingleMap(deleteID);\n    setOpenDialog(false);\n  };\n  const handlerDeleteSingleMap = (id) => {\n    setDeleteID(id);\n    setOpenDialog(true);\n  };\n\n  const getAllMaps = async (mapIDs) => {\n    console.log(`getAllMaps`);\n    const {\n      data: { success, errorCode, maps },\n    } = await instance.post(\"/api/getAllMaps\", {\n      mapIDs,\n    });\n    if (!success) {\n      console.log(`FAIL`);\n    } else {\n      // console.log(maps);\n      setAllMaps(maps);\n    }\n  };\n\n  const getMapIDs = async () => {\n    // console.log(\"TT\");\n    const {\n      data: { success, mapIDs },\n    } = await instance.post(\"/api/getUserData\", {\n      uuid,\n    });\n    if (!success) {\n      console.log(`getMapids fail`);\n    } else {\n      console.log(mapIDs);\n      setMapIDs(mapIDs);\n      getAllMaps(mapIDs);\n    }\n    setBusy(false);\n  };\n\n  const handlerStatistic = (key) => {\n    if (allMaps[key] === undefined) {\n      return `...`;\n    } else {\n      const { fastestPass, fastestMan, passTime, playTime } =\n        allMaps[key].statistic;\n\n      return `fastestPass:${fastestPass}, fastestMan:${fastestMan}, passTime:${passTime}, playTime:${playTime}`;\n    }\n  };\n\n  useEffect(() => {\n    console.log(`busy?${isBusy}`);\n    setBusy(true);\n    getMapIDs();\n  }, []);\n\n  // console.log(\"render\")\n  return (\n    <React.Fragment>\n      <CssBaseline />\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <SportsEsportsIcon className={classes.icon} />\n          <Typography variant=\"h6\" color=\"inherit\" noWrap>\n            Play Ground\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <main>\n        <Snackbar\n          open={msgOpen}\n          autoHideDuration={3000}\n          onClose={() => {\n            setMsgOpen(false);\n          }}\n        >\n          <Alert\n            onClose={() => {\n              setMsgOpen(false);\n            }}\n            severity={alertType}\n          >\n            {alertMsg}\n          </Alert>\n        </Snackbar>\n        <div className={classes.heroContent}>\n          <Container maxWidth=\"sm\">\n            <Typography\n              component=\"h1\"\n              variant=\"h2\"\n              align=\"center\"\n              color=\"textPrimary\"\n              gutterBottom\n            >\n              Hi {name}\n            </Typography>\n            <Typography\n              variant=\"h5\"\n              align=\"center\"\n              color=\"textSecondary\"\n              paragraph\n            >\n              你可以在這邊設計、查看你所擁有的關卡！！\n            </Typography>\n            <div className={classes.heroButtons}>\n              <Grid container spacing={2} justify=\"center\">\n                <Grid item>\n                  <Button\n                    variant=\"contained\"\n                    color=\"secondary\"\n                    onClick={() => {\n                      history.push(`/`);\n                    }}\n                  >\n                    登出\n                  </Button>\n                </Grid>\n                <Grid item>\n                  <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    onClick={() => {\n                      history.push({\n                        pathname: `/PopularMap`,\n                        state: { uuid: uuid, name: name, login: true },\n                      });\n                    }}\n                  >\n                    查看熱門排行地圖\n                  </Button>\n                </Grid>\n                <Grid item>\n                  <Button\n                    color=\"secondary\"\n                    variant=\"outlined\"\n                    onClick={() => {\n                      history.push({\n                        pathname: `/EditMode`,\n                        state: {\n                          uuid: uuid,\n                          name: name,\n                          login: true,\n                          id: 0,\n                          title: \"\",\n                          description: \"\",\n                        },\n                      });\n                    }}\n                  >\n                    新地圖\n                  </Button>\n                </Grid>\n                <Grid item>\n                  <Button\n                    color=\"primary\"\n                    variant=\"outlined\"\n                    onClick={getMapIDs}\n                  >\n                    重新整理\n                  </Button>\n                </Grid>\n              </Grid>\n            </div>\n          </Container>\n        </div>\n        <Dialog\n          open={openDialog}\n          onClose={() => {\n            setOpenDialog(false);\n          }}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n        >\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              刪除地圖？（無法復原）\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={() => {\n                setOpenDialog(false);\n              }}\n              color=\"primary\"\n            >\n              取消\n            </Button>\n            <Button onClick={handlerDeleteSingleMap1} color=\"primary\" autoFocus>\n              確認\n            </Button>\n          </DialogActions>\n        </Dialog>\n        {isBusy ? (\n          <LoadingPage />\n        ) : (\n          <Container className={classes.cardGrid} maxWidth=\"md\">\n            {/* End hero unit */}\n            <Grid container spacing={4}>\n              {mapIDs.map((ele, key) => (\n                <Grid item key={ele} xs={12} sm={6} md={4}>\n                  <Card className={classes.card}>\n                    {/* <CardMedia\n                      className={classes.cardMedia}\n                      image=\"https://source.unsplash.com/random\"\n                      title=\"Image title\"\n                    /> */}\n                    <Preview\n                      setting={unpackage(\n                        allMaps[key] ? allMaps[key].content : initSetting\n                      )}\n                    />\n                    <CardContent className={classes.cardContent}>\n                      <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                        {/* {ele.title} */}\n                        {allMaps[key] ? allMaps[key].title : \"\"}\n                      </Typography>\n                      <Typography>\n                        {allMaps[key] ? allMaps[key].description : \"\"}\n                      </Typography>\n                    </CardContent>\n                    <CardActions>\n                      <Button\n                        size=\"small\"\n                        color=\"primary\"\n                        disabled={allMaps[key] === undefined}\n                        onClick={() => {\n                          history.push({\n                            pathname: `/PlayMode`,\n                            state: {\n                              uuid: uuid,\n                              name: name,\n                              login: true,\n                              id: ele,\n                              mode: \"test\",\n                            },\n                          });\n                        }}\n                      >\n                        Play\n                      </Button>\n                      <Button\n                        size=\"small\"\n                        color=\"primary\"\n                        disabled={\n                          allMaps[key] === undefined ||\n                          (allMaps[key] !== undefined && allMaps[key].publish)\n                        }\n                        onClick={() => {\n                          history.push({\n                            pathname: `/EditMode`,\n                            state: {\n                              uuid: uuid,\n                              name: name,\n                              login: true,\n                              id: ele,\n                              title: allMaps[key] ? allMaps[key].title : \"\",\n                              description: allMaps[key]\n                                ? allMaps[key].description\n                                : \"\",\n                            },\n                          });\n                        }}\n                      >\n                        Edit\n                      </Button>\n                      {allMaps[key] === undefined ? (\n                        <p>???</p>\n                      ) : allMaps[key].publish ? (\n                        <Tooltip title={handlerStatistic(key)}>\n                          <Button size=\"small\" color=\"primary\" variant=\"text\">\n                            Statistic\n                          </Button>\n                        </Tooltip>\n                      ) : (\n                        <>\n                          <ColorButton\n                            size=\"small\"\n                            color=\"primary\"\n                            variant=\"contained\"\n                          >\n                            Private\n                          </ColorButton>\n                        </>\n                      )}\n                      <IconButton\n                        className={classes.margin}\n                        size=\"large\"\n                        variant=\"outlined\"\n                        color=\"secondary\"\n                        onClick={() => {\n                          handlerDeleteSingleMap(ele);\n                        }}\n                      >\n                        <DeleteIcon />\n                      </IconButton>\n                    </CardActions>\n                  </Card>\n                </Grid>\n              ))}\n            </Grid>\n          </Container>\n        )}\n      </main>\n      {/* Footer */}\n      <footer className={classes.footer}>\n        {/* <Typography variant=\"h6\" align=\"center\" gutterBottom>\n          Footer\n        </Typography>\n        <Typography\n          variant=\"subtitle1\"\n          align=\"center\"\n          color=\"textSecondary\"\n          component=\"p\"\n        >\n          Something here to give the footer a purpose!\n        </Typography> */}\n        {/* <Copyright /> */}\n      </footer>\n      {/* End footer */}\n    </React.Fragment>\n  );\n}\n","export default function ErrorPage(props) {\n  return (\n    <>\n      <h1> ERROR QAQ </h1>\n    </>\n  );\n}\n","import UserPage from \"./UserPage\";\nimport ErrorPage from \"./ErrorPage\";\n\nfunction checkLogin(props) {\n  if (props.location.state === undefined) return false;\n  else if (!props.location.state.login) return false;\n  return true;\n}\n\nfunction UserPage0(props) {\n  return (\n    <>\n      {checkLogin(props) ? (\n        <UserPage data={props.location.state} />\n      ) : (\n        <ErrorPage />\n      )}\n    </>\n  );\n}\nexport default UserPage0;\n","import React from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\nimport instance from \"../Api\";\n\nimport Link from \"@material-ui/core/Link\";\nimport { makeStyles, withStyles } from \"@material-ui/core/styles\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport IconButton from \"@material-ui/core/IconButton\";\n// import ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\nimport SportsEsportsIcon from \"@material-ui/icons/SportsEsports\";\nimport GradeIcon from \"@material-ui/icons/Grade\";\nimport Modal from \"@material-ui/core/Modal\";\n// import Title from \"./Title\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nconst ColorButton = withStyles((theme) => ({\n  root: {\n    color: \"#ffc107\",\n    // backgroundColor: theme.palette.getContrastText(\"#ffc107\"),\n    \"&:hover\": {\n      backgroundColor: \"#fff7b0\",\n    },\n  },\n}))(IconButton);\n\nconst useStyles = makeStyles((theme) => ({\n  seeMore: {\n    marginTop: theme.spacing(3),\n  },\n}));\n// const instance = axios.create({\n//   baseURL: `http://localhost:4000/`,\n// });\nexport default function Orders(props) {\n  const history = useHistory();\n  const classes = useStyles();\n  const { name, uuid, login } = props.info;\n  const [open, setOpen] = useState(false);\n  // record rate which map\n  const [rateID, setRateID] = useState(\"\");\n  const [rate, setRate] = useState(3);\n  // for Snackbar Alert\n  const [msgOpen, setMsgOpen] = useState(false);\n  const [alertMsg, setAlertMsg] = useState(\"\");\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\n\n  const rateMap = async (val) => {\n    console.log(`value:${val}`);\n    const {\n      data: { success, errorCode },\n    } = await instance.post(\"/api/rateMap\", {\n      rateID,\n      val,\n      name,\n    });\n    if (!success) {\n      if (errorCode === 1) {\n        setAlertMsg(`You need to pass this map to rate it`);\n        setAlertType(\"error\");\n        setMsgOpen(true);\n      } else if (errorCode === 2) {\n        setAlertMsg(`You rated it before, the previous rate has been updated!`);\n        setAlertType(\"info\");\n        setMsgOpen(true);\n      } else {\n        setAlertMsg(`Unknow error: ${errorCode}`);\n        setAlertType(\"error\");\n        setMsgOpen(true);\n      }\n    } else {\n      setAlertMsg(`Rate Success`);\n      setAlertType(\"success\");\n      setMsgOpen(true);\n    }\n  };\n  // console.log(props.data);\n  const computeScore = (arr) => {\n    let totalScore = 0;\n    let totalPeople = 0;\n    arr.forEach((ele) => {\n      totalScore += ele.rate;\n      // console.log(ele);\n      totalPeople += 1;\n    });\n    return [\n      totalScore,\n      totalPeople,\n      totalPeople === 0 ? 0 : totalScore / totalPeople,\n    ];\n  };\n\n  return (\n    <React.Fragment>\n      <Snackbar\n        open={msgOpen}\n        autoHideDuration={3000}\n        onClose={() => {\n          setMsgOpen(false);\n        }}\n      >\n        <Alert\n          onClose={() => {\n            setMsgOpen(false);\n          }}\n          severity={alertType}\n        >\n          {alertMsg}\n        </Alert>\n      </Snackbar>\n      <Modal\n        open={open}\n        onClose={() => {\n          setOpen(false);\n        }}\n      >\n        <div\n          style={{\n            backgroundColor: \"white\",\n            position: \"absolute\",\n            margin: \"0\",\n            top: \"50%\",\n            left: \"30%\",\n            width: \"40%\",\n            height: \"50%\",\n            // display: \"flex\",\n            transform: \"translateY(-50%)\",\n            // opacity: \"0.8\",\n            // msTransform: \"translateX(-50%)\",\n          }}\n        >\n          <div\n            style={{\n              marginTop: \"1cm\",\n              top: \"30%\",\n              left: \"50%\",\n              position: \"absolute\",\n              transform: \"translate(-50%,-50%)\",\n              msTransform: \"translate(-50%,-50%)\",\n            }}\n          >\n            <Typography component=\"legend\">Rate</Typography>\n            <Rating\n              name=\"simple-controlled\"\n              value={rate}\n              onChange={(event, newValue) => {\n                rateMap(newValue);\n                setOpen(false);\n              }}\n            />\n          </div>\n        </div>\n      </Modal>\n      {/* <Title>Recent Orders</Title> */}\n      <Table size=\"small\">\n        <TableHead>\n          <TableRow>\n            <TableCell></TableCell>\n            <TableCell>Author</TableCell>\n            <TableCell>Title</TableCell>\n            <TableCell>Description</TableCell>\n            <TableCell>Number of Plays</TableCell>\n            <TableCell>Number of Passes</TableCell>\n            <TableCell>Fastest</TableCell>\n            <TableCell align=\"right\">Record holder</TableCell>\n            <TableCell></TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {props.data.map((map) => (\n            <TableRow>\n              <IconButton\n                className={classes.margin}\n                size=\"large\"\n                variant=\"outlined\"\n                color=\"secondary\"\n                onClick={() => {\n                  history.push({\n                    pathname: `/PlayMode`,\n                    state: {\n                      uuid: uuid,\n                      name: name,\n                      login: true,\n                      id: map.id,\n                      mode: \"challenge\",\n                    },\n                  });\n                }}\n              >\n                <SportsEsportsIcon />\n              </IconButton>\n              <TableCell>{map.author}</TableCell>\n              <TableCell>{map.title}</TableCell>\n              <TableCell>{map.description}</TableCell>\n              <TableCell>{map.statistic.playTime}</TableCell>\n              <TableCell>{map.statistic.passTime}</TableCell>\n              <TableCell>\n                {map.statistic.fastestPass === 999.9\n                  ? \"-\"\n                  : map.statistic.fastestPass}\n              </TableCell>\n              <TableCell align=\"right\">\n                {map.statistic.fastestMan === \"None\"\n                  ? \"-\"\n                  : map.statistic.fastestMan}\n              </TableCell>\n\n              {`${computeScore(map.rateRec)[2].toFixed(2)}(${\n                computeScore(map.rateRec)[1]\n              })`}\n              <ColorButton\n                className={classes.margin}\n                size=\"large\"\n                variant=\"outlined\"\n                color=\"primary\"\n                onClick={() => {\n                  setRateID(map.id);\n                  setOpen(true);\n                }}\n              >\n                <GradeIcon />\n              </ColorButton>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n      {/* <div className={classes.seeMore}>\n        <Link color=\"primary\" href=\"#\" onClick={preventDefault}>\n          See more orders\n        </Link>\n      </div> */}\n    </React.Fragment>\n  );\n}\n","import ErrorPage from \"./ErrorPage\";\nimport {url} from \"./url\";\n\nimport React from \"react\";\nimport { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport clsx from \"clsx\";\nimport instance from \"./Api\";\n\nimport { withStyles, makeStyles } from \"@material-ui/core/styles\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport Box from \"@material-ui/core/Box\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport List from \"@material-ui/core/List\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Divider from \"@material-ui/core/Divider\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Link from \"@material-ui/core/Link\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport DashboardIcon from \"@material-ui/icons/Dashboard\";\nimport WhatshotIcon from \"@material-ui/icons/Whatshot\";\nimport InsertEmoticonIcon from \"@material-ui/icons/InsertEmoticon\";\nimport FiberNewIcon from \"@material-ui/icons/FiberNew\";\nimport AccessibleForwardIcon from \"@material-ui/icons/AccessibleForward\";\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\nimport TextField from \"@material-ui/core/TextField\";\nimport GradeIcon from \"@material-ui/icons/Grade\";\n\nimport Orders from \"./PageComponent/Orders\";\n\nconst CssTextField = withStyles({\n  root: {\n    \"& label.Mui-focused\": {\n      color: \"black\",\n    },\n    \"& .MuiInput-underline:after\": {\n      borderBottomColor: \"green\",\n    },\n    \"& .MuiOutlinedInput-root\": {\n      \"& fieldset\": {\n        borderColor: \"red\",\n        backgroundColor: \"RoyalBlue\",\n      },\n      \"&:hover fieldset\": {\n        borderColor: \"yellow\",\n      },\n      \"&.Mui-focused fieldset\": {\n        borderColor: \"green\",\n        backgroundColor: \"white\",\n        opacity: \"0.1\",\n      },\n    },\n  },\n})(TextField);\n\nfunction Copyright() {\n  return (\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\n      {\"Copyright © \"}\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\n        Your Website\n      </Link>{\" \"}\n      {new Date().getFullYear()}\n      {\".\"}\n    </Typography>\n  );\n}\n\nconst drawerWidth = 240;\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n  },\n  toolbar: {\n    paddingRight: 24, // keep right padding when drawer closed\n  },\n  toolbarIcon: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"flex-end\",\n    padding: \"0 8px\",\n    ...theme.mixins.toolbar,\n  },\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n    transition: theme.transitions.create([\"width\", \"margin\"], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n  },\n  appBarShift: {\n    marginLeft: drawerWidth,\n    width: `calc(100% - ${drawerWidth}px)`,\n    transition: theme.transitions.create([\"width\", \"margin\"], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  menuButton: {\n    marginRight: 36,\n  },\n  menuButtonHidden: {\n    display: \"none\",\n  },\n  title: {\n    flexGrow: 1,\n  },\n  drawerPaper: {\n    position: \"relative\",\n    whiteSpace: \"nowrap\",\n    width: drawerWidth,\n    transition: theme.transitions.create(\"width\", {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  drawerPaperClose: {\n    overflowX: \"hidden\",\n    transition: theme.transitions.create(\"width\", {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n    width: theme.spacing(7),\n    [theme.breakpoints.up(\"sm\")]: {\n      width: theme.spacing(9),\n    },\n  },\n  appBarSpacer: theme.mixins.toolbar,\n  content: {\n    flexGrow: 1,\n    height: \"100vh\",\n    overflow: \"auto\",\n  },\n  container: {\n    paddingTop: theme.spacing(4),\n    paddingBottom: theme.spacing(4),\n  },\n  paper: {\n    padding: theme.spacing(2),\n    display: \"flex\",\n    overflow: \"auto\",\n    flexDirection: \"column\",\n  },\n  fixedHeight: {\n    height: 240,\n  },\n}));\n\nfunction PopularMap(props) {\n  const history = useHistory();\n  const classes = useStyles();\n  const { name, uuid, login } = props.data;\n  const [open, setOpen] = useState(true);\n  const [newestMaps, setNewestMaps] = useState([]);\n  const [allMaps, setAllMaps] = useState([]);\n  const [isBusy, setBusy] = useState(true);\n  const [search, setSearch] = useState(\"\");\n\n  useEffect(() => {\n    setBusy(true);\n    const getAllMapsByOrder = async () => {\n      const {\n        data: { success, maps, errorCode },\n      } = await instance.post(\"/api/getAllMapsByOrder\", {});\n      if (!success) {\n        // alert(`Wrong password or the user doesn't exist.`);\n      } else {\n        console.log(`setAllMaps`);\n        setAllMaps(maps);\n        setNewestMaps(maps);\n      }\n      setBusy(false);\n    };\n    getAllMapsByOrder();\n  }, []);\n\n  // ref:https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\n  function shuffle(array) {\n    var currentIndex = array.length,\n      randomIndex;\n\n    // While there remain elements to shuffle...\n    while (0 !== currentIndex) {\n      // Pick a remaining element...\n      randomIndex = Math.floor(Math.random() * currentIndex);\n      currentIndex--;\n\n      // And swap it with the current element.\n      [array[currentIndex], array[randomIndex]] = [\n        array[randomIndex],\n        array[currentIndex],\n      ];\n    }\n\n    return array;\n  }\n  const handler1 = () => {\n    console.log(`Handler1`);\n    // random the order of allMaps\n    let arr = [...newestMaps];\n    shuffle(arr);\n    setAllMaps(arr);\n  };\n  const handler2 = () => {\n    console.log(`Handler2`);\n    let arr = [...newestMaps];\n    arr.sort((a, b) => {\n      return b.statistic.playTime - a.statistic.playTime;\n    });\n    setAllMaps(arr);\n  };\n  const handler3 = () => {\n    console.log(`Handler3`);\n    let arr = [...newestMaps];\n    arr.sort((a, b) => {\n      return b.statistic.passTime - a.statistic.passTime;\n    });\n    setAllMaps(arr);\n  };\n  const handler4 = () => {\n    console.log(`Handler4`);\n    setAllMaps(newestMaps);\n  };\n  const handler5 = () => {\n    console.log(`Handler5`);\n    let arr = [...newestMaps];\n    arr = arr.reverse();\n    setAllMaps(arr);\n  };\n  const computeScore = (arr) => {\n    let totalScore = 0;\n    let totalPeople = 0;\n    arr.forEach((ele) => {\n      totalScore += ele.rate;\n      totalPeople += 1;\n    });\n    return [\n      totalScore,\n      totalPeople,\n      totalPeople === 0 ? 0 : totalScore / totalPeople,\n    ];\n  };\n  const handlerGrade = () => {\n    console.log(`Handler3`);\n    let arr = [...newestMaps];\n    arr.sort((a, b) => {\n      return (\n        computeScore(b.rateRec)[2].toFixed(2) -\n        computeScore(a.rateRec)[2].toFixed(2)\n      );\n    });\n    setAllMaps(arr);\n  };\n  const handlerSearch = (w) => {\n    console.log(`HandlerSearch`);\n    let arr = [...newestMaps];\n    arr = arr.filter((ele) => {\n      return ele.author.toLowerCase().includes(w.toLowerCase());\n    });\n    setAllMaps(arr);\n  };\n\n  // const fixedHeightPaper = clsx(classes.paper, classes.fixedHeight);\n  // console.log(\"Render\");\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar\n        position=\"absolute\"\n        className={clsx(classes.appBar, open && classes.appBarShift)}\n      >\n        <Toolbar className={classes.toolbar}>\n          <IconButton\n            edge=\"start\"\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={() => {\n              setOpen(true);\n            }}\n            className={clsx(\n              classes.menuButton,\n              open && classes.menuButtonHidden\n            )}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography\n            component=\"h1\"\n            variant=\"h6\"\n            color=\"inherit\"\n            noWrap\n            className={classes.title}\n          >\n            Other Maps\n          </Typography>\n          <CssTextField\n            className={classes.margin}\n            label=\"Search Author\"\n            variant=\"outlined\"\n            id=\"custom-css-outlined-input\"\n            value={search}\n            onChange={(e) => {\n              setSearch(e.target.value.trim());\n              handlerSearch(e.target.value.trim());\n            }}\n          />\n        </Toolbar>\n      </AppBar>\n      <Drawer\n        variant=\"permanent\"\n        classes={{\n          paper: clsx(classes.drawerPaper, !open && classes.drawerPaperClose),\n        }}\n        open={open}\n      >\n        <div className={classes.toolbarIcon}>\n          <IconButton\n            onClick={() => {\n              setOpen(false);\n            }}\n          >\n            <ChevronLeftIcon />\n          </IconButton>\n        </div>\n        <Divider />\n        <List>\n          <div>\n            <ListItem button onClick={handler1}>\n              <ListItemIcon>\n                <DashboardIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"All Maps\" />\n            </ListItem>\n            <ListItem button onClick={handlerGrade}>\n              <ListItemIcon>\n                <GradeIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"High Rate Maps\" />\n            </ListItem>\n            <ListItem button onClick={handler2}>\n              <ListItemIcon>\n                <WhatshotIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"Most Plays\" />\n            </ListItem>\n            <ListItem button onClick={handler3}>\n              <ListItemIcon>\n                <InsertEmoticonIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"Most Passes\" />\n            </ListItem>\n            <ListItem button onClick={handler4}>\n              <ListItemIcon>\n                <FiberNewIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"Newest\" />\n            </ListItem>\n            <ListItem button onClick={handler5}>\n              <ListItemIcon>\n                <AccessibleForwardIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"Oldest\" />\n            </ListItem>\n            <ListItem button onClick={history.goBack}>\n              <ListItemIcon>\n                <ArrowBackRoundedIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"Go Back\" />\n            </ListItem>\n          </div>\n        </List>\n      </Drawer>\n      <main className={classes.content}>\n        <div className={classes.appBarSpacer} />\n        <Container maxWidth=\"lg\" className={classes.container}>\n          <Grid container spacing={3}>\n            {/* Recent Orders */}\n            <Grid item xs={12}>\n              <Paper className={classes.paper}>\n                <Orders data={allMaps} info={props.data} />\n              </Paper>\n            </Grid>\n          </Grid>\n          <Box pt={4}>{/* <Copyright /> */}</Box>\n        </Container>\n      </main>\n    </div>\n  );\n}\nfunction checkLogin(props) {\n  if (props.location.state === undefined) return false;\n  else if (!props.location.state.login) return false;\n  return true;\n}\n\nfunction index(props) {\n  return (\n    <>\n      {checkLogin(props) ? (\n        <PopularMap data={props.location.state} />\n      ) : (\n        <ErrorPage />\n      )}\n    </>\n  );\n}\nexport default index;\n","import * as api from '../Drawer';\nimport Vec2 from '../Class/Vec2';\nimport constant from '../constant';\nimport * as GameObject from '../Class/GameObject';\n\nfunction Drawer(ctx, setting, status) {\n\tlet map = setting.map;\n\tlet objects = setting.objects;\n\tconst w = constant.gridWidth;\n\n\n\t/* 清空畫布 */\n\tapi.clear(ctx);\n\n\tctx.save();\n\tctx.rect(constant.mapStart.x, constant.mapStart.y, constant.mapSize.x * w, constant.mapSize.y * w);\n\tctx.clip();\n\n\t/* 繪製地圖 */\n\tctx.save();\n\tctx.translate(constant.mapStart.x, constant.mapStart.y);\n\tapi.drawMap(ctx, map);\n\n\t/* 繪製選擇格 */\n\tif (status.select) {\n\t\tlet luPos = Vec2.leftUp(status.selectPair[0], status.selectPair[1]);\n\t\tlet rdPos = Vec2.rightDown(status.selectPair[0], status.selectPair[1]);\n\t\tlet range = rdPos.sub(luPos).add(new Vec2(1, 1));\n\n\t\tctx.save();\n\t\tctx.beginPath();\n\t\tctx.rect(luPos.x * w, luPos.y * w, range.x * w, range.y * w);\n\t\tctx.setLineDash([0.5, 0, 5]);\n\t\tctx.strokeStyle = 'black';\n\t\tctx.stroke();\n\t\tctx.closePath();\n\t\tctx.restore();\n\t}\n\n\tctx.restore();\n\n\t/* 繪製物件 */\n\tfor (let i = 0; i < constant.maxLayer; i++) {\n\t\tfor (let j = 0; j < objects.length; j++) {\n\t\t\tif (objects[j].layer.status[i]) objects[j].draw(ctx, i);\n\t\t}\n\t}\n\n\tctx.restore();\n\n\t/* 繪製編輯物件庫 */\n\tctx.save();\n\tconst editObjectSpace = new Vec2(64, 64);\n\tconst objectList = [];\n\tobjectList.push('class platform');\n\tif (status.opt === 1) objectList.push(...constant.editObjectList.platform);\n\tobjectList.push('class covering');\n\tif (status.opt === 2) objectList.push(...constant.editObjectList.covering);\n\tobjectList.push('class obstacle');\n\tif (status.opt === 3) objectList.push(...constant.editObjectList.obstacle);\n\tobjectList.push('class special');\n\tif (status.opt === 4) objectList.push(...constant.editObjectList.special);\n\tctx.translate(88, 516);\n\n\tfor (let i = 0; i < 16; i++) {\n\t\tlet o = null, type = 'default', fColor, sColor;\n\t\tif (objectList[i - 1]) {\n\t\t\tswitch (objectList[i - 1]) {\n\t\t\t\tcase 'class platform':\n\t\t\t\t\ttype = 'class';\n\t\t\t\t\tif (status.opt === 1) {\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['platform'].fColor);\n\t\t\t\t\t\tgrd.addColorStop(1, '#B9B9FF');\n\t\t\t\t\t\tfColor = grd;\n\t\t\t\t\t} else fColor = '#B9B9FF';\n\t\t\t\t\tsColor = '#9393FF';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'class covering':\n\t\t\t\t\ttype = 'class';\n\t\t\t\t\tif (status.opt === 2) {\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['covering'].fColor);\n\t\t\t\t\t\tgrd.addColorStop(1, '#96FED1');\n\t\t\t\t\t\tfColor = grd;\n\t\t\t\t\t} else fColor = '#96FED1';\n\t\t\t\t\tsColor = '#1AFD9C';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'class obstacle':\n\t\t\t\t\ttype = 'class';\n\t\t\t\t\tif (status.opt === 3) {\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['obstacle'].fColor);\n\t\t\t\t\t\tgrd.addColorStop(1, '#FF9797');\n\t\t\t\t\t\tfColor = grd;\n\t\t\t\t\t} else fColor = '#FF9797';\n\t\t\t\t\tsColor = '#FF5151';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'class special':\n\t\t\t\t\ttype = 'class';\n\t\t\t\t\tif (status.opt === 4) {\n\t\t\t\t\t\tlet pos = new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5);\n\t\t\t\t\t\tlet grd = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 1.5 * w);\n\t\t\t\t\t\tgrd.addColorStop(0, constant.editFrame['special'].fColor);\n\t\t\t\t\t\tgrd.addColorStop(1, '#FFE66F');\n\t\t\t\t\t\tfColor = grd;\n\t\t\t\t\t} else fColor = '#FFE66F';\n\t\t\t\t\tsColor = '#FFDC35';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'spikedBlock':\n\t\t\t\t\to = new GameObject.spikedBlock(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'obstacle';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'platform':\n\t\t\t\t\to = new GameObject.platform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'platform';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bow':\n\t\t\t\t\to = new GameObject.bow(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 3));\n\t\t\t\t\ttype = 'obstacle';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'movingPlatform':\n\t\t\t\t\to = new GameObject.movingPlatform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 10));\n\t\t\t\t\ttype = 'platform';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'mucus':\n\t\t\t\t\to = new GameObject.mucus(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'covering';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'cymbal':\n\t\t\t\t\to = new GameObject.cymbal(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'obstacle';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ice':\n\t\t\t\t\to = new GameObject.ice(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'covering';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'conveyor':\n\t\t\t\t\to = new GameObject.conveyor(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'covering';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'portal':\n\t\t\t\t\to = new GameObject.portal(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'special';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'trapPlatform':\n\t\t\t\t\to = new GameObject.trapPlatform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'platform';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'missileBase':\n\t\t\t\t\to = new GameObject.missileBase(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'obstacle';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'lockedWall':\n\t\t\t\t\to = new GameObject.lockedWall(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'special';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'unlocker':\n\t\t\t\t\to = new GameObject.unlocker(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'special';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'block':\n\t\t\t\t\to = new GameObject.block(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'obstacle';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'movingPlatform_oblique':\n\t\t\t\t\to = new GameObject.movingPlatform_oblique(new Vec2(editObjectSpace.x * (i + 0.5) - 10, editObjectSpace.y * 0.5 + 10));\n\t\t\t\t\ttype = 'platform';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'movingPlatform_rect':\n\t\t\t\t\to = new GameObject.movingPlatform_rect(new Vec2(editObjectSpace.x * (i + 0.5) - 10, editObjectSpace.y * 0.5 + 10));\n\t\t\t\t\ttype = 'platform';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'woodenBox':\n\t\t\t\t\to = new GameObject.woodenBox(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'obstacle';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'magnet':\n\t\t\t\t\to = new GameObject.magnet(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'special';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'brokenPlatform':\n\t\t\t\t\to = new GameObject.brokenPlatform(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'platform';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'deathTotem':\n\t\t\t\t\to = new GameObject.deathTotem(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5));\n\t\t\t\t\ttype = 'covering';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tctx.beginPath();\n\t\tctx.rect(0 + editObjectSpace.x * i + 3, 3, editObjectSpace.x - 6, editObjectSpace.y - 6);\n\t\tctx.fillStyle = (type === 'class') ? fColor : constant.editFrame[type].fColor;\n\t\tctx.fill();\n\t\tctx.lineWidth = 2;\n\t\tctx.strokeStyle = (type === 'class') ? sColor : constant.editFrame[type].sColor;\n\t\tctx.stroke();\n\t\tctx.lineWidth = 1;\n\t\tctx.closePath();\n\n\t\tif (i === 0) {\n\t\t\tctx.save();\n\t\t\tctx.translate(editObjectSpace.x * 0.5, editObjectSpace.y * 0.5);\n\t\t\tif (status.active) api.drawStopKey(ctx, w);\n\t\t\telse api.drawPlayKey(ctx, w);\n\t\t\tctx.restore();\n\t\t} else if (i === 15) {\n\t\t\tctx.save();\n\t\t\tctx.translate(editObjectSpace.x * 15.5, editObjectSpace.y * 0.5);\n\t\t\tapi.drawTrashCan(ctx, w);\n\t\t\tctx.restore();\n        }\n\t\tif (o) o.draw(ctx);\n\t\tif (objectList[i - 1] === 'class platform') {\n\t\t\tlet o1 = new GameObject.trapPlatform(new Vec2(editObjectSpace.x * (i + 0.5) - 8, editObjectSpace.y * 0.5 - 8));\n\t\t\to1.draw(ctx);\n\t\t\tlet o2 = new GameObject.platform(new Vec2(editObjectSpace.x * (i + 0.5) + 8, editObjectSpace.y * 0.5 - 0));\n\t\t\to2.draw(ctx);\n\t\t\tctx.textAlign = \"center\";\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tctx.font = \"15px italic\";\n\t\t\tctx.strokeStyle = 'white';\n\t\t\tctx.lineWidth = 2;\n\t\t\tctx.strokeText(\"平台類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t\tctx.fillStyle = 'black';\n\t\t\tctx.fillText(\"平台類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t} else if (objectList[i - 1] === 'class covering') {\n\t\t\tlet o1 = new GameObject.mucus(new Vec2(editObjectSpace.x * (i + 0.5) - 10, editObjectSpace.y * 0.5 - 10));\n\t\t\to1.draw(ctx);\n\t\t\tlet o2 = new GameObject.conveyor(new Vec2(editObjectSpace.x * (i + 0.5) + 10, editObjectSpace.y * 0.5 - 5));\n\t\t\to2.draw(ctx);\n\t\t\tlet o3 = new GameObject.ice(new Vec2(editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 3));\n\t\t\to3.draw(ctx);\n\t\t\tctx.textAlign = \"center\";\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tctx.font = \"15px italic\";\n\t\t\tctx.strokeStyle = 'white';\n\t\t\tctx.lineWidth = 2;\n\t\t\tctx.strokeText(\"覆蓋類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t\tctx.fillStyle = 'black';\n\t\t\tctx.fillText(\"覆蓋類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t} else if (objectList[i - 1] === 'class obstacle') {\n\t\t\tlet o1 = new GameObject.spikedBlock(new Vec2(editObjectSpace.x * (i + 0.5) - 3, editObjectSpace.y * 0.5 - 6));\n\t\t\tctx.save();\n\t\t\tctx.translate(o1.pos.x, o1.pos.y);\n\t\t\tctx.scale(0.7, 0.7);\n\t\t\tctx.translate(-o1.pos.x, -o1.pos.y);\n\t\t\to1.draw(ctx);\n\t\t\tctx.restore();\n\t\t\tlet o2 = new GameObject.bow(new Vec2(editObjectSpace.x * (i + 0.5) - 3, editObjectSpace.y * 0.5 + 12));\n\t\t\tctx.save();\n\t\t\tctx.translate(o1.pos.x, o1.pos.y);\n\t\t\tctx.rotate(- 0.36 * Math.PI);\n\t\t\tctx.translate(-o1.pos.x, -o1.pos.y);\n\t\t\to2.draw(ctx);\n\t\t\tctx.restore();\n\t\t\tctx.textAlign = \"center\";\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tctx.font = \"15px italic\";\n\t\t\tctx.strokeStyle = 'white';\n\t\t\tctx.lineWidth = 2;\n\t\t\tctx.strokeText(\"障礙類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t\tctx.fillStyle = 'black';\n\t\t\tctx.fillText(\"障礙類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t} else if (objectList[i - 1] === 'class special') {\n\t\t\tlet o1 = new GameObject.portal(new Vec2(editObjectSpace.x * (i + 0.5) - 2, editObjectSpace.y * 0.5 - 7));\n\t\t\to1.index = 1;\n\t\t\to1.open = true;\n\t\t\to1.draw(ctx);\n\t\t\tlet o2 = new GameObject.unlocker(new Vec2(editObjectSpace.x * (i + 0.5) + 10, editObjectSpace.y * 0.5));\n\t\t\to2.draw(ctx);\n\t\t\tctx.textAlign = \"center\";\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tctx.font = '15px  sans-serif';\n\t\t\tctx.strokeStyle = 'white';\n\t\t\tctx.strokeText(\"特殊類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t\tctx.fillStyle = 'black';\n\t\t\tctx.fillText(\"特殊類\", editObjectSpace.x * (i + 0.5), editObjectSpace.y * 0.5 + 20);\n\t\t}\n    }\n\tctx.restore();\n\n\t/* 繪製手中的物件 */\n\tif (status.clear) {\n\t\tctx.save();\n\t\tctx.translate(status.holdObject.pos.x, status.holdObject.pos.y);\n\t\tapi.drawTrashCan(ctx, 0.5 * w);\n\t\tctx.restore();\n\t} else {\n\t\tif (status.holding || status.hold) {\n\t\t\tstatus.holdObject.draw(ctx);\n\t\t}\n    }\n\n\n\t/* 繪製訊息 */\n\tif (status.message.text !== '') {\n\t\tctx.save();\n\n\t\tlet messageCycle = ((Date.now() - status.message.lastPost) / 3000);\n\t\tmessageCycle = (messageCycle < 0.05) ? messageCycle / 0.05 :\n\t\t\t\t\t   (messageCycle > 0.9) ? Math.max((1 - messageCycle), 0) / 0.1: 1 ;\n\t\tctx.globalAlpha = messageCycle;\n\n\t\tctx.translate(constant.mapStart.x, constant.mapStart.y);\n\t\tctx.globalAlpha *= 0.2;\n\n\t\tctx.beginPath();\n\t\tctx.rect(constant.mapSize.x * w * 0.3, 0, constant.mapSize.x * w * 0.4, w);\n\t\tctx.fillStyle = 'white';\n\t\tctx.fill();\n\t\tctx.closePath();\n\n\t\tctx.globalAlpha *= 5;\n\t\tctx.textAlign = \"center\";\n\t\tctx.textBaseline = 'middle';\n\t\tctx.font = \"15px italic\";\n\t\tctx.lineWidth = 2;\n\t\tctx.fillStyle = (status.message.color) ? status.message.color: 'red';\n\t\tctx.fillText(status.message.text, constant.mapSize.x * w * 0.5, 0.5 * w);\n\n\t\tctx.restore();\n    }\n}\n\nexport default Drawer;","import React, {\n    useState,\n    useEffect,\n    useRef,\n    useImperativeHandle,\n    forwardRef,\n} from \"react\";\nimport Drawer from \"./Drawer\";\nimport Engine from \"./Engine\";\nimport Controller from \"./Controller\";\nimport Vec2 from \"../Class/Vec2\";\nimport constant from \"../constant\";\nimport Button from \"@material-ui/core/Button\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport Modal from \"@material-ui/core/Modal\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Box from \"@material-ui/core/Box\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Select from \"@material-ui/core/Select\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport { unpackage, enpackage } from \"../DataPackager\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Slider from \"@material-ui/core/Slider\";\n\nconst EtC = {\n    name: '名稱',\n    platform: '平台',\n    movingPlatform: '移動平台(直行)',\n    movingPlatform_oblique: '移動平台(斜向)',\n    movingPlatform_rect: '移動平台(矩形)',\n    trapPlatform: '陷阱平台',\n    mucus: '黏液',\n    ice: '冰層',\n    conveyor: '傳輸帶',\n    block: '方塊',\n    spikedBlock: '尖刺方塊',\n    bow: '弓箭座',\n    cymbal: '音鈸',\n    missileBase: '追蹤導彈發射台',\n    portal: '傳送門',\n    lockedWall: '上鎖的牆',\n    unlocker: '鑰匙',\n    woodenBox: '木箱',\n    magnet: '磁鐵',\n    brokenPlatform: '破碎平台',\n    deathTotem: '死亡圖騰',\n\n    direction: '方向',\n    up: '上',\n    down: '下',\n    left: '左',\n    right: '右',\n    'left-up': '左上',\n    'left-down': '左下',\n    'right-up': '右上',\n    'right-down': '右下',\n    horizontal: '水平',\n    vertical: '重直',\n    speed: '速度',\n    'super slow': '超級慢',\n    slow: '慢',\n    normal: '普通',\n    fast: '快',\n    'super fast': '超級快',\n    clock: '旋轉方向',\n    clockwise: '順時鐘',\n    counterclockwise: '逆時鐘',\n    duration: '間隔',\n    short: '短',\n    long: '長',\n    RoF: '射速',\n    range: '範圍',\n    large: '大',\n    small: '小',\n    magneticField: '磁場',\n    attraction: '吸引',\n    repulsion: '排斥',\n\n    distance: '距離',\n    width: '寬',\n    height: '高',\n\n    upSpike: '上方有刺',\n    downSpike: '下方有刺',\n    leftSpike: '左方有刺',\n    rightSpike: '右方有刺',\n    rotate: '旋轉',\n}\n\nconst useStyles = makeStyles((theme) => ({\n    formControl: {\n        margin: theme.spacing(1),\n        minWidth: 120,\n    },\n    selectEmpty: {\n        marginTop: theme.spacing(2),\n    },\n}));\nconst EditGameMode = forwardRef((props, ref) => {\n    const canvasRef = useRef();\n    const classes = useStyles();\n    const [value, setValue] = useState(1);\n\n    let setting = props.setting;\n    const [status, setStatus] = useState({\n        select: false,\n        selecting: false,\n        selectPair: [new Vec2(), new Vec2()],\n        hold: false,\n        holding: false,\n        holdObject: null,\n        holdDetail: {},\n        clear: false,\n        active: false,\n        opt: 0,\n        message: { text: '', lastPost: 0 },\n    });\n    const reset = () => {\n        props.save(setting);\n    };\n    useImperativeHandle(ref, () => ({\n        returnSetting() {\n            props.save(setting);\n        },\n    }));\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext(\"2d\");\n\n        let cancelController;\n        cancelController = Controller(canvas, status, setStatus, setting, reset);\n\n        let requestId;\n        const update = () => {\n            /* �C�@��(fps = 60)�i�檺��s */\n            if (status.active) Engine(setting.objects, setting.map);\n            Drawer(ctx, setting, status);\n\n            if (status.message.text !== '' && Date.now() > status.message.lastPost + 3000) {\n                status.message.text = '';\n            }\n\n            requestId = requestAnimationFrame(update);\n        };\n        update();\n\n        return () => {\n            cancelController();\n            cancelAnimationFrame(requestId);\n        };\n    }, [setStatus, status, setting]);\n\n    /* ���ܳQ��ܪ���l�ݩ� */\n    const changeSelectedGridsType = (newType) => {\n        if (!status.select) return;\n        let luPos = Vec2.leftUp(status.selectPair[0], status.selectPair[1]);\n        let rdPos = Vec2.rightDown(status.selectPair[0], status.selectPair[1]);\n        let range = rdPos.sub(luPos).add(new Vec2(1, 1));\n\n        for (let i = 0; i < range.x; i++) {\n            for (let j = 0; j < range.y; j++) {\n                if (setting.map[luPos.y + j][luPos.x + i].layer.isOverlap(constant.typeLayerPairs[newType])) return;\n            }\n        }\n        let oldTypes = [];\n        for (let i = 0; i < range.x; i++) {\n            for (let j = 0; j < range.y; j++) {\n                oldTypes.push(setting.map[luPos.y + j][luPos.x + i].type);\n                setting.map[luPos.y + j][luPos.x + i].type = newType;\n            }\n        }\n        let hasStart = false, hasEnd = false;\n        for (let i = 0; i < constant.mapSize.x; i++) {\n            for (let j = 0; j < constant.mapSize.y && (!hasEnd || !hasStart); j++) {\n                if (setting.map[j][i].type === 'start') hasStart = true;\n                else if (setting.map[j][i].type === 'end') hasEnd = true;\n            }\n        }\n        console.log(hasStart);\n        if (!hasEnd || !hasStart) {\n            for (let i = 0; i < range.x; i++) {\n                for (let j = 0; j < range.y; j++) {\n                    setting.map[luPos.y + j][luPos.x + i].type = oldTypes.shift();\n                }\n            }\n            status.message = { text: '地圖上至少必須包含一格起點和一格終點', lastPost: Date.now() };\n        }\n    };\n    /* ��l�ݩʦC�� */\n    const typeButtonPairs = [\n        [\"none\", \"空地\"],\n        [\"block\", \"場外\"],\n        [\"start\", \"起點\"],\n        [\"end\", \"終點\"],\n        [\"dead\", \"毒面\"],\n        [\"ice\", \"冰面\"],\n        [\"muddy\", \"泥面\"],\n    ];\n\n    return (\n        <>\n            <div>\n                <meta charset=\"utf-8\" />\n                <canvas\n                    id=\"EditModeCanvas\"\n                    ref={canvasRef}\n                    width={`1200px`}\n                    height={`582px`}\n                    style={{ textAlign: \"center\" }}\n                ></canvas>\n                <div\n                    style={{\n                        width: 1024,\n                        height: 64,\n                        backgroundColor: 'inherit',\n                        margin: \"0px auto\",\n                    }}\n                >\n                    <div id=\"EditModeParameters\" style={{ backgroundColor: \"inherit\" }}>\n                        {status.select ? (\n                            <div style={{ textAlign: \"center\" }}>\n                                {typeButtonPairs.map((pair) => (\n                                    <Button\n                                        size=\"small\"\n                                        color=\"secondary\"\n                                        variant=\"outlined\"\n                                        onClick={() => {\n                                            changeSelectedGridsType(pair[0]);\n                                        }}\n                                        disabled={!status.select}\n                                    >\n                                        {pair[1]}\n                                    </Button>\n                                ))}\n                            </div>\n                        ) : (\n                                <div></div>\n                            )}\n                        {status.holding || status.hold ? (\n                            <div style={{ backgroundColor: \"inherit\", marginRight: \"0.1cm\" }}>\n                                {Object.keys(status.holdDetail).map((p) => {\n                                    switch (status.holdDetail[p].type) {\n                                        case \"text\":\n                                            return (\n                                                <div\n                                                    style={{\n                                                        display: \"inline-block\",\n                                                        float: \"left\",\n                                                        backgroundColor: \"inherit\",\n                                                        marginRight: \"0.5cm\",\n                                                    }}\n                                                >\n                                                    <TextField\n                                                        label={EtC[p] ? EtC[p] : p}\n                                                        value={status.holdObject.detail[p]}\n                                                        onChange={(e) => {\n                                                            let newStatus = { ...status };\n                                                            let newDetail = { ...status.holdObject.detail };\n                                                            newDetail[p] = e.target.value;\n                                                            newStatus.holdObject.detail = newDetail;\n                                                            setStatus(newStatus);\n                                                        }}\n                                                    />\n                                                </div>\n                                            );\n                                        case \"select\":\n                                            return (\n                                                <div\n                                                    style={{\n                                                        display: \"inline-block\",\n                                                        float: \"left\",\n                                                        backgroundColor: \"inherit\",\n                                                        marginRight: \"0.5cm\",\n                                                    }}\n                                                >\n                                                    <FormControl\n                                                        variant=\"outlined\"\n                                                        className={classes.formControl}\n                                                    >\n                                                        <InputLabel>{EtC[p] ? EtC[p] : p}</InputLabel>\n                                                        <Select\n                                                            value={status.holdObject.detail[p]}\n                                                            onChange={(e) => {\n                                                                let newStatus = { ...status };\n                                                                let newDetail = { ...status.holdObject.detail };\n                                                                newDetail[p] = e.target.value;\n                                                                newStatus.holdObject.detail = newDetail;\n                                                                setStatus(newStatus);\n                                                            }}\n                                                            label={EtC[p] ? EtC[p] : p}\n                                                        >\n                                                            {status.holdDetail[p].options.map((o) => (\n                                                                <MenuItem value={o}>{EtC[o] ? EtC[o]: o}</MenuItem>\n                                                            ))}\n                                                        </Select>\n                                                    </FormControl>\n                                                </div>\n                                            );\n                                        case \"int\":\n                                            return (\n                                                <div\n                                                    style={{\n                                                        display: \"inline-block\",\n                                                        float: \"left\",\n                                                        backgroundColor: \"inherit\",\n                                                        marginRight: \"0.5cm\",\n                                                    }}\n                                                >\n                                                    <Typography id=\"discrete-slider\" gutterBottom>\n                                                        {EtC[p] ? EtC[p] : p}\n                          </Typography>\n                                                    <Slider\n                                                        style={{ minWidth: 200 }}\n                                                        value={status.holdObject.detail[p]}\n                                                        aria-labelledby=\"discrete-slider\"\n                                                        valueLabelDisplay=\"auto\"\n                                                        step={1}\n                                                        marks\n                                                        min={status.holdDetail[p].min}\n                                                        max={status.holdDetail[p].max}\n                                                        onChange={(e, newValue) => {\n                                                            let newStatus = { ...status };\n                                                            let newDetail = { ...status.holdObject.detail };\n                                                            newDetail[p] = newValue;\n                                                            newStatus.holdObject.detail = newDetail;\n                                                            setStatus(newStatus);\n                                                        }}\n                                                    />\n                                                </div>\n                                            );\n                                        case \"check\":\n                                            return (\n                                                <div\n                                                    style={{\n                                                        display: \"inline-block\",\n                                                        float: \"left\",\n                                                        backgroundColor: \"inherit\",\n                                                        marginRight: \"0.5cm\",\n                                                    }}\n                                                >\n                                                    <FormControlLabel\n                                                        control={\n                                                            <Checkbox\n                                                                checked={status.holdObject.detail[p]}\n                                                                onChange={(e) => {\n                                                                    let newStatus = { ...status };\n                                                                    let newDetail = {\n                                                                        ...status.holdObject.detail,\n                                                                    };\n                                                                    newDetail[p] = e.target.checked;\n                                                                    newStatus.holdObject.detail = newDetail;\n                                                                    setStatus(newStatus);\n                                                                }}\n                                                            />\n                                                        }\n                                                        label={EtC[p] ? EtC[p] : p}\n                                                    />\n                                                </div>\n                                            );\n                                        default:\n                                            return <div></div>;\n                                    }\n                                })}\n                            </div>\n                        ) : (\n                                <div style={{ backgroundColor: \"inherit\" }}></div>\n                            )}\n                    </div>\n                </div>\n            </div>\n        </>\n    );\n});\n\nexport default EditGameMode;\n","import Vec2 from '../Class/Vec2';\nimport * as GameObject from '../Class/GameObject';\nimport constant from '../constant';\n\nexport default function Controller(scene, status, setStatus, setting, reset) {\n\tconst mapStart = constant.mapStart;\n\tconst mapEnd = constant.mapStart.add(constant.mapSize.mul(constant.gridWidth));\n\tconst w = constant.gridWidth;\n\tconst copyable = (e, object) => {\n\t\treturn (e.ctrlKey && object.type !== 'portal' && object.type !== 'lockedWall' && object.type !== 'unlocker' && object.type !== 'woodenBox')\n\t};\n\n\tconst mouseMoveHandler = (e) => {\n\t\tconst mousePos = new Vec2(e.offsetX, e.offsetY);\n\t\tif (!status.holding && status.selecting && mousePos.between(mapStart, mapEnd)) {\n\t\t\t/* 當使用者沒有操控物件時並且正在選擇格子的時候，在地圖空間內即時更新選擇範圍 */\n\t\t\tlet selectGridPos = mousePos.sub(mapStart).toGrid(w);\n\t\t\tstatus.selectPair[1] = selectGridPos;\n\t\t} else if (status.holding) {\n\t\t\t/* 當使用者正在操控物件時，更新物件位子到滑鼠位子 */\n\t\t\tif (mousePos.between(mapStart, mapEnd) && !status.clear) {\n\t\t\t\t/* 物件在地圖內時必須即時校正位子 */\n\t\t\t\tstatus.holdObject.pos = mousePos.sub(mapStart).toGrid(w).mul(w).add(mapStart.add(new Vec2(0.5 * w, 0.5 * w)));\n\t\t\t} else status.holdObject.pos = mousePos.clone();\n\t\t}\n\t};\n\n\tconst mouseDownHandler = (e) => {\n\t\tconst mousePos = new Vec2(e.offsetX, e.offsetY);\n\t\tif (e.button === 0) {\n\t\t\tif (mousePos.between(mapStart, mapEnd)) {\n\t\t\t\tconsole.log(status.clear);\n\t\t\t\tif (status.clear) {\n\t\t\t\t\tlet gridPos = mousePos.sub(mapStart).toGrid(w);\n\t\t\t\t\tlet topLayer = setting.map[gridPos.y][gridPos.x].layer.top();\n\t\t\t\t\tif (topLayer !== -1) { // 代表有物件疊在格子上(處理物件清除)\n\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\n\t\t\t\t\t\t\tif (setting.objects[i].gridPos.equal(gridPos)) {\n\t\t\t\t\t\t\t\tif (e.ctrlKey || setting.objects[i].layer.top() === topLayer) {\n\t\t\t\t\t\t\t\t\tsetting.objects[i].remove(setting.map, setting.objects);\n\t\t\t\t\t\t\t\t\tsetting.objects.splice(i--, 1);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t/* 在地圖內按下滑鼠左鍵 */\n\t\t\t\t\tif (status.holding) {\n\t\t\t\t\t\tstatus.holdObject.pos = mousePos.sub(mapStart).toGrid(w).mul(w).add(mapStart.add(new Vec2(0.5 * w, 0.5 * w)));\n\t\t\t\t\t\t/* 嘗試把物件放在地圖上 */\n\t\t\t\t\t\tlet newStatus = { ...status };\n\t\t\t\t\t\tif (e.ctrlKey && !copyable(e, status.holdObject)) {\n\t\t\t\t\t\t\tnewStatus.message = { text: '這個物件無法被複製', lastPost: Date.now() };\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewStatus.holding = copyable(e, status.holdObject);\n\t\t\t\t\t\tif (status.holdObject.place(setting.map, setting.objects)) {\n\t\t\t\t\t\t\tsetting.objects.push(status.holdObject);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewStatus.message = { text: '這個格子已經被其他同種的物件佔據', lastPost: Date.now() };\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewStatus.holdObject = (copyable(e, status.holdObject)) ? status.holdObject.clone() : null;\n\t\t\t\t\t\tsetStatus(newStatus);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* 如果沒有在操控物件則開始選擇格子或是選取在地圖上的物件 */\n\t\t\t\t\t\tlet newStatus = { ...status };\n\t\t\t\t\t\tlet gridPos = mousePos.sub(mapStart).toGrid(w);\n\t\t\t\t\t\tlet topLayer = setting.map[gridPos.y][gridPos.x].layer.top();\n\t\t\t\t\t\tif (topLayer !== -1) { // 代表有物件疊在格子上(優先處理物件操控)\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\n\t\t\t\t\t\t\t\tif (setting.objects[i].gridPos.equal(gridPos) && setting.objects[i].layer.top() === topLayer) {\n\t\t\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\t\t\tnewStatus.hold = false;\n\t\t\t\t\t\t\t\t\tnewStatus.select = false;\n\t\t\t\t\t\t\t\t\tnewStatus.selecting = false;\n\t\t\t\t\t\t\t\t\tif (e.ctrlKey && !copyable(e, setting.objects[i])) {\n\t\t\t\t\t\t\t\t\t\tnewStatus.message = { text: '這個物件無法被複製', lastPost: Date.now() };\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!copyable(e, setting.objects[i])) setting.objects[i].remove(setting.map, setting.objects);\n\t\t\t\t\t\t\t\t\tnewStatus.holdObject = (copyable(e, setting.objects[i])) ? setting.objects[i].clone() : setting.objects[i];\n\t\t\t\t\t\t\t\t\tnewStatus.holdObject.pos = mousePos.sub(mapStart).toGrid(w).mul(w).add(mapStart.add(new Vec2(0.5 * w, 0.5 * w)));\n\t\t\t\t\t\t\t\t\tnewStatus.holdDetail = setting.objects[i].detailFunction();\n\t\t\t\t\t\t\t\t\tif (!copyable(e, setting.objects[i])) setting.objects.splice(i, 1);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewStatus.select = true;\n\t\t\t\t\t\t\tnewStatus.selecting = true;\n\t\t\t\t\t\t\tnewStatus.selectPair = [gridPos, gridPos];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetStatus(newStatus);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t/* 左鍵點到地圖外則將一切狀態解除(點到物件編輯庫例外) */\n\t\t\t\tlet newStatus = { ...status };\n\t\t\t\tnewStatus.select = false;\n\t\t\t\tnewStatus.selecting = false;\n\t\t\t\tnewStatus.holding = false;\n\t\t\t\tnewStatus.hold = false;\n\t\t\t\tnewStatus.holdObject = null;\n\t\t\t\tnewStatus.clear = false;\n\t\t\t\tsetStatus(newStatus);\n\t\t\t\tif (mousePos.between(new Vec2(88, 516), new Vec2(1112, 580))) {\n\t\t\t\t\t/* 在物件編輯庫內點擊則獲得一個新物件進行操控 */\n\t\t\t\t\tlet objectIndex = ~~((e.offsetX - 88) / 64);\n\t\t\t\t\tlet result = '';\n\t\t\t\t\tif (objectIndex === 0) result = 'stoporplay';\n\t\t\t\t\telse if (objectIndex === 15) result = 'clear';\n\t\t\t\t\telse {\n\t\t\t\t\t\tconst objectList = [];\n\t\t\t\t\t\tobjectList.push('class platform');\n\t\t\t\t\t\tif (status.opt === 1) objectList.push(...constant.editObjectList.platform);\n\t\t\t\t\t\tobjectList.push('class covering');\n\t\t\t\t\t\tif (status.opt === 2) objectList.push(...constant.editObjectList.covering);\n\t\t\t\t\t\tobjectList.push('class obstacle');\n\t\t\t\t\t\tif (status.opt === 3) objectList.push(...constant.editObjectList.obstacle);\n\t\t\t\t\t\tobjectList.push('class special');\n\t\t\t\t\t\tif (status.opt === 4) objectList.push(...constant.editObjectList.special);\n\t\t\t\t\t\tresult = (objectList[objectIndex - 1]) ? objectList[objectIndex - 1] : '';\n\t\t\t\t\t}\n\t\t\t\t\tlet count = 0;\n\t\t\t\t\tswitch (result) {\n\t\t\t\t\t\tcase 'stoporplay':\n\t\t\t\t\t\t\tnewStatus.clear = false;\n\t\t\t\t\t\t\tnewStatus.active = !newStatus.active;\n\t\t\t\t\t\t\tif (newStatus.active) {\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '建議在靜止狀態下編輯物件', lastPost: Date.now(), color: 'green'};\n                            }\n\t\t\t\t\t\t\treset();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\t\tnewStatus.clear = !newStatus.clear;\n\t\t\t\t\t\t\tif (newStatus.clear) {\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '注意！你現在處於清除物件的狀態', lastPost: Date.now(), color: 'green' };\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\t\tnewStatus.holdObject = { type: 'trashCan', pos: new Vec2(e.offsetX, e.offsetY)};\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = {};\n                            }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'class platform':\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 1) ? 0 : 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'class covering':\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 2) ? 0 : 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'class obstacle':\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 3) ? 0 :  3;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'class special':\n\t\t\t\t\t\t\tnewStatus.opt = (status.opt === 4) ? 0 : 4;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'spikedBlock':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.spikedBlock(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'platform':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.platform(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'bow':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.bow(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'movingPlatform':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.movingPlatform(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mucus':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.mucus(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'cymbal':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.cymbal(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'ice':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.ice(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'conveyor':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.conveyor(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'portal':\n\t\t\t\t\t\t\tcount = 0;\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'portal') count++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (count < 16) {\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.portal(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '傳送門最多只能放置 16 個', lastPost: Date.now() };\n                            }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'trapPlatform':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.trapPlatform(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'missileBase':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.missileBase(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'lockedWall':\n\t\t\t\t\t\t\tcount = 0;\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'lockedWall') count++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (count < 8) {\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.lockedWall(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '上鎖的牆最多只能放置 8 個', lastPost: Date.now() };\n                            }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'unlocker':\n\t\t\t\t\t\t\tcount = 0;\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'unlocker') count++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (count < 8) {\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.unlocker(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '鑰匙最多只能放置 8 個', lastPost: Date.now() };\n                            }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'block':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.block(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak; \n\t\t\t\t\t\tcase 'movingPlatform_oblique':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.movingPlatform_oblique(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'movingPlatform_rect':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.movingPlatform_rect(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'woodenBox':\n\t\t\t\t\t\t\tcount = 0;\n\t\t\t\t\t\t\tfor (let i = 0; i < setting.objects.length; i++) {\n\t\t\t\t\t\t\t\tif (setting.objects[i].type === 'woodenBox') count++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (count < 16) {\n\t\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.woodenBox(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewStatus.holding = false;\n\t\t\t\t\t\t\t\tnewStatus.message = { text: '木箱最多只能放置 16 個', lastPost: Date.now() };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'magnet':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.magnet(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'brokenPlatform':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.brokenPlatform(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'deathTotem':\n\t\t\t\t\t\t\tnewStatus.holding = true;\n\t\t\t\t\t\t\tnewStatus.holdObject = new GameObject.deathTotem(new Vec2(e.offsetX, e.offsetY));\n\t\t\t\t\t\t\tnewStatus.holdDetail = newStatus.holdObject.detailFunction();\n\t\t\t\t\t\t\tnewStatus.holdObject.setPerspective(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (result !== 'clear') newStatus.clear = false;\n\t\t\t\t\tsetStatus(newStatus);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst mouseUpHandler = (e) => {\n\t\tconst mousePos = new Vec2(e.offsetX, e.offsetY);\n\t\tif (e.button === 0 && status.select && status.selecting && mousePos.between(mapStart, mapEnd)) {\n\t\t\t/* 在正在選擇的狀態下放開左鍵確定選擇格子的範圍後解除正在選擇的狀態 */\n\t\t\tlet newStatus = { ...status };\n\t\t\tnewStatus.selecting = false;\n\t\t\tlet selectGridPos = mousePos.sub(mapStart).toGrid(w);\n\t\t\tnewStatus.selectPair[1] = selectGridPos;\n\t\t\tsetStatus(newStatus);\n\t\t} else {\n\t\t\t/* 否則在任何其他狀況都直接解除選擇/正在選擇的狀態 */\n\t\t\tlet newStatus = { ...status };\n\t\t\tnewStatus.select = false;\n\t\t\tnewStatus.selecting = false;\n\t\t\tsetStatus(newStatus);\n\t\t}\n\t}\n\n\tconst stopContextMenu = (e) => {\n\t\te.preventDefault();\n\t};\n\n\tscene.addEventListener('mousemove', mouseMoveHandler);\n\tscene.addEventListener('mousedown', mouseDownHandler);\n\tscene.addEventListener('mouseup', mouseUpHandler);\n\tscene.addEventListener('contextmenu', stopContextMenu);\n\n\treturn () => {\n\t\tscene.removeEventListener('mousemove', mouseMoveHandler);\n\t\tscene.removeEventListener('mousedown', mouseDownHandler);\n\t\tscene.removeEventListener('mouseup', mouseUpHandler);\n\t\tscene.removeEventListener('contextmenu', stopContextMenu);\n\t};\n};","import constant from '../constant';\n\nexport default function Engine(objects, map) {\n    for (let i = 0; i < constant.maxLayer; i++) {\n        for (let j = 0; j < objects.length; j++) {\n            if (objects[j].update) {\n                const result = objects[j].update(objects, map);\n                switch (result.type) {\n                    case 'produce':\n                        objects.push(result.object);\n                        break;\n                    case 'destory':\n                        objects.splice(j--, 1);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n    }\n}\n","import React from \"react\";\nimport { useState, useRef } from \"react\";\nimport EditMode from \"../GameContainer/EditMode/Main\";\nimport Vec2 from \"../GameContainer/Class/Vec2\";\nimport { useHistory } from \"react-router-dom\";\nimport ErrorPage from \"./ErrorPage\";\nimport LoadingPage from \"./LoadingPage\";\nimport instance from \"./Api\";\n\n// import util from \"util\";\nimport init from \"../GameContainer/Setting/example_0\";\nimport { enpackage, unpackage, show } from \"../GameContainer/DataPackager\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloudUploadIcon from \"@material-ui/icons/CloudUpload\";\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport Modal from \"@material-ui/core/Modal\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Switch from \"@material-ui/core/Switch\";\nimport { url } from \"./url\";\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nconst useStyles = makeStyles((theme) => ({\n  margin: {\n    margin: theme.spacing(1),\n  },\n  extendedIcon: {\n    marginRight: theme.spacing(1),\n  },\n}));\nfunction checkLogin(props) {\n  if (props.location.state === undefined) return false;\n  else if (!props.location.state.login) return false;\n  return true;\n}\n\nfunction Edit(props) {\n  const classes = useStyles();\n  const history = useHistory();\n  const [open, setOpen] = useState(false);\n  const [title, setTitle] = useState(props.data.title);\n  const [description, setDescription] = useState(props.data.description);\n  // for Snackbar Alert\n  const [msgOpen, setMsgOpen] = useState(false);\n  const [alertMsg, setAlertMsg] = useState(\"\");\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\n  const [setting, setSetting] = useState(init);\n  const [idGetMap, setidGetMap] = useState(false);\n  const [publish, setPublish] = useState(false);\n  // upload work around\n  const [delayUpload, setDelayUpload] = useState(false);\n\n  const [id, setId] = useState(props.data.id);\n  const childRef = useRef();\n\n  let { name, uuid, login } = props.data;\n\n  const handleUpload = async () => {\n    console.log(\"upload function\");\n    let settingPack = setting;\n    let id0 = id;\n    const {\n      data: { success, errorCode, idNew },\n    } = await instance.post(\"/api/upload\", {\n      uuid,\n      settingPack,\n      title,\n      description,\n      name,\n      publish,\n      id0,\n    });\n    if (!success) {\n      if (errorCode === 1) {\n        setAlertMsg(\"This map exists. The map has been updated\");\n        setAlertType(\"info\");\n        setMsgOpen(true);\n        // alert(`This map exists.`);\n      } else if (errorCode === 2) {\n        // alert(`Too many maps!! Every user can only save 8 maps.`);\n        setAlertMsg(\"Too many maps!! Every user can only save 8 maps.\");\n        setAlertType(\"error\");\n        setMsgOpen(true);\n      } else {\n        // alert(`Unknow error. Error code:${errorCode}`);\n        setAlertMsg(`Unknow error. Error code:${errorCode}`);\n        setAlertType(\"error\");\n        setMsgOpen(true);\n      }\n    } else {\n      setAlertMsg(\"This is a success message!\");\n      setAlertType(\"success\");\n      setMsgOpen(true);\n    }\n    // id = idNew;\n    setId(idNew);\n    console.log(\"Upload success\");\n    setOpen(false);\n  };\n\n  const getMap = async () => {\n    const {\n      data: { success, errorCode, map },\n    } = await instance.post(\"/api/getMap\", {\n      id,\n    });\n    if (!success) {\n      setAlertMsg(`Error. Error code:${errorCode}`);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n    } else {\n      setAlertMsg(`Load data success`);\n      setAlertType(\"success\");\n      setMsgOpen(true);\n      setSetting(map[\"content\"]);\n      setidGetMap(true);\n    }\n  };\n\n  if (id !== 0 && idGetMap === false) {\n    getMap();\n  }\n  if (delayUpload) {\n    handleUpload();\n    setDelayUpload(false);\n  }\n\n  const save = (setting) => {\n    console.log(\"Update setting\");\n    setSetting(enpackage(setting));\n    // show(enpackage(setting));\n  };\n\n  // console.log(util.inspect(setting, {showHidden: false, depth: null}))\n\n  return (\n    <div style={{ textAlign: \"center\" }}>\n      <Snackbar\n        open={msgOpen}\n        autoHideDuration={500}\n        onClose={() => {\n          setMsgOpen(false);\n        }}\n      >\n        <Alert\n          onClose={() => {\n            setMsgOpen(false);\n          }}\n          severity={alertType}\n        >\n          {alertMsg}\n        </Alert>\n      </Snackbar>\n      <div style={{ marginTop: \"1em\" }}>\n        <IconButton\n          className={classes.margin}\n          size=\"large\"\n          variant=\"outlined\"\n          color=\"secondary\"\n          onClick={history.goBack}\n        >\n          <ArrowBackRoundedIcon />\n        </IconButton>\n\n        <IconButton\n          className={classes.margin}\n          size=\"large\"\n          variant=\"outlined\"\n          color=\"secondary\"\n          disabled={Object.entries(setting).length === 0}\n          onClick={() => {\n            childRef.current.returnSetting();\n            setOpen(true);\n          }}\n        >\n          <CloudUploadIcon />\n        </IconButton>\n        <IconButton\n          size=\"large\"\n          variant=\"contained\"\n          color=\"secondary\"\n          onClick={() => {\n            if (childRef.current) {\n              childRef.current.returnSetting();\n            }\n            if (!title || !description) {\n              setOpen(true);\n            } else {\n              setPublish(false);\n              setDelayUpload(true);\n              // setTimeout(setOpen(true), 500);\n              // setOpen(false);\n\n              // handleUpload();\n              // setTimeout(handleUpload, 600);\n            }\n          }}\n        >\n          <SaveIcon />\n        </IconButton>\n      </div>\n      <Modal\n        open={open}\n        onClose={() => {\n          setOpen(false);\n        }}\n      >\n        <>\n          <div className=\"upload\">\n            <TextField\n              label=\"Title\"\n              variant=\"filled\"\n              rows={1}\n              placeholder=\"Title\"\n              defaultValue=\"\"\n              value={title}\n              onChange={(event) => {\n                // console.log(event.target.value);\n                if (event.target.value.length <= 14) {\n                  setTitle(event.target.value);\n                }\n              }}\n            />\n            <TextField\n              id=\"filled-textarea\"\n              label=\"Description\"\n              variant=\"filled\"\n              multiline\n              placeholder=\"Description\"\n              defaultValue=\"\"\n              value={description}\n              onChange={(event) => {\n                if (event.target.value.length <= 30) {\n                  setDescription(event.target.value);\n                }\n              }}\n            />\n            <IconButton\n              className={classes.margin}\n              size=\"large\"\n              variant=\"contained\"\n              color=\"secondary\"\n              onClick={handleUpload}\n              disabled={!title || !description}\n            >\n              <CloudUploadIcon />\n            </IconButton>\n          </div>\n          <div className=\"upload_\">\n            <FormControlLabel\n              control={\n                <Switch\n                  checked={publish}\n                  onChange={() => setPublish(!publish)}\n                  name=\"public on internet\"\n                />\n              }\n              label=\"public on internet\"\n            />\n          </div>\n        </>\n      </Modal>\n      {msgOpen === true ? (\n        <LoadingPage />\n      ) : (\n        <EditMode\n          width=\"1200px\"\n          height=\"600px\"\n          ref={childRef}\n          setting={unpackage(setting)}\n          save={save}\n        />\n      )}\n    </div>\n  );\n}\nfunction Editmode(props) {\n  return (\n    <>\n      {checkLogin(props) ? <Edit data={props.location.state} /> : <ErrorPage />}\n    </>\n  );\n}\n\nexport default Editmode;\n","\nexport const CONSTANT = {\n\tgridWidth: 32,\n\tblockColor: '#E0E0E0',\n\t// canvasLeft: 150,\n\t// canvasTop: 70,\n    CanvasWidth: \"1250\",\n    CanvasHeight: \"680\",\n\ttranslate: {x: -270,y:-110},\n\tscale: {w: 2.5,h:2.5},\n\tPlayerR: 10,\n\tPLAYING:'playing',\n\tGameOver: 'GAME OVER',\n\tWIN: 'WIN'\n};\n\nexport const Msg = {\n\tspike: [\"死於【尖刺】\", \"被刺到了啦\"],\n\tarrow: [\"死於【箭矢】\", \"暗箭難防QQ\"],\n\tcymbalWave: [\"死於【音波】\", \"你的耳膜還好嗎？\"],\n\tmissile: [\"死於【飛彈】\", \"來自北緯38度線的問候\"],\n\tdeathTotem: [\"死於【死亡圖騰】\", \"太小看圖騰的威力！\"],\n\t// floor\n\tdead: [\"死於【毒面】\", \"紫水有毒...\"],\n\tend: [\"耶黑\", \"逃出來惹\"]\n}\n\nexport const Link = {\n\tgithub: \"https://github.com/allpass122/WebProgrammmingFinal2020\"\n}\n","export default __webpack_public_path__ + \"static/media/seal.e6aeaa60.svg\";","export default __webpack_public_path__ + \"static/media/lion.a9dff392.svg\";","export default __webpack_public_path__ + \"static/media/cat.a83e8f86.svg\";","export default __webpack_public_path__ + \"static/media/star.d1d61ef5.svg\";","// tribute to https://github.com/vzhou842/example-.io-game\n// svg source: https://www.flaticon.com/\nimport axios from \"axios\";\nimport SealIcon from \"../../assets/seal.svg\";\nimport LionIcon from \"../../assets/lion.svg\";\nimport CatIcon from \"../../assets/cat.svg\";\nimport StarIcon from \"../../assets/star.svg\";\n\nconst ASSET_NAMES = [\"seal.svg\", \"lion.svg\", \"cat.svg\"];\nconst ALL_ASSET_NAMES = [\"seal.svg\", \"lion.svg\", \"cat.svg\", \"star.svg\"];\n\nconst mapName2Path = {\n  \"seal.svg\": SealIcon,\n  \"lion.svg\": LionIcon,\n  \"cat.svg\": CatIcon,\n  \"star.svg\": StarIcon,\n};\n\nconst assets = {};\n\nconst downloadPromise = Promise.all(ALL_ASSET_NAMES.map(downloadAsset));\n\n/** @param {keyof mapName2Path} name */\nasync function downloadAsset(name) {\n  const image = new Image();\n  let imageSrc = mapName2Path[name];\n  if (imageSrc.endsWith(\".svg\")) {\n    const resp = await axios.get(mapName2Path[name]);\n    const doc = new DOMParser().parseFromString(resp.data, \"text/xml\");\n    const svgElem = doc.getElementsByTagName(\"svg\")[0];\n    svgElem.setAttribute(\"width\", \"48px\");\n    svgElem.setAttribute(\"height\", \"48px\");\n    const b64Svg = btoa(new XMLSerializer().serializeToString(svgElem));\n    imageSrc = \"data:image/svg+xml;base64,\" + b64Svg;\n  }\n  await new Promise((resolve) => {\n    image.onload = () => resolve();\n    image.src = imageSrc;\n  });\n  assets[name] = image;\n}\n\nexport const downloadAssets = () => downloadPromise;\n\nexport const getAsset = (assetName) => assets[assetName];\n\nexport const getAssetNames = () => ASSET_NAMES;\n","import {clear, drawMap} from '../Drawer'\nimport constant from '../constant';\nimport {CONSTANT} from './PlayModeConstant'\nimport { getAsset } from './assets';\n\nlet FOCUS_PLAYER = true\nlet PLAY_MODE = true\n\nfunction Drawer(ctx, setting, status) {\n\tlet map = setting.map;\n\tlet objects = setting.objects;\n\tlet me = status.me.serializeForUpdate()\n\tconst w = constant.gridWidth\n\n\t/* �M�ŵe�� */\n\tclear(ctx);\n\n\t\n\tctx.restore()\n\tctx.save()\n\n\t// draw background\n\tctx.fillStyle = constant.blockColor\n\tctx.fillRect(0, -100, constant.mapSize.x*w*2, constant.mapSize.y*w*2);\n\n\tif (status.FOCUS_PLAYER) {\n\t\tctx.scale(CONSTANT.scale.w, CONSTANT.scale.h);\n\t\tctx.translate(CONSTANT.translate.x, CONSTANT.translate.y);        \n\t} else {\n\t\t// playmode whole view\n\t\tctx.scale(1.2, 1.2);\n\t\tctx.translate(-80, 30);\t\n\t}\n\t\n\t/* ø�s�a�� */\n\tctx.save();\n\tctx.translate(constant.mapStart.x, constant.mapStart.y); \n\tfocusPlayer(ctx, me, status)\n\tdrawMap(ctx, map, PLAY_MODE);\n\tctx.restore();\n\n\t/* ø�s���� */\n\tctx.save();\n\tfocusPlayer(ctx, me, status)\n\tfor (let i = 0; i < constant.maxLayer; i++) {\n\t\t// 2 < player layer < 3\n\t\tif (i === 3) drawPlayer(ctx, me, me, status.head)\n\t\tfor (let j = 0; j < objects.length; j++) {\n\t\t\tif (objects[j].layer.top() === i) objects[j].draw(ctx);\n\t\t}\n\t}\n\tctx.restore();\n\t\n}\n\nfunction focusPlayer(context, me, status) {\n\tif (!status.FOCUS_PLAYER) return\n\tconst w = constant.gridWidth\n\tlet focusX =  0*constant.mapStart.x + constant.mapSize.x*w/2 - me.x\n\tlet focusY =  0*constant.mapStart.y + constant.mapSize.y*w/2 - me.y\n\tcontext.translate(focusX, focusY); \n}\n\n// Renders a player at the given coordinates\nfunction drawPlayer(context, me, player, head = 'seal.svg') {\n\tconst { x, y } = me;\n\tconst w = constant.gridWidth\n  \n\tcontext.save();\n\tcontext.translate(x, y);\n\n\t// context.globalAlpha = 0.5\n\tcontext.drawImage(\n\t\tgetAsset(head),\n\t\t-CONSTANT.PlayerR,\n\t\t-CONSTANT.PlayerR,\n\t\tCONSTANT.PlayerR * 2,\n\t\tCONSTANT.PlayerR * 2,\n\t  );\n  \n\tcontext.restore();\n  }\n\nexport default Drawer;","import constant from '../constant';\nimport { CONSTANT } from './PlayModeConstant';\n\nexport default function Engine(objects, map, status) {\n    const {me} = status\n    const needEngin = ['movingPlatform','movingPlatform_oblique', 'movingPlatform_rect', \n                'bow', 'arrow', 'missile', 'missileBase', 'cymbal','cymbalWave', 'woodenBox', 'mucus', 'magnet' ]\n\n    for (let i = 0; i < constant.maxLayer; i++) {\n        for (let j = 0; j < objects.length; j++) {\n            if ( status.gameState === CONSTANT.PLAYING \n                && !inView(objects[j].pos, me) \n                && !needEngin.includes(objects[j].type) ) continue \n            if (objects[j].update) {\n                const result = objects[j].update(objects, map);\n                switch (result.type) {\n                    case 'produce':\n                        objects.push(result.object);\n                        break;\n                    case 'destory':\n                        objects.splice(j--, 1);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n    }\n}\n\nfunction inView(ObjPos, me){\n    const [halfViewX, halfViewY] = [250, 180]\n    if ( ObjPos.x > me.pos.x - halfViewX && ObjPos.x < me.pos.x + halfViewX \n            && ObjPos.y > me.pos.y - halfViewY && ObjPos.y < me.pos.y + halfViewY ){\n                // console.log('me ', me.pos)\n                // console.log('obj ', ObjPos)\n                // console.log(\"inView\")\n                return true\n            }\n    else return false\n}","import Vec2 from \"../Class/Vec2\";\nimport constant from \"../constant\"\nimport {CONSTANT, Msg} from \"./PlayModeConstant\"\n\nconst w = constant.gridWidth;\nlet blockArea = []\n\nexport function initState(status, setting) {\n  const { map, objects } = setting\n\n  // random player start area\n  const startArea = []\n  map.forEach((line, y) => (line.forEach((square, x) => {\n    if (square.type.includes('start')) startArea.push({ x, y })\n  })))\n  const { x, y } = startArea[Math.floor(Math.random() * startArea.length)]\n  status.me.moveTo(constant.mapStart.x + (x + 0.5) * w, constant.mapStart.y + (y + 0.5) * w)\n\n  blockArea = []\n  map.forEach((line, y) => (line.forEach((square, x) => {\n    if (square.type.includes('block')) blockArea.push({ x, y })\n  })))\n\n  // set object no transparant\n  for (let i = 0; i < objects.length; i++) {\n    if (objects[i].setPerspective) objects[i].setPerspective(false)\n  }\n\n  status.startTime = Date.now()\n  status.lastUpdateTime = Date.now()\n}\n\nexport function updateState(status, setting, setStatus) {\n  const { map } = setting\n\n  const dt = Date.now() - status.lastUpdateTime\n\n  checkLocation(status, map, setStatus)\n  checkEncounter(status, setting, setStatus)\n  status.lastUpdateTime = Date.now()\n  push(status)\n\n  status.me.update(dt)\n\n}\n\nfunction push(status){\n  let { pressDown, pressRight, pressLeft, pressUp } = status\n  let [pushX, pushY] = [0, 0]\n  if (pressDown) pushY += 1\n  if (pressUp) pushY -= 1\n  if (pressRight) pushX += 1\n  if (pressLeft) pushX -= 1\n  status.me.push(new Vec2(pushX, pushY))\n}\n\n\nfunction checkLocation(status, map, setStatus) {\n  let { x, y } = status.me.serializeForUpdate()\n  let {me} = status.me \n  const LeftBound = constant.mapStart.x + CONSTANT.PlayerR\n  const RightBound = constant.mapStart.x + constant.mapSize.x * w - CONSTANT.PlayerR\n  const UpperBound = constant.mapStart.y + CONSTANT.PlayerR\n  const LowerBound = constant.mapStart.y + constant.mapSize.y * w - CONSTANT.PlayerR\n\n  // canvas 4 sides rebound\n  if (x < LeftBound || x > RightBound || y < UpperBound || y > LowerBound) {\n    status.me.returnLastLoc()\n    if (x < LeftBound)\n      status.me.rebound(new Vec2(LeftBound - w, y))\n    else if (x > RightBound)\n      status.me.rebound(new Vec2(RightBound + w, y))\n    else if (y < UpperBound)\n      status.me.rebound(new Vec2(x, UpperBound - w))\n    else if (y > LowerBound)\n      status.me.rebound(new Vec2(x, 9999))\n  }\n\n  // block 4 sides rebound\n  blockArea.some(block => {\n    if (x + CONSTANT.PlayerR > constant.mapStart.x + (block.x) * w\n      && x - CONSTANT.PlayerR < constant.mapStart.x + (block.x + 1) * w\n      && y + CONSTANT.PlayerR > constant.mapStart.y + (block.y) * w\n      && y - CONSTANT.PlayerR < constant.mapStart.y + (block.y + 1) * w) {\n      status.me.returnLastLoc()\n      status.me.squareRebound(new Vec2(constant.mapStart.x + (block.x + 0.5) * w, constant.mapStart.y + (block.y + 0.5) * w))\n      return true\n    }\n  })\n\n  // check floor type & onPlateform\n  let mapX = Math.floor((x - constant.mapStart.x) / w)\n  let mapY = Math.floor((y - constant.mapStart.y) / w)\n  // console.log('mapX', mapX, ' mapY', mapY)\n  if ( (mapX < 0 || mapX > constant.mapSize.x) || (mapY < 0 || mapY > constant.mapSize.y) ) return\n  const floorType = map[mapY][mapX].type\n  status.me.resetFriction()\n  if (status.me.onPlatform() ){\n    status.me.setFriction(6)\n  } else if (floorType.includes('none') || floorType.includes('start') || floorType.includes('end') )\n    status.me.setFriction(1)\n  else if (floorType.includes('muddy'))\n    status.me.setFriction(5)\n  else if (floorType.includes('ice'))\n    status.me.setFriction(0.5)\n  else if (floorType.includes('dead')) \n    setStatus( () => ({...status, gameState: CONSTANT.GameOver,msg: Msg[\"dead\"], endTime: Date.now(), playTime:Date.now()-status.startTime })) \n\n  if (floorType.includes('end'))\n    setStatus( () => ({...status, gameState: CONSTANT.WIN, msg: Msg[\"end\"], endTime: Date.now(), playTime:Date.now()-status.startTime })) \n\n  status.me.updateLastLoc()\n}\n\n\n// check Live: Code from EditMode/Engine\nfunction checkEncounter(status, setting, setStatus) {\n  let {objects, map} = setting\n  let { me } = status\n  let onPlatform = false\n  let platformID, platformPos\n  let platformDistance = Math.MAX_SAFE_INTEGER\n  let beBlocked = false\n  let touchConveyor = 0\n  \n  for (let i = 0; i < objects.length; i++) {\n    if (objects[i].collision) {\n      const result = objects[i].collision({ type: 'sphere', pos: me.loc, r: CONSTANT.PlayerR });\n      if (result.includes('none')) continue\n      me.resetFriction()\n      // console.log('result', result)\n      if ( (result === 'block' || result === 'lockedWall' || result === 'cymbal' \n      || result === 'missileBase' || result === 'woodenBox') && !beBlocked ) {\n        if (result === 'woodenBox') objects[i].push(objects, map, me.pos);\n        beBlocked = true\n        me.returnLastLoc()\n        me.squareRebound(objects[i].pos)\n      }\n      // me.loc.length( objects[i].pos) < platformDistance: find the closest platform to transport\n      else if (result === 'platform' || result === 'movingPlatform' || result === 'brokenPlatform' \n                || me.loc.length( objects[i].pos) < platformDistance ) {\n        if (result === 'brokenPlatform') objects[i].break();\n        onPlatform = true\n        platformDistance =  me.loc.length( objects[i].pos)\n        platformID = i\n        platformPos = objects[i].pos\n        status.me.setFriction(3)\n      } else if (result === 'unlocker') objects[i].unlock(objects)\n      else if (result === 'portal') me.moveTo(objects[i].teleport(objects)) \n      else if (result === 'conveyor' && touchConveyor < 0.99 ) {\n        me.addVelocity(objects[i].detail.direction, 12)\n        touchConveyor++\n      } else if (result === 'missileRay') objects[i].fire(me);\n      else if (result === 'trap') me.setLastFriction()\n      else if (result === 'magneticField') \n      // me.pull(objects[i].getDisplacement().mul(1000)) BUG\n      me.loc = me.loc.add(objects[i].getDisplacement())\n      else if ( result === 'spike' || result === 'arrow' ||  result === 'cymbalWave' || result === 'missile' || result === 'deathTotem' ){\n        setStatus( () => ({...status, gameState: CONSTANT.GameOver, msg: Msg[result],endTime: Date.now(), playTime:Date.now()-status.startTime})) \n      }\n\n      // floor \n      if (result === 'mucus')\n        status.me.setFriction(10)\n      else if (result === 'ice')\n        status.me.setFriction(0.4)\n    }\n  }\n  // platForm logic\n  if (onPlatform && !beBlocked)\n    me.moveOnPlatform(platformID , platformPos)\n  if ( !onPlatform )\n    me.leavePlatform()\n}\n\n\n","// import ObjectClass from './object';\nimport Vec2 from '../../Class/Vec2';\nconst PUSH_FORCE = 800\nconst FRICTION = 0.09\nconst MAX_VELOCITY = 160\n\nexport default class Player {\n  constructor(id, username, x, y) {\n    this.id = id;\n    this.loc = new Vec2(x, y);\n    this.velocity = new Vec2(0, 0);\n    this.username = username;\n    this.score = 0;\n    this.pos = new Vec2(0, 0)\n\n    this.friction = FRICTION\n    this.lastFriction = 0\n    this.m = 1\n    this.force = new Vec2(0, 0)\n    this.acceleration = new Vec2(0, 0)\n    this.lastLoc = new Vec2(x, y)\n    this.lastPlatformID = \"-1\" \n    this.lastPlatformPos = new Vec2(0, 0)\n  }\n\n\n  update(dt) {\n    // ms to s\n    dt = dt / 1000\n    this.updateFAV(dt)\n    this.pos = this.loc\n    return null;\n  }\n\n  updateFAV(dt) {\n    // acceleration change  a = (F + f*v*v) / m\n    const v2 = this.velocity.unit().mul( Math.pow(this.velocity.length(),2))\n    this.acceleration = this.force.sub(v2.mul(this.friction)).div(this.m)\n\n    // velocity change\n    this.velocity = this.velocity.add(this.acceleration.mul(dt))\n    // somthing cause velocity exceed\n    this.checkVelocity()\n\n    // location change\n    this.loc = this.loc.add( this.velocity.mul(dt) )\n    this.force = new Vec2(0, 0)\n  }\n\n  checkVelocity() {\n    if (this.velocity.length() > MAX_VELOCITY)\n    this.velocity = this.velocity.unit().mul(MAX_VELOCITY)\n  }\n\n  moveTo(x, y) {\n    if (!y){\n      const newLoc = x\n      this.loc = newLoc\n    } else this.loc = new Vec2(x, y)\n  }\n\n  addVelocity(dir, vel) {\n    switch (dir) {\n      case 'down':\n        this.velocity = this.velocity.add(new Vec2(0, vel))\n        break\n      case 'right':\n        this.velocity = this.velocity.add(new Vec2(vel, 0))\n        break\n      case 'left':\n        this.velocity = this.velocity.add(new Vec2(-vel, 0))\n        break\n      case 'up':\n        this.velocity = this.velocity.add(new Vec2(0, -vel))\n        break\n    }\n  }\n\n  moveOnPlatform(id, platformPos) {\n    id = id.toString()\n    // meet a platform or change a platform\n    if(this.lastPlatformID === \"-1\" || this.lastPlatformID !== id ){\n      this.lastPlatformID = id\n      this.lastPlatformPos = platformPos\n    }\n    if(this.lastPlatformID === id){\n      this.loc = this.loc.add( platformPos.sub(this.lastPlatformPos) )\n      this.lastPlatformPos = platformPos\n    }\n  }\n\n  leavePlatform() {\n    this.lastPlatformID = \"-1\"\n  }\n\n  onPlatform() {\n    if (this.lastPlatformID === \"-1\")\n      return false\n    else return true\n  }\n\n  squareRebound(target) {\n    const vector = (new Vec2(this.loc.x - target.x, this.loc.y - target.y))\n    const Theta = Math.atan2(vector.y, vector.x)\n    // bound lower, left, upper, right in order\n    if (-3 / 4 * Math.PI < Theta && Theta < -1 / 4 * Math.PI)\n      this.rebound(new Vec2(this.loc.x, 9999))\n    else if (-1 / 4 * Math.PI < Theta && Theta < 1 / 4 * Math.PI)\n      this.rebound(new Vec2(0, this.loc.y))\n    else if (1 / 4 * Math.PI < Theta && Theta < 3 / 4 * Math.PI)\n      this.rebound(new Vec2(this.loc.x, 0))\n    else if (3 / 4 * Math.PI < Theta || (-3 / 4 * Math.PI > Theta && Theta < 0))\n      this.rebound(new Vec2(9999, this.loc.y))\n    else\n      console.log(\"why? no bound\")\n  }\n\n  /* reflect by this.velocity, but have bug */\n  // rebound(target) {\n  //   const normal = (new Vec2(this.loc.x - target.x, this.loc.y - target.y))\n  //   const reflectLineTheta = Math.atan2(normal.y, normal.x) + 0.5 * Math.PI\n  //   const newVelocityX = Math.cos(2 * reflectLineTheta) * this.velocity.x + Math.sin(2 * reflectLineTheta) * this.velocity.y\n  //   const newVelocityY = Math.sin(2 * reflectLineTheta) * this.velocity.x - Math.cos(2 * reflectLineTheta) * this.velocity.y\n  //   this.velocity = new Vec2(newVelocityX, newVelocityY).mul(4)\n  //   this.checkVelocity()\n  // }\n\n  rebound(target) {\n    const normal = new Vec2(this.loc.x - target.x, this.loc.y - target.y)\n    const reflectLineTheta = Math.atan2(normal.y, normal.x) + 0.5 * Math.PI\n    const vec = normal.mul(-1).unit()\n    const newVelocityX = Math.cos(2 * reflectLineTheta) * vec.x + Math.sin(2 * reflectLineTheta) * vec.y\n    const newVelocityY = Math.sin(2 * reflectLineTheta) * vec.x - Math.cos(2 * reflectLineTheta) * vec.y\n    this.velocity = new Vec2(newVelocityX, newVelocityY).mul(40)\n    this.checkVelocity()\n  }\n\n  returnLastLoc(dt) {\n    this.loc = this.lastLoc\n  }\n\n  setFriction(ratio) {\n    this.lastFriction = this.friction\n    this.friction = this.friction * ratio\n  }\n  setLastFriction() {\n    this.friction = this.lastFriction\n  }\n  resetFriction() {\n    this.lastFriction = this.friction\n    this.friction = FRICTION \n  }\n\n  updateLastLoc() {\n    this.lastLoc = this.loc\n  }\n  // manipulate by key: left, up, right, down \n  push(vec) {\n    this.force = vec.mul(PUSH_FORCE)\n  }\n\n  // pull(vec) {\n  //   console.log(vec)\n  //   this.force = this.force.add(vec)\n  // }\n\n  serializeForUpdate() {\n    return {\n      id: this.id,\n      loc: this.loc,\n      x: this.loc.x,\n      y: this.loc.y,\n      velocity: this.velocity\n    };\n  }\n}\n\n","import React, { useRef, useEffect, useState } from 'react';\nimport DrawMap from './Drawer';\nimport Engine from './Engine';\nimport Controller from './Controller';\nimport { initState, updateState } from './state'\nimport { getAsset, getAssetNames, downloadAssets } from './assets';\nimport { enpackage, unpackage } from \"../DataPackager\";\n\n\nimport {CONSTANT, Link} from './PlayModeConstant'\nimport Player from './Object/player'\n\nimport \"./PlayMode.css\"\n\n\nconst PlayMapCreater = (props) => {\n    // let { setting } = props\n    const [setting, setSetting] = useState(props.setting)\n    const [loading, setLoading] = useState(false);\n    useEffect( async () => {\n        downloadAssets().then( setLoading(true) )\n    })\n    // const { mapSize, map, objects } = setting\n    let canvasRef = useRef();\n    // const [head, setHead] = useState('seal.svg')\n    const defaultState = {\n        me: new Player(1, 'name', 0, 0),\n        startTime: Date.now(),\n        endTime: Date.now(),\n        playTime: 0,\n        gameState: 'start',\n        head: 'seal.svg',\n        msg: [\"Happy\"],\n        FOCUS_PLAYER: false,\n        pressDown: false,\n        pressRight: false,\n        pressLeft: false,\n        pressUp: false\n    }\n\n    const [status, setStatus] = useState(defaultState);\n\n\n    useEffect(() => {\n        if (\n            status.gameState === CONSTANT.GameOver ||\n            status.gameState === CONSTANT.WIN\n        ) {\n\n            props.challenge(\n                status.endTime - status.startTime,\n                status.gameState === CONSTANT.WIN\n            );\n\n            openForm(\"gameForm\")\n            setSetting( ()=> unpackage(enpackage(setting)) )\n        }\n    }, [status]);\n\n\n    function closeForm(form) {\n        document.getElementById(form).style.display = \"none\";\n        startPlay()\n    }\n\n    function startPlay(){\n        setStatus(() => ({ ...defaultState, head: status.head , gameState: CONSTANT.PLAYING, FOCUS_PLAYER: true }))\n    }\n\n    function openForm(form) {\n        document.getElementById(form).style.display = \"block\";\n    }\n\n    useEffect(() => {\n        if (!loading) return\n\n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext('2d');\n\n        let cancelController;\n        let requestId;      \n        cancelController = Controller(canvas, status, setStatus, setting);\n\n        initState(status, setting)\n\n        let fpsInterval, startTime, now, then, elapsed;\n\n        function update() {\n            requestId = requestAnimationFrame(update);\n            updateState(status, setting, setStatus)\n\n            now = Date.now();\n            elapsed = now - then;\n            if (elapsed > fpsInterval) {\n                then = now - (elapsed % fpsInterval);\n                Engine(setting.objects, setting.map, status);\n                DrawMap(ctx, setting, status);\n            }\n        };\n        // initialize the timer variables and start the animation\n        function startAnimating(fps) {\n            fpsInterval = 1000 / fps;\n            then = Date.now();\n            startTime = then;\n            update();\n        }\n        startAnimating(30)\n\n\n        if (status.gameState === CONSTANT.GameOver || status.gameState === 'start'){\n            cancelController()\n        }\n        if (status.gameState === 'start')\n            openForm(\"startForm\")\n\n        if ( !(status.gameState === 'start' || status.gameState === CONSTANT.PLAYING))\n            cancelAnimationFrame(requestId);\n\n        return () => {\n            cancelController();\n            cancelAnimationFrame(requestId);\n        };\n    }, [setStatus, status, setting, loading]);\n\n    function toTimeFormate(ms) {\n        return `${Math.floor(ms / 1000 / 60)\n            .toString()\n            .padStart(2, \"0\")} : ${Math.floor((ms / 1000) % 60)\n                .toString()\n                .padStart(2, \"0\")}`;\n    }\n\n    const getImg = async (assetName) => {\n        console.log( assetName)\n         const img = await getAsset(assetName)\n        return <img src={img.src}/>\n    }\n\n    \n      const githubButton = \n        <div><button className='githubButton' onClick={() => { window.open(Link.github, \"_blank\"); }}>\n            <img src={getAsset('star.svg').src} /> Star\n            </button></div>\n\n    return (\n        <>\n            <div>\n                <canvas ref={canvasRef} id='PlayModeCanvas'\n                    width={CONSTANT.CanvasWidth}\n                    height={CONSTANT.CanvasHeight}\n                ></canvas>\n            </div>\n            {/* Game Over form */}\n            <div className=\"form-popup\" id=\"gameForm\">\n                <span>{status.gameState}</span>\n                {status.msg.map( (m)=> (<p>{m}</p>) )}\n                <span>{toTimeFormate(status.playTime)}</span>\n                <button className='gameButton' onClick={() => { closeForm(\"gameForm\") }}>Try Again</button>\n                {githubButton}\n            </div>\n            {/* select player form */}\n            <div className=\"form-popup\" id=\"startForm\">\n                <span>Choose A Player</span>\n                <div onChange={ (e)=>{ status.head = e.target.value}}>\n                    { (loading) ?\n                    getAssetNames().map((assetName) => (\n                        <label>\n                            <input type=\"radio\" name=\"test\" value={assetName} />\n                            <img src={getAsset(assetName).src}/>\n                        </label>\n                    )) : <></>}\n                </div>\n                <button className='gameButton' onClick={ () =>{ closeForm(\"startForm\");} }>START</button>\n                {githubButton}\n            </div>\n        </>\n    )\n}\n\n\n\nexport default PlayMapCreater;\n","import Vec2 from \"../../GameContainer/Class/Vec2\"\n\nexport default function Controller(scene, status, setStatus, setting) {\n\n\tconst KeyCode = {37:'left', 38:'up', 39:'right', 40:'down'}\n\n\tfunction onKeyDown(e) {\n\t\tswitch (KeyCode[e.keyCode]) {\n\t\t\tcase 'down':\n\t\t\t\tstatus.pressDown = true\n\t\t\t\tbreak\n\t\t\tcase 'right':\n\t\t\t\tstatus.pressRight = true\n\t\t\t\tbreak\n\t\t\tcase 'left':\n\t\t\t\tstatus.pressLeft = true\n\t\t\t\tbreak\n\t\t\tcase 'up':\n\t\t\t\tstatus.pressUp = true\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\tfunction onKeyUp(e) {\n\t\tswitch (KeyCode[e.keyCode]) {\n\t\t\tcase 'down':\n\t\t\t\tstatus.pressDown = false\n\t\t\t\tbreak\n\t\t\tcase 'right':\n\t\t\t\tstatus.pressRight = false\n\t\t\t\tbreak\n\t\t\tcase 'left':\n\t\t\t\tstatus.pressLeft = false\n\t\t\t\tbreak\n\t\t\tcase 'up':\n\t\t\t\tstatus.pressUp = false\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\twindow.addEventListener('keydown', onKeyDown);\n\twindow.addEventListener('keyup', onKeyUp);\n\n\treturn () => {\n\t\twindow.removeEventListener('keydown', onKeyDown);\n\t\twindow.removeEventListener('keyup', onKeyUp);\n\t};\n};\n\n\n\n","import React from \"react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { enpackage, unpackage, show } from \"../GameContainer/DataPackager\";\nimport { useHistory } from \"react-router-dom\";\nimport ErrorPage from \"./ErrorPage\";\nimport LoadingPage from \"./LoadingPage\";\nimport instance from \"./Api\";\n\nimport PlayMode from \"../GameContainer/PlayMode/PlayMapCreater\";\nimport init from \"../GameContainer/Setting/example_0\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport SettingsApplicationsIcon from \"@material-ui/icons/SettingsApplications\";\nimport FlagIcon from \"@material-ui/icons/Flag\";\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\nfunction checkLogin(props) {\n  if (props.location.state === undefined) return false;\n  else if (!props.location.state.login) return false;\n  return true;\n}\n\nconst useStyles = makeStyles((theme) => ({\n  margin: {\n    margin: theme.spacing(1),\n  },\n  extendedIcon: {\n    marginRight: theme.spacing(1),\n  },\n}));\n\nconst Play = (props) => {\n  const history = useHistory();\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n  // for Snackbar Alert\n  const [msgOpen, setMsgOpen] = useState(false);\n  const [alertMsg, setAlertMsg] = useState(\"\");\n  const [alertType, setAlertType] = useState(\"success\"); // \"error\", \"warning\", \"info\", \"success\"\n  const [idGetMap, setidGetMap] = useState(false);\n  const [setting, setSetting] = useState(\"\");\n  const [mapp, setMapp] = useState({});\n  // get data before render\n  const [isBusy, setBusy] = useState(true);\n\n  const { name, uuid, login, id, mode } = props.data;\n\n  const getMap = async () => {\n    const {\n      data: { success, errorCode, map },\n    } = await instance.post(\"/api/getMap\", {\n      id,\n    });\n    if (!success) {\n      setAlertMsg(`Error. Error code:${errorCode}`);\n      setAlertType(\"error\");\n      setMsgOpen(true);\n    } else {\n      setAlertMsg(`Load data success`);\n      setAlertType(\"success\");\n      setMsgOpen(true);\n      setSetting(map[\"content\"]);\n      setMapp(map);\n      setidGetMap(true);\n    }\n  };\n\n  // if (id !== 0 && idGetMap === false) {\n  //   getMap();\n  // }\n\n  const challengeSuccess = async (mapLocal) => {\n    const {\n      data: { success, errorCode },\n    } = await instance.post(\"/api/challengeSuccess\", {\n      mapLocal,\n    });\n    console.log(`challenge: ${success}`);\n    if (!success) {\n    } else {\n    }\n  };\n\n  const challenge = (time, pass) => {\n    if (mode !== \"challenge\") {\n      console.log(`practice no record`);\n      return;\n    }\n    console.log(`receive challenge ${time}`);\n    let mapLocal = { ...mapp };\n    mapLocal.statistic.playTime += 1;\n    // pass\n    if (pass) {\n      mapLocal.statistic.passTime += 1;\n      if (!mapLocal.passPeople.includes(name)) {\n        mapLocal.passPeople.push(name);\n      }\n    }\n    // new record\n    if (mapLocal.statistic.fastestPass > time / 1000.0 && pass) {\n      mapLocal.statistic.fastestPass = time / 1000.0;\n      mapLocal.statistic.fastestMan = name;\n    }\n    challengeSuccess(mapLocal);\n  };\n\n  useEffect(() => {\n    // console.log(`busy?${isBusy}`);\n    setBusy(true);\n    getMap();\n  }, []);\n\n  return (\n    <div style={{ textAlign: \"center\" }}>\n      <Snackbar\n        open={msgOpen}\n        autoHideDuration={500}\n        onClose={() => {\n          setMsgOpen(false);\n        }}\n      >\n        <Alert\n          onClose={() => {\n            setMsgOpen(false);\n          }}\n          severity={alertType}\n        >\n          {alertMsg}\n        </Alert>\n      </Snackbar>\n      <div style={{ marginTop: \"1em\" }}>\n        <IconButton\n          className={classes.margin}\n          size=\"large\"\n          variant=\"outlined\"\n          color=\"secondary\"\n          onClick={history.goBack}\n        >\n          <ArrowBackRoundedIcon />\n        </IconButton>\n        <IconButton\n          className={classes.margin}\n          size=\"large\"\n          variant=\"outlined\"\n          color=\"secondary\"\n        >\n          {mode === \"challenge\" ? <FlagIcon /> : <SettingsIcon />}\n          {mode === \"challenge\" ? \"Challenge Mode\" : \" Practice Mode\"}\n        </IconButton>\n      </div>\n      {setting === \"\" || msgOpen === true ? (\n        <LoadingPage />\n      ) : (\n        <PlayMode\n          width=\"1200px\"\n          height=\"600px\"\n          setting={unpackage(setting)}\n          challenge={challenge}\n        />\n      )}\n    </div>\n  );\n};\nfunction Playmode(props) {\n  return (\n    <>\n      {checkLogin(props) ? <Play data={props.location.state} /> : <ErrorPage />}\n    </>\n  );\n}\nexport default Playmode;\n","import \"./App.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport Login from \"./Pages/Login\";\nimport {\n  NavLink,\n  Switch,\n  Route,\n  BrowserRouter,\n  HashRouter as Router,\n} from \"react-router-dom\";\nimport SelectPage from \"./Pages/SelectPage\";\nimport PopularMap from \"./Pages/PopularMap\";\nimport EditMode from \"./Pages/EditMode\";\nimport PlayMode from \"./Pages/PlayMode\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter basename={process.env.PUBLIC_URL}>\n      <Switch>\n        <Route exact path=\"/\" component={Login} />\n        <Route exact path=\"/users/selectPage\" component={SelectPage} />\n        <Route exact path=\"/PopularMap\" component={PopularMap} />\n        <Route exact path=\"/EditMode\" component={EditMode} />\n        <Route exact path=\"/PlayMode\" component={PlayMode} />\n      </Switch>\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}